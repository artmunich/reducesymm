\section{Cycle Averages}
\label{s:DynAvers}

So far, we have explained how we find the \rpo s of the \twomode\ system in 
its \reducedsp\ and how to compute their stability, however, we have not yet
said anything about what to do with these numbers. We begin this section with 
an overview of the main results of the periodic orbit theory, for a detailed 
introduction to the subject, we refer the reader to \refref{DasBuch}. We 
closely follow the presentation of \refref{DasBuch} with the addition of how 
the theory is modified in the presence of continuous symmetries in 
\refsect{s-ContFac}. In \refsect{s-CycExp}, we present cycle expansions and
explain how we approximate the Poincar\'e section in 
\reffig{fig:psectandretmap} (d), in order to obtain a better convergence of 
the spectral determinants. We finish this section with the numerical results in 
\refsect{s-NumResults}

\subsection{Classical trace formula}
Consider the {\evOper}, action of which evolves a density 
$\rho_0(\ssp)$ in the \statesp :
\bea
    \rho(\zeit ,\ssp) &=& [\Lop^\zeit \rho_0 ] (\ssp) \, , \continue
    &=& \int d \ssp' \delta (\ssp - \flow{\zeit}{\ssp'}) 
        e^{\beta \Obser^\zeit (\ssp' )} \rho_0(\ssp') \, .
        \label{e-EvOper}
\eea
Here, $\beta$ is an auxiliary variable and $\Obser^\zeit (\ssp')$ is the 
integrated value of an `additive' observable $\obser$ along the orbit 
$\flow{\zeit}{\ssp'}$:
\beq
    \Obser^\zeit (\ssp' ) = \int_0^{\zeit} d \zeit' 
                              \obser(\flow{\zeit'}{\ssp'}) \, .
\eeq
Notice that when $\beta = 0$, the \evOper\ \refeq{e-EvOper} simply evolves 
the density of \statesp\ points to its new form after time $\zeit$. As we 
shall see, attaching the integrated observables to this operator enables us to 
study values of these observables averaged over the invariant measures. 

Since we required our observable to be additive along an orbit, and 
exponentiated its integrated value in our construction of the \evOper\ 
\refeq{e-EvOper}; the evolution operator itself is multiplicative:
\beq
    \Lop^{\zeit_1 + \zeit_2} = \Lop^{\zeit_2} \Lop^{\zeit_1} \, .
    \label{eq-SemiGroup}
\eeq
For the kernel of the evolution integral, which we will refer to as 
$\Lop^\zeit (\ssp, \ssp')$ with explicit indices, we can write this relation 
as:
\beq
	\Lop^{\zeit_1 + \zeit_2} (\ssp,\ssp') = 
    \int d\ssp'' \Lop^{\zeit_2} (\ssp, \ssp'') 
                   \Lop^{\zeit_1} (\ssp'', \ssp) \, .
	\label{eq-SemiGroupKernel}
\eeq
This `semigroup property' \refeq{eq-SemiGroup} of the {\evOper} allows us to 
define the {\evOper} as the formal exponential of its infinitesimal generator 
\Aop :
\beq
	\Lop^t = e^{\Aop t} \, .
	\label{eq-EvOpExp}
\eeq
By definition \refeq{e-EvOper}, eigenvalues and eigenfunctions of $\Lop^t$ (and
thus \Aop ) are functions of $\beta$. Let us define $\rho_{\beta} (x)$ as the
eigenfunction of \refeq{e-EvOper} with the leading eigenvalue (the one with the
largest real part); we can write the action of \refeq{e-EvOper} on this density
explicitly as follows:
\beq
    \left[ \Lop^t \rho_{\beta} \right] (x) = e^{t s(\beta )} \rho_{\beta} (x) \, .
    \label{eq-EigenvalueRel}
\eeq
Here, $s(\beta)$ is the eigenvalue of $\Aop$. As we stated earlier, when 
$\beta = 0$, the {\evOper} simply evolves densities; this form of the evolution
operator is known as the {\FPoper}. We assume the system we study is ergodic, 
and hence an `invariant measure' $\rho_0(\ssp)$ exists, with eigenvalue 
$s(0) = 0$. Long time spectrum of any observable is going to be dominated by 
its average over such a density, hence we define the average of an observable
is its average over the invariant measure:
\beq
    \langle \obser \rangle = \int d \ssp \obser(\ssp) \rho_0 (\ssp) \, .
    \label{e-obserAvg}
\eeq
By evaluating the action of {\evOper} \refeq{e-EvOper} for infinitesimal 
times and after some algebra, which we will skip here, one finds that the 
averages of observables and the higher moments can be generated from the 
derivatives of $s(\beta)$:
\beq
    \langle \obser \rangle = 
        \left. \frac{d s}{d \beta} \right|_{\beta = 0} \, , \quad
    \langle (\obser - \langle \obser \rangle )^2 \rangle = 
        \left. \frac{d^2 s}{d \beta^2} \right|_{\beta = 0} \,, ...
    \label{eq-moments}
\eeq
In order to obtain $s(\beta)$ we construct the resolvent of \Aop , by taking 
the Laplace transform of \refeq{eq-EvOpExp}:
\beq
	\int_0^{\infty} d\zeit e^{-s\zeit} \Lop^\zeit = (s-\Aop)^{-1} \, ,
	\label{eq-ResolventA}
\eeq
trace of which peaks at the eigenvalues of \Aop. By taking the
Laplace transform of \refeq{e-EvOper} and computing its trace
by $\tr \Lop^\zeit = \int d\ssp \Lop (\ssp,\ssp)$ we obtain the
classical trace formula:
\beq
\sum_{\alpha=0}^{\infty} \frac{1}{s-s_{\alpha}} = \sum_p T_p
\sum_{r=1}^{\infty} \frac{e^{r(\beta \Obser_p - s T_p)}}{\oneMinJ{r}} .
\ee{e-ClassicalTraceFormula}
which relates the spectrum of \Aop\ to the spectrum of the periodic
orbits. Here, $s_{\alpha}$ are the eigenvalues of \Aop ,
outer sum on the RHS runs over the `prime cycles' of the system,
$T_p$ is the period of the prime cycle $p$, $\Obser_p$ is the value of
the observable integrated along the prime cycle, $s$ is the auxiliary
variable of the Laplace transform, and $\monodromy_p$ is the transverse
monodromy matrix, eigenvalues of which are the Floquet multipliers of the prime
cycle $p$ excluding the marginal ones ($|\Lambda| \neq 1$). In deriving
\refeq{e-ClassicalTraceFormula} one assumes a single marginal direction, namely
the direction that is parallel to the periodic orbit at all times, and evaluates
the trace integral by transforming to a local coordinate system where one of the
coordinates is parallel to the flow while the rest is transverse. Integration along
the parallel direction contributes factors of $T_p$, and the transverse integral
over the delta function contributes $\oneMinJ{r}$. 

\subsection{Continuous factorization}
\label{s-ContFac}

Classical trace formula \refeq{e-ClassicalTraceFormula} receives contributions
from \po s, however, \rpo s of equivariant systems are almost never 
periodic in the full \statesp . In order to be able to compute \rpo\ 
contributions to the trace of the \evOper, one has to factorize the \evOper\ 
into the irreducible subspaces of the symmetry group. For discrete symmetries, 
this procedure is studied in \refref{CvitaEckardt} and for the quantum systems 
with continuous symmetries (Abelian and 3D rotations), factorization of 
semiclassical Green's operator is carried out in \refref{Creagh93}. 
\refRef{Cvi07} addresses the continuous factorization of the \evOper\ and its 
trace; we are going to sketch this treatment here. We start by stating, without
proof, that a square-integrable field $\psi (\ssp)$ over a vector space can be 
factorized into its projections over the irreducible subspaces of a group 
$\Group$: 
\beq
    \psi (\ssp) = \sum_m P_m \psi (\ssp) \, ,
\eeq
where the sum runs over the irreducible representations of the $\Group$, and 
the projection operator onto the $m$th irreducible subspace, for a continuous
group, is:
\beq
    P_m = d_m \int_\Group d \mu(g) \chi_m (\LieEl(\theta)) 
                            D(\LieEl(\theta)) \, .
    \label{e-ProjectionOperator}
\eeq 
Here, $d_m$ is the dimension of the representation, $d \mu(g)$ is the 
normalized `Haar measure', $\chi_m (\LieEl)$ is the `character' of $m$th 
irreducible representation and $D(\LieEl(\theta))$ is the operator which 
transforms a scalar field defined on \statesp\ according to $\LieEl (\theta)$, 
namely, $D(\LieEl(\theta) \rho (\ssp) = \rho(\LieEl^{-1}(\theta) \ssp)$. For 
our specific case of single $\SOn{2}$ symmetry, 
\bea
d_m &\rightarrow& 1\, , \\
\int_G d \mu(g) &\rightarrow& \oint \frac{d \theta} {2 \pi} \, , \\
\chi_m (\LieEl(\theta)) &\rightarrow& e^{- \ii m \theta } \, .
\eea
Since the projection 
operator \refeq{e-ProjectionOperator} factorizes scalar fields in the \statesp\ 
into their projections onto irreducible subspaces of the $\Group$, it can as
well be used to factorize the \evOper\ since the \evOper\ acts on scalar 
fields (densities) and returns scalar fields on the \statesp . Thus the kernel 
of the \evOper\ transforms under the action of $D(\LieEl(\theta))$ as:
\bea
    D(\LieEl(\theta)) \Lop^t (y, x) &=& \Lop^t (\LieEl^{-1}(\theta) y, x)\,,
    \continue
    &=& \Lop^t (y, \LieEl(\theta) x) \,, \continue
    &=& \delta (y - \LieEl(\theta) f^t (x)) e^{\beta \Obser^t(x)} \, ,
    \label{e-gEvOper}
\eea
where the second step followed from the equivariance of the system at 
consideration. \Rpo s contribute to the $P_m \Lop^t = \Lop_m^t$ since its 
kernel is modified as in \refeq{e-gEvOper} and projection involves and integral 
over the group parameters which will be non-zero at the phase shift of the 
\rpo s. By computing the trace of $\Lop_m^t$, which in addition to the integral
over \statesp\ involves also another integral over the group parameters, one 
obtains the $m$th irreducible subspace contribution to the classical trace as
\beq
\sum_{\alpha=0}^{\infty} \frac{1}{s-s_{m, \alpha}} = \sum_p T_p
\sum_{r=1}^{\infty} \frac{\chi_m (\LieEl^r(\theta_p)) 
            e^{r(\beta \Obser_p - s T_p)}}{\oneMinJred{r}} .
\ee{e-ReducedTraceFormula}
The reduced trace formula \refeq{e-ReducedTraceFormula} differs from the 
classical trace formula \refeq{e-ClassicalTraceFormula} by the group character
term which is evaluated at the \rpo\ phase shifts, and the reduced monodromy
matrix, which is the $(d-N-1)\times(d-N-1)$ reduced Jacobian for the \rpo\ 
evaluated on a Poincar\'e section in the \reducedsp , eigenvalues of which are 
those of the \rpo\ Jacobian \refeq{e-rpoJacobian} without the marginal ones. 

Since we are only interested in the leading eigenvalue of the \evOper , from 
here on, we are going to consider contributions only from the 
$0$th irreducible subspace to the trace \refeq{e-ClassicalTraceFormula} from 
its projections \refeq{e-ReducedTraceFormula} which we can write for our 
$\SOn{2}$ case explicitly as
\beq
\sum_{\alpha=0}^{\infty} \frac{1}{s-s_{0, \alpha}} = \sum_p T_p
\sum_{r=1}^{\infty} \frac{e^{r(\beta \Obser_p - s T_p)}}{\oneMinJred{r}} .
\ee{e-tracem0}
This form differs from the classical trace formula 
\refeq{e-ClassicalTraceFormula} only by the monodromy matrix since $0$th 
irreducible representation of $\SOn{2}$ has character $1$. Thus, we can apply 
our techiques regarding the applications of \refeq{e-ClassicalTraceFormula}, 
such as cycle expansions, after the replacement $\monodromy \rightarrow \monodromyRed$. 

\subsection{Cycle expansions}
\label{s-CycExp}

While the classical trace formula \refeq{e-ClassicalTraceFormula} manifests
the essential duality between the spectrum of an observable and that of
the periodic orbits, in practice, it is hard to work with since the eigenvalues
are located at the poles of \refeq{e-ClassicalTraceFormula}. For this reason,
one expresses this duality equivalently as the following spectral determinant
\beq
    \det (s-\mathcal{A}) = \exp \left( - \sum_p \sum_{r=1}^{\infty}
                             \frac{1}{r} \frac{e^{r(\beta \Obser_p - s T_p)}}{\oneMinJ{r}} \right)\, ,
\ee{e-SpectralDeterminant}
logarithmic derivative of which gives \refeq{e-ClassicalTraceFormula}.
The spectral determinant \refeq{e-SpectralDeterminant} is easier to work
with since the spectrum of $\mathcal{A}$, is now located at the zeros of
\refeq{e-SpectralDeterminant}. Convergence of \refeq{e-SpectralDeterminant}
is still not obvious. More insight is gained by approximating $\oneMinJ{r}$
by the product of expanding Floquet multipliers and then computing the $r$
sum in \refeq{e-SpectralDeterminant}.
\bea
\oneMinJ{} &=& | (1 - \ExpaEig_{e,1})(1 - \ExpaEig_{e,2})... \continue
			&&(1 - \ExpaEig_{c,1}) (1 - \ExpaEig_{c,2}) ... | \nonumber \\
			&\approx& \prod_e |\ExpaEig_e| = |\ExpaEig_p|,
\eea
where $|\ExpaEig_{e,i}| > 1$ and $|\ExpaEig_{c,i}| < 1$ are expanding and contracting Floquet multipliers respectively. After this approximation, $r$-sum in \refeq{e-SpectralDeterminant} becomes the Taylor expansion of natural logarithm and it can be compactly written as follows:
\beq
1 / \zeta = \prod_r (1 - t_p) \, \mbox{where}, \, t_p = \frac{1}{|\ExpaEig_p|} e^{\beta \Obser_p - s T_p} z^{n_p} .
\ee{e-DynamicalZeta}
Where we inserted the `order tracking' term $z$. For complete binary symbolic dynamics, the dynamical zeta function \refeq{e-DynamicalZeta} can be brought into the `curvature expansion' form:
\bea
1 / \zeta &=& 1 - t_0 - t_1 - (t_{01} - t_0 t_1 )  \label{e-CycleExpansion} \\
		  && - [(t_{011} - t_{01}t_1) + (t_{001} - t_{01} t_0)] - ... \continue
		  &=& 1 - \sum_f t_f - \sum_n \hat{c}_n \label{e-CurvatureExpansion}.
\eea
In the curvature expansion \refeq{e-CurvatureExpansion}, we grouped the
contributions to the dynamical zeta function as `fundamental' contributions
$t_f$ and `curvature' corrections. One expects the curvature corrections to
be small since the longer prime cycles are `shadowed' by the combination of
the shorter ones, the `pseudocycles'.

For complete binary symbolic dynamics, the only fundamental contributions to
the dynamical zeta function are the cycles with topological length $1$, see
\refeq{e-CurvatureExpansion}. This is not the case for any map since in general
there might be non-trivial pruning rules, hence longer cycles can appear unshadowed.
The Poincar\'e return map of \reffig{fig:psectandretmap}\,{d) is such a map
with non-trivial pruning rules, however, note that cycles \cycle{001} and \cycle{011}
passes very close to the tip of the cusp, the critical point, in
\reffig{fig:psectandretmap}\,{d). This observation motivates us to approximate
the return map of \reffig{fig:psectandretmap}\,{d), as if its tip is located at
$s = 0.97986453$, where the cycle \cycle{001} lands, and omit the contributions
above this point. We will refer this approximation as the `finite grammar approximation'
since by doing it, we obtain single pruning rule; that is the symbol sequence
$00$ is not allowed. This grammar is known as the `golden mean' grammar and a
complete binary symbolic dynamics can be converted to the golden mean symbolic
dynamics by substitution $0 \rightarrow 01$. We can write the dynamical zeta
function for the golden mean pruned symbolic dynamics by replacing $0$s in
\refeq{e-CycleExpansion} by $01$:
\bea
1 / \zeta &=& 1 - t_{01} - t_1 - (t_{011} - t_{01} t_1 ) \label{e-GoldenMeanCycleExpansion}\\
		  && - [(t_{0111} - t_{011}t_1) + (t_{01011} - t_{01} t_{011} ) ] - ... \nonumber
\eea
Note that all the contributions longer than topological length $2$ to the golden mean dynamical zeta function are in form of shadowing combinations. However, as we shall see, they are not small.

While dynamical zeta functions are useful for investigating the convergence
properties, they are not exact, and their computational cost is same with
that of the exact spectral determinants. For this reason, we will expand the
spectral determinant \refeq{e-SpectralDeterminant} ordered in the topological
length of cycles and pseudocycles as follows:
\beq
    \det (s-\mathcal{A}) =   \prod_p \exp \left( - \sum_{r=1}^{n_p r < N}
                             \frac{1}{r} \frac{e^{r(\beta \Obser_p - s T_p)}
                                          }{\oneMinJ{r}} z^{n_p r} \right) \, .
\ee{e-SpectralDeterminantExp}
This is the form that we use to compute the spectral determinant. For each prime
cycle, we compute the sum term in \refeq{e-SpectralDeterminantExp} truncated at
the expansion order $N$, and then expand the exponential upto order $N$, and multiply
this expansion with the contributions from previous cycles and drop terms with
order greater than $N$. This way, we obtain the $N^{th}$ order spectral determinant
\refeq{e-SpectralDeterminant}. Let us denote the resultant series after setting $z=1$ as
\beq
    F_N(s, \beta ) = 1 - \sum_{n=1}^{N} Q_n(s, \beta ) \, .
    \label{e-NthOrderSpectDet}
\eeq
Remember that we are searching for the eigenvalues $s ( \beta)$ of the \Aop , more
specifically, we would like to compute the moments \refeq{eq-moments}. $s ( \beta)$
are located at the zeros of the spectral determinant, hence they satisfy the implicit
equation:
\beq
    F_N(s, s(\beta )) = 0 \, .
    \label{e-FNimplicit}
\eeq
By taking derivative of \refeq{e-FNimplicit} with respect to $\beta$ and applying
chain rule we obtain
\beq
    \frac{d s}{d \beta} = - \left. \frac{\partial F}{\partial \beta} \right/
                                     \frac{\partial F}{\partial s}
\eeq
We can similarly take the higher order derivatives to get higher order moments.
Finally, by defining
\beq
	\langle T \rangle_N = \left. \partial F_N / \partial s \right|_{\beta=0, s=s (0)}
	\label{eq-Tavg}
\eeq
we obtain the \cycForm s:
\bea
    \langle \obser \rangle_N &=& - \frac{1}{\langle T \rangle_N} \left.
                              \frac{\partial F_N}{\partial \beta}
                              \right|_{\beta=0, s=s (0)} \, ,   \label{e-Avga} \\
    \langle (\obser - \langle \obser \rangle )^2 \rangle_N
    &=& - \frac{1}{\langle T \rangle_N} \left. \frac{\partial^2 F_N}{\partial \beta^2} \right|_{\beta=0,
                                                                    s=s (0)} \, \label{e-Avgsigma} .
\eea
While for an invariant measure we expect $s (0)$ to be $0$, we did not make such
substitution in \cycForm s, since in practice, our approximation to the spectral
determinant is always of a finite precision, hence the solution of
$F_N(0, s(0)) = 0$ is not exactly $0$. This eigenvalue has a special meaning:
since it is the leading eigenvalue of the Perron-Frobenius operator, it determines
how much the dominant measure decays in time (see \refeq{eq-EigenvalueRel} ). With
this interpretation, we define $\gamma = - s(0)$ as the `escape rate'. This quantity
has a certain meaning in our finite grammar approximation; it tells us how frequently
does the flow visit the part of the attractor that we cut off within the approximation.

We defined $\langle T \rangle$ in \refeq{eq-Tavg} as a shorthand for a partial
derivative, however, we can also develop and interpretation for it by looking at
definitions of dynamical zeta function \refeq{e-DynamicalZeta} and the spectral
determinant \refeq{e-SpectralDeterminant}. In both series, partial derivative with
respect to $s$ turns them into weighted sum of the cycle periods; with this intuition,
we define $\langle T \rangle$ as the `mean cycle period'.

\subsection{Numerical results}
\label{s-NumResults}

We constructed the spectral determinant \refeq{e-NthOrderSpectDet} at different
orders for two observables: phase velocity $\dot{\phi}$ and the leading Lyapunov
exponent. Remember that $\Obser_p$ appearing in \refeq{e-SpectralDeterminantExp} is the
integrated observable, so in order to obtain the moments of phase velocity and
Lyapunov exponent from \refeq{e-Avga} and \refeq{e-Avgsigma}, we respectively input
$\Obser_p = \phi_p$ phase shift of the prime cycle, and $\Obser_p = \ln |\Lambda_p|$ logarithm
of the expanding Floquet multiplier of the prime cycle.

In \refsect{s:visual}, we explained that \SOn{2} phase shifts corresponds to
the drifts in the configuration space, with this in mind, we can relate the
variance of phase velocity to the diffusion constant of our system:
\beq
    D = \frac{1}{2 d} \sigma_{\dot{\phi}}^2
      = \frac{\langle (\dot{\phi} - \langle \dot{\phi} \rangle)^2 \rangle}{2} ,
\eeq
where $d=1$ since our configuration space is one dimensional.

\refTab{t-DynamicalAverages} and \reftab{t-DynamicalAveragesNoGrammar} shows
the cycle averages of the escape rate $\gamma$, mean period $\langle T \rangle$,
leading Lyapunov exponent $\Lyap$, mean phase velocity $\langle \dot{\phi} \rangle$
and the diffusion constant $D$ respectively within and without the finite grammar
approximation. In the latter, we input all the \rpo s we have found into the expansion
\refeq{e-SpectralDeterminantExp}, whereas in the former, we discarded the cycles
with symbol sequence `00'.

\input{2modesDynamicalAverages}
\input{2modesDynamicalAveragesNoGrammar}

We motivated our finite grammar approximation by expecting a fast convergence
due to the nearly exact shadowing combinations and we can clearly see this
by comparing numbers in
\reftab{t-DynamicalAverages} and \reftab{t-DynamicalAveragesNoGrammar}.
Take, for example, Lyapunov exponent which converges with $7$ digit accuracy
at the final order in \reftab{t-DynamicalAverages} while we have only $4$ digits
at this order in \reftab{t-DynamicalAveragesNoGrammar}. Other observables compares
similarly in terms of their convergence in both cases. Note, however, that the
escape rate in \reftab{t-DynamicalAverages} converges to $\gamma = 0.000727889$,
whereas in \reftab{t-DynamicalAveragesNoGrammar} it gets smaller and smaller
with an oscillatory behavior. This is due to the fact that in the finite grammar
approximation, we neglect a definite piece of attractor that corresponds to the
cusp of the return map in \reffig{fig:psectandretmap} (d), above the part that
is cut by \cycle{001}.

In order to compare with the cycle averages, we numerically estimated the
leading Lyapunov exponent of the \twomode\ system using the method of
Wolf \etal\rf{WolfSwift85}. This procedure was repeated 100 times for
different initial conditions, yielding a mean estimate of
$\Lyap_{Numerical} = 0.1198 \pm 0.0008$. While the finite grammar
estimate $\Lyap_{FG} = 0.1183$ is within $0.6\%$ range of this value,
the full cycle expansion agrees with the numerical estimate. This is not
surprising, since in the finite grammar approximation, we discard the
most unstable cycles, thus, we obtain a slightly smaller Lyapunov
exponent while obtaining a better convergence.
