\section{Continuous Symmetries}
\label{s:symm}

\subsection{Definitions}
\label{s:Definitions}

A dynamical system, $\dot{\ssp}=\vel(\ssp)$ is said to be \emph{equivariant} under the action of
an element $\LieEl$ of a continuous group if
\beq
	\vel( \ssp ) =  \LieEl^{-1}\vel( \LieEl \ssp )
	\,
\ee{equiv}

\noindent at every point in the \statesp\ \pS. Here we assume that $\LieEl$ is an element of a Lie group generated by the infinitesimal generator $\Lg$, 
such that $\LieEl(\theta) = e^{\theta \Lg}$, where $\theta$ parametrizes the group action. Condition \refeq{equiv} can equivalently be expressed as\rf{DasBuch}
\beq
  \groupTan(\vel(\ssp))  - \Mvar(\ssp) \, \groupTan(\ssp) =0
  \,,
\ee{inftmInv}

\noindent where $ \groupTan(\vel(\ssp)) = \Lg \vel(\ssp) $ is the group tangent of the velocity vector at \ssp, $ \groupTan(\ssp) = \Lg \ssp $ is the group tangent of $\ssp$ itself, 
and $\Mvar_{ij}(a)$ is the \stabmat\ ${\pde \vel_i}/{\pde\ssp_j} |_\ssp$.

\ES{2014-05-15}{There is also a notational conflict between time $t$ and $\groupTan$, so that we have expressions like $\groupTan(\ssp)$ and $\ssp(t)$.
Burak, please fix this by making a consistent choice.}
\BB{}{I'm working on producing results, please have a look at \refref{BudCvi14}
fix these following the conventions we used there.}


\label{s:relatives}

If the trajectory of a point $\ssp_\stagn$ coincides with its group
orbit, namely if one can find a group parameter $\theta (\zeit)$ such that
\beq
  \ssp_\stagn + \int_0^\zeit d\zeit' \vel(\ssp (\zeit')) = \LieEl (\theta (\zeit))\,\ssp_\stagn
  \,
\ee{releq}
for all $\zeit$, $\ssp_\stagn$ is called a \emph{\reqv}. By expanding both sides of \refeq{releq}
for infinitesimal time, we can get the relation
$\vel(\ssp_\stagn) = \dot{\theta}(\zeit) \Lg \ssp_\stagn$, which must hold for all $\zeit$. This means that $\dot{\theta}$ is a constant, which we call the \emph{\phaseVel} $c$. 
By multiplying through by $c$, the equivariance
condition \refeq{inftmInv} for \reqva\ can be compactly rewritten as
\beq
(\velRel \Lg - \Mvar ) \vel (\ssp_\stagn) = 0
\,.
\ee{ReqvMargEig}

We define a \statesp\ point $\ssp_\rpprime$ as lying on a \emph{\rpo} of period $\pd$ if its trajectory intersects its group orbit after time $\pd$, i.e.
\beq
  \ssp_\rpprime  + \int_0^\pd d\tau' \vel(\ssp (\tau')) = \LieEl (\theta_\rpprime ) \ssp_\rpprime
  \,,
\ee{relpo}
\noindent for some value $\theta_{\pd}$ of $\theta$. While the trajectory of a \rpo\ traces out the same path shifted
by the group action over and over again, as we will show in \refSect{s:numerics}, such a trajectory can be very complicated if the
continuous symmetry of the system is not reduced.

\subsection{\Mslices}
\label{s-slice}

In a system with $N$ continuous symmetries, a \emph{\slice} \pSRed\ is a codimension $N$ submanifold 
of \pS\ that cuts every group orbit once and only once. In the \emph{\mslices}, the solution
of a $d$-\dmn\ dynamical system is represented as a symmetry-reduced trajectory $\sspRed (t)$ within the
$(d-N)$-\dmn\ \slice\ and $N$ time dependent group parameters $\theta(t)$, which
map $\sspRed (t)$ to the full \statesp\ by the group action $\LieEl(\theta(t))$.

While this definition puts no restriction on the shape of the
\slice, it also provides no guidance on how to construct it.
In practice, a local approximation of the slice in the neighborhood of a point called a \emph{\slicePlane}
can be constructed by using the point as \emph{\template\ }$\slicep$. The \slicePlane\ is then defined as the hyperplane
that contains $\slicep$ and is perpendicular to its group tangent $\sliceTan{} = \Lg \slicep$.
The relationship between \slicePlane s, \template s and reduced trajectories are illustrated schematically in \reffig{f-ReducTraj1}.\DB{05.16.2014}{This is a comment for \reffig{f-ReducTraj1}. Formally, the two trajectories belong to the same \emph{wurst}, not the same group orbit. What terminology are we going to use going forward? Are we still happy with wurst or have we moved on?}

%% ReducTraj*.* - read dasbuch/book/FigSrc/inkscape/00ReadMe.txt
\begin{figure}
\begin{center}
 \setlength{\unitlength}{0.40\textwidth}
 %% \unitlength = units used in the Picture Environment
 \begin{picture}(1,0.8361641)%
   \put(0,0){\includegraphics[width=\unitlength]{ReducTraj5.pdf}}%
   \put(0.06854399,0.36282057){\color[rgb]{0,0,0}\rotatebox{-30.34758661}{\makebox(0,0)[lb]{\smash{$\pSRed$}}}}%
   \put(0.57768586,0.29773425){\color[rgb]{0,0,0}\rotatebox{0.0313674}{\makebox(0,0)[lb]{\smash{$\sspRed(0)$}}}}%
   \put(0.59310014,0.69932675){\color[rgb]{0,0,0}\rotatebox{0.03136739}{\makebox(0,0)[lb]{\smash{$\ssp(\tau)$}}}}%
   \put(0.8268425,0.39772328){\color[rgb]{0,0,0}\rotatebox{0.03136739}{\makebox(0,0)[lb]{\smash{$\sspRed(\tau)$}}}}%
   \put(0.81220962,0.66529577){\color[rgb]{0,0,0}\rotatebox{0.03136739}{\makebox(0,0)[lb]{\smash{$\LieEl(\tau)$}}}}%
   \put(0.21150193,0.63610779){\color[rgb]{0,0,0}\rotatebox{0.0313674}{\makebox(0,0)[lb]{\smash{$\LieEl\,\slicep$}}}}%
   \put(0.37740434,0.49597258){\color[rgb]{0,0,0}\rotatebox{0.0313674}{\makebox(0,0)[lb]{\smash{$\slicep$}}}}%
   \put(0.3627714,0.69665188){\color[rgb]{0,0,0}\rotatebox{0.0313674}{\makebox(0,0)[lb]{\smash{$\sliceTan{}$}}}}%
 \end{picture}%
\end{center}
\caption{\label{f-ReducTraj1}The \slicePlane\ \pSRed\ is a hyperplane % \refeq{PCsect0}
passing through the {\template} point $\slicep$
and normal to its group tangent $\sliceTan{}$.
It intersects all group orbits (dotted lines) in an open
neighborhood of $\slicep$.  The full \statesp\ trajectory $\ssp(\tau)$ (solid black line) and the \reducedsp\
trajectory $\sspRed(\tau)$ (solid green line) belong to the same group orbit
$\pS_{\ssp(\tau)}$ and are equivalent up to a group rotation
$\LieEl(\gSpace)$ (from \wwwcb{}).
}%
\end{figure}

Reduced trajectories $\sspRed (t)$ can be obtained in two ways: by post-processing data
or by reformulating the dynamics and integrating directly on the \slice. In the post-processing method, which can be applied to both numerical and experimental data, 
one takes the data in the full \statesp\ and looks for the time dependent group parameter
that brings the trajectory $\ssp(t)$ onto the \slice. That is, one finds $\theta (t)$ such that $\sspRed(t) = \LieEl(- \theta (t)) \ssp (t)$ 
satisfies the \slice\ condition:
\beq
\braket{\left(\sspRed(t) - \slicep\right)}{\sliceTan{}} = 0
\,.
\ee{SliceCond}

In the second method, one reformulates the dynamics (for Abelian groups) as
\bea
\velRed(\sspRed) &=& \vel(\sspRed)
   -\dot{\theta}(\sspRed) \, \groupTan(\sspRed)
\continue
\dot{\theta}(\sspRed) &=& {\braket{\vel(\sspRed)}{\sliceTan{}}}/
               {\braket{\groupTan(\sspRed)}{\sliceTan{}}}
\, ,
\label{eq:so2reduced}
\eea
and computes $\sspRed (t)$ and $\theta (t)$ directly. In \refeq{eq:so2reduced}, $\velRed$ is the projection
of the full \statesp\ velocity \vel(\ssp) onto the \slicePlane. For a detailed derivation
of \refeq{eq:so2reduced}, see \refref{DasBuch}. Note that the time derivative
of the group parameter, which also appears in $\velRed$,
becomes singular if the dot product $\braket{\groupTan(\sspRed)}{\sliceTan{}}$
vanishes. We will refer the set of points on the \slicePlane\ which satisfy
\beq
\braket{\groupTan(\sspRed^*)}{\sliceTan{}} = 0
\,
\ee{ChartBordCond}
as the \emph{\sliceBord}.

%In general, \chartBord\ can be avoided by use of
%multiple \template s and arranging them in a way that the trajectories do not
%intersect the \chartBord , as done in \refref{atlas12}. In the particular
%case of the \twoMode\ system that we study in this paper, we can describe
%the reduced dynamics using a single \slice\ by picking a \template\ for which
%the \chartBord\ is a flow invariant subspace, hence never visited.

%If a $d$\dmn\ dynamical flow is $\Group$-equivariant under actions of
%an $N$ continuous parameters symmetry group $\Group$, its $d$\dmn\ \statesp\ is foliated
%by $N$\dmn\ group orbits, and the symmetry-\reducedsp\
%$\pS/\Group$ is $(d\!-\!N)$\dmn.
%The simplest continuous symmetry groups are the 1-parameter compact rotation
%group $\SOn{2}$ and the 1-parameter noncompact translation group
%$T(1)$; here we shall focus on the $\SOn{2}$ case.

So far, we have not put any constraints on the symmetry group that we are quotienting, 
other than the requirement that it be Abelian.
From here on, we restrict our discussion to 1-parameter compact $\SOn{2}$
rotations that arise in spatially extended systems. \DBedit{In order to construct
a representation for $\SOn{2}$} \DB{}{What are we trying to say exactly here?} let us take a Fourier series expansion of
a real valued smooth periodic function:
\beq
	a(x,\zeit) = \sum\limits_{k=- \infty}^\infty a_k\left(\zeit\right) e^{i k x}, \,\,\,a_k = x_k + i y_k.
\ee{FourierSeries}
Truncating the expansion to $m$ modes, we
write the real and imaginary parts of the Fourier coefficients with
$k \geq 1$ as the state vector $\ssp = (x_1, y_1, x_2, y_2,..., x_m, y_m)$. The action of the $\SOn{2}$ group on this vector
can then be expressed as a block diagonal matrix:
%More explicit form, does not fit in a column:
%\beq
	 %\LieEl (\theta)= \\
					  %\begin{pmatrix}
					  %\cos \theta & \sin \theta & 0               & 0              & \cdots & 0              & 0               \\
					 %-\sin \theta & \cos \theta & 0               & 0              & \cdots & 0              & 0               \\
					  %0             & 0 		   & \cos 2 \theta & \sin 2 \theta & \cdots & 0              & 0               \\
					  %0             & 0            &-\sin 2 \theta & \cos 2 \theta & \cdots & 0              & 0               \\
					  %\vdots       & \vdots      & \vdots         & \vdots        & \ddots & \vdots         & \vdots         \\
					  %0             & 0 		   & 0               & 0              & \cdots & \cos m \theta & \sin m \theta  \\
					  %0             & 0            & 0	             & 0              & \cdots &-\sin m \theta & \cos m \theta
					  %\end{pmatrix}
%\eeq
\beq
	\LieEl(\theta) = \begin{pmatrix}
						R(\theta) & 0 			  & \cdots & 0 \\
						0		   & R(2 \theta) & \cdots & 0 \\
						\vdots	   & \vdots 	  & \ddots & \vdots \\
						0		   & 0	          & \cdots & R (m \theta)
					   \end{pmatrix} ,
\ee{mmodeLieEl}
where
\beq
	R(n \theta) =	\begin{pmatrix}
					\cos n \theta & - \sin n \theta \\
					\sin n \theta & \cos n \theta
					\end{pmatrix}
\ee{rotationmatrix}
is the rotation matrix for $n$th Fourier mode.
The Lie algebra generator for $\LieEl(\theta)$ is given by
\beq
	 \Lg =  \begin{pmatrix}
			 0 & -1 & 0 & 0 & \cdots & 0 & 0 \\
			 1 & 0 & 0 & 0 & \cdots & 0 & 0 \\
			 0 & 0 & 0 & -2 & \cdots & 0 & 0 \\
			 0 & 0 & 2 & 0 & \cdots & 0 & 0 \\
			 \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
			 0 & 0 & 0 & 0 & \cdots & 0 & -m \\
			 0 & 0 & 0 & 0 & \cdots & m & 0
			 \end{pmatrix} .
\ee{mmodeLg}

In order to construct a \slicePlane\ for such a system, let us choose the following \slice\ \template:
\beq
	\slicep = (1, 0, ..., 0) .
\ee{firstmodetemp}
The \slice\ condition \refeq{SliceCond} then constraints points on the reduced trajectory to the hyperplane given by
\beq
	\sspRed = (\hat{x}_1, 0, \hat{x}_2, \hat{y}_2, ..., \hat{x}_m, \hat{y}_m) .
\ee{slicetemp}
In order to satisfy the requirement that group orbits cross the \slice\ once and only once, we also restrict the \slicePlane\ to the half-space where $\hat{x}_1 > 0$. Without this requirement group orbits would pierce the \slicePlane\ twice. A \slicePlane\ can be constructed in this manner for any choice of template, allowing the symmetry reduction of the dynamics in a neighborhood bounded by the \sliceBord\ \refeq{ChartBordCond}. The power of choosing template \refeq{firstmodetemp} becomes apparent by analyzing the border of its \slicePlane. The points on the \refeq{slicetemp} only lie on the \sliceBord\ if $\hat{x}_1 = 0$. This means that as long the dynamics are such that the magnitude of the first mode never vanishes, \emph{every} group orbit is guaranteed to have a unique representative point on the \slicePlane.

\footnote{Note that, in general, any template of the form $\slicep = (\hat{x}'_1, \hat{y}'_1, 0,...,0)$ would work just as well since the first mode has the symmetry of a circle. We picked the \slice\ \template\
\refeq{firstmodetemp} for computational convenience.} 
%

The \template\ \refeq{firstmodetemp} for $\SOn{2}$ was introduced in \refref{BudCvi14}
and is different than the ones that were used in the previous implementations
\rf{rowley_reconstruction_2000,BeTh04,SiCvi10,FrCv11,atlas12,ACHKW11}
of the \mslices, in the sense that it is solely geometrical and it does
not necessarily carry any information about the dynamics. More insight is
gained by writing the reduced evolution equations \refeq{eq:so2reduced}
explicitly for the template \refeq{firstmodetemp}:
\bea
\velRed ( \sspRed )          &=& \vel(\sspRed)
   - \frac{\vel(\sspRed)_2}{\sspRed_1} \, \groupTan(\sspRed)
\label{e-so2red1stmode}
\,.
\eea
\ES{2014-05-15}{$\vel(\sspRed)_2$ has not been introduced and is very confusing. I would suggest
using the notation of BudCvi14.tex: state space point is $a$, real variables are
$x_i$ and $y_i$ and right velocity components explicitly.
}
In order to regulate the near-divergent behavior of the velocity function
in \refeq{e-so2red1stmode} close to $\sspRed_1 = \sspRed_2 = 0$, rescaled time variable
$d \tau = dt / \sspRed_1$ was defined in \refref{BudCvi14}. While rescaling
time is essential for resolving the orbits during close passages to
$\sspRed_1 = 0$, in the study of the \twoMode\ system, we will omit this
step since the vanishing 1st mode corresponds to the invariant subspace of
the flow and hence is never visited by the dynamics.

\subsection{Postproccessing approach}
\label{s-slice2modes}

\ES{2014-05-15}{This section is a regression to the ``method of moving frames'' (postprocessing approach)
and as such belongs here. It has to be generalized a bit (I will do it if you agree with the change).
Second mode \slice\ can be used also for integration on the \slice\ and can be introduced earlier.
}

\begin{figure}%[H]
\centering
 \includegraphics[width=0.45\textwidth]{BBgorbitsandslice}
\caption{$\SOn{2}$ Group orbits of $(0.75, 0, 0.1, 0.1)$ (orange), $(0.5, 0, 0.5, 0.5)$ (green)
$(0.1, 0, 0.75, 0.75)$ (pink) of two Fourier modes and the first mode \slicePlane\
projected on three dimensions. 3D projections of the group tangents at the
intersections with the \slicePlane\ are shown as red arrows.}
\label{fig:BBgorbitsandslice}
\end{figure}

In \refsect{s-slice}, we explained the general procedure for reducing
the \SOn{2} symmetry by \mslices, here, we are going to focus on its
geometrical interpretation by narrowing the consideration down to the \twoMode\
system. The \slice\ defined by \refeq{firstmodetemp} and the direction
constraint $x_1 > 0$ fixes the phase of the first complex Fourier mode to $0$;
and the \statesp\ points are related to their \slice\ ``representatives''
by the following $\Un{1}$ action:
\beq
	\sspRedC_n = e^{-\ii n \phi_1} \sspC_n \, .
\ee{e-1stmodeTransform}
We immediately see that the reconstruction phase in \refeq{eq:so2reduced}
is, for this particular \slice, the phase of the first mode without the
symmetry reduction. The relation \refeq{e-1stmodeTransform} provides us
another interpretation for the \sliceBord :  For the template \refeq{firstmodetemp},
\sliceBord\ condition \refeq{ChartBordCond} yields,
$|\sspRedC_1| = |\sspC_1| = 0$, this means that the phase of the first Fourier
mode is not defined, hence the transformation \refeq{e-1stmodeTransform}
has no meaning. We illustrated this by drawing the $3D$ projections of the
group orbits, and group tangents of three reduced \statesp\ points in
\reffig{fig:BBgorbitsandslice}. Note, in \reffig{fig:BBgorbitsandslice}
that as the magnitude of the first mode, $\sqrt{x_1^2 + y_1^2}$, relative
to that of the second mode becomes smaller, its respective group tangent
has a larger component that lies within the \slice; \sliceBord\ condition
\refeq{ChartBordCond} is satisfies when the group tangent is entirely in the \slice.

An immediate generalization of the transformation \refeq{e-1stmodeTransform},
can be fixing the phase of the higher Fourier modes; this, however, requires
some extra care as we shall explain for the second Fourier mode next.
Consider the phase-fixing transformation,
\beq
	\sspRedC_n = e^{-\ii n \phi_2/2} \sspC_n \, ,
	\label{e-2ndmodeTransform}
\eeq
which would fix the phase of $\sspRedC_2$ to $0$. Note, however, that
$\phi_2 \in (0, 2 \pi]$ in can have discontinuities of $2 \pi$, and this
would translate to the transformation of the first Fourier mode by \refeq{e-2ndmodeTransform}
as a phase discontinuity of $\pi$. This discontinuity can be fixed by another
transformation:
\bea
	\tilde{\sspC}_1 &=& e^{-\ii 2 \hat{\phi}_1} |\sspRedC_1 | \, , \continue
	\tilde{\sspC}_{n \neq 1} &=& \sspRedC_n \, ,
	\label{e-PhaseDoubling}
\eea
where we simply doubled the phase $\hat{\phi}_1$ of the symmetry-reduced
first mode $\sspRedC_1$, obtained by \refeq{e-2ndmodeTransform} and left
the rest of the modes unchanged. Combination of \refeq{e-2ndmodeTransform}
and \refeq{e-PhaseDoubling} is a valid symmetry reduction scheme since every
group orbit is represented by a single point, furthermore, it is also continuous
and revertible hence one can make further computations, such as constructing
Poincar\'{e} sections, using this form. For the 2-mode case at hand, representation
\refeq{e-PhaseDoubling} does not have any particular advantage against
\refeq{e-1stmodeTransform}, however, for higher dimensional flows, second
(or higher) Fourier mode subspaces can have dynamical importance as shown in
\refref{SCD07}. In order to capture those regions of the \statesp\ this
representation would be a useful alternative.

\subsection{Polar coordinates}
\label{s-polar}

In \refref{PoKno05}, a polar coordinate representation of \refeq{eq:DangSO2}
is obtained by defining the $\LieEl$-invariant phase: $\Phi = \phi_2 - 2 \phi_1$
and three symmetry invariant coordinates $(r_1, r_2 \cos \Phi, r_2 \sin \Phi)$.
One can see by direct comparison with \refeq{e-1stmodeTransform}, which
yields $\sspRedC_1 = r_1$ and $\sspRedC_2 = r_2 e^{\ii \Phi}$, that this
representation is a special case $(m=2)$, of the \slice\ defined by
\refeq{firstmodetemp}. Corresponding ODEs for the polar representation
were obtained in \refref{PoKno05} by  chain rule and substitution. Note
that \mslices\ provides a general form \refeq{e-so2red1stmode} for symmetry
reduced time evolution.
