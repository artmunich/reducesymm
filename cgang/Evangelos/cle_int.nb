(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     15643,        452]
NotebookOptionsPosition[     14405,        413]
NotebookOutlinePosition[     14741,        428]
CellTagsIndexPosition[     14698,        425]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["ES \tCreated file \t\t2012 -06-01", "Text",
 CellChangeTimes->{{3.544184874997901*^9, 3.544184929678816*^9}, {
  3.547562877782094*^9, 3.547562880550231*^9}}],

Cell["\<\
Integrate and visualize phase space of complex Lorenz equation.\
\>", "Text",
 CellChangeTimes->{{3.544184936182323*^9, 3.54418499075439*^9}, {
  3.5441854274209633`*^9, 3.544185534107278*^9}, {3.5475628856756496`*^9, 
  3.5475629042654047`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.544772277445504*^9, 3.54477229320197*^9}}],

Cell["Aesthetics, functionality etc", "Text",
 CellChangeTimes->{{3.544963378135149*^9, 3.5449634000763483`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"manAppear", "=", 
   RowBox[{"Appearance", "\[Rule]", " ", "\"\<Open\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.544963415618672*^9, 3.544963439414976*^9}}],

Cell["Pick default parameters. ", "Text",
 CellChangeTimes->{{3.54416890101201*^9, 3.544168908187469*^9}, {
   3.5441793192258787`*^9, 3.544179320817676*^9}, 3.5441849345717916`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "=", "28"}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"8", "/", "3"}]}], ";", 
  RowBox[{"e", "=", 
   RowBox[{"1", "/", "10"}]}], ";", 
  RowBox[{"\[Sigma]", "=", "10"}], ";"}]], "Input"],

Cell[TextData[{
 "function which defines and integrates the system for given parameters, \
initial condition, and tmin, tmax returns ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ",", " ", "y", ",", " ", "z"}], TraditionalForm]]],
 " as function of time."
}], "Text",
 CellChangeTimes->{{3.544775615846876*^9, 3.544775640751071*^9}, {
  3.544775694680209*^9, 3.544775697576086*^9}, {3.5475630628971786`*^9, 
  3.547563090459916*^9}, {3.547563134489765*^9, 3.547563136134453*^9}, {
  3.547563184052786*^9, 3.547563195939391*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solParIC", "[", 
   RowBox[{
   "t_", ",", "\[Rho]_", ",", "b_", ",", "e_", ",", "\[Sigma]_", ",", 
    "ic_List", ",", "tmin_", ",", "tmax_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"solParIC", "[", 
    RowBox[{
    "t", ",", "\[Rho]", ",", "b", ",", "e", ",", "\[Sigma]", ",", "ic", ",", 
     "tmin", ",", "tmax"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqs", ",", "vars", ",", "sol", ",", "v", ",", "d"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", "tt_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Sigma]"}], " ", 
           RowBox[{"x", "[", "tt", "]"}]}], "+", 
          RowBox[{"\[Sigma]", " ", 
           RowBox[{"y", "[", "tt", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"x", "[", "tt", "]"}]}], " ", 
           RowBox[{"z", "[", "tt", "]"}]}], "+", 
          RowBox[{"\[Rho]", " ", 
           RowBox[{"x", "[", "tt", "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"I", " ", "e"}]}], ")"}], " ", 
           RowBox[{"y", "[", "tt", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "b"}], " ", 
           RowBox[{"z", "[", "tt", "]"}]}], "+", 
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Conjugate", "[", 
               RowBox[{"x", "[", "tt", "]"}], "]"}], " ", 
              RowBox[{"y", "[", "tt", "]"}]}], "+", 
             RowBox[{
              RowBox[{"x", "[", "tt", "]"}], " ", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"y", "[", "tt", "]"}], "]"}]}]}], ")"}]}]}]}], "}"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vars", "[", "tt_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "tt", "]"}], ",", 
         RowBox[{"y", "[", "tt", "]"}], ",", 
         RowBox[{"z", "[", "tt", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"vars", "[", "t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"eqs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"vars", "[", "t", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"v", "[", "t", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "[", 
        RowBox[{"z1ic_", ",", "z2ic_", ",", "t1_", ",", "t2_"}], "]"}], ":=", 
       
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"eqs", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"vars", "[", "0", "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
               RowBox[{"ic", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], " ", 
           "}"}], "]"}], ",", 
         RowBox[{"vars", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "t1", ",", "t2"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "[", 
        RowBox[{
         RowBox[{"ic", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"ic", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "tmin", ",", "tmax"}], "]"}], "//",
        "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.544775602178562*^9, 3.544775612121307*^9}, {
   3.5447756569050083`*^9, 3.544775724191353*^9}, 3.54479962658994*^9, {
   3.5475630206294127`*^9, 3.547563040075498*^9}, {3.5475632119616003`*^9, 
   3.547563234046383*^9}, {3.5475633116167088`*^9, 3.547563497189534*^9}, {
   3.547563712460333*^9, 3.547563720163723*^9}, {3.547563863303507*^9, 
   3.547563971345945*^9}, {3.5475640019146147`*^9, 3.547564002536984*^9}, 
   3.54756447976019*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol0", "[", "t_", "]"}], "=", 
  RowBox[{"solParIC", "[", 
   RowBox[{"t", ",", "\[Rho]", ",", "b", ",", "e", ",", "\[Sigma]", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "10"}], "}"}], ",", "0", ",", "100"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.547564013855042*^9, 3.547564064995345*^9}, 
   3.5475642621094007`*^9, 3.547564408911807*^9}],

Cell[BoxData[
 RowBox[{"sol0", "[", "3", "]"}]], "Input",
 CellChangeTimes->{{3.547564228474626*^9, 3.547564302528275*^9}}],

Cell[BoxData[
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], "//", "Re"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "t", "]"}], "//", "Re"}], ",", 
      RowBox[{
       RowBox[{"z", "[", "t", "]"}], "//", "Re"}]}], "}"}], "/.", 
    RowBox[{"sol0", "[", "t", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "50"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5475640764089727`*^9, 3.5475640783697166`*^9}, {
   3.547564121877757*^9, 3.547564189622797*^9}, {3.547564221119376*^9, 
   3.547564221223859*^9}, {3.547564274983245*^9, 3.547564284808605*^9}, {
   3.547564329174945*^9, 3.547564333290785*^9}, {3.5475643690888443`*^9, 
   3.547564422057857*^9}, 3.5477865649335947`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rot", "[", "th_", "]"}], ":=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "th"}], "]"}], ",", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "th"}], "]"}], ",", "1"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.548427112726866*^9, 3.548427124978426*^9}, {
  3.548427158648355*^9, 3.548427187798277*^9}, {3.548427506979024*^9, 
  3.548427508487605*^9}}],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"rot", "[", "a", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5484274814568043`*^9, 3.548427491864902*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotDer", "[", "th_", "]"}], "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"rot", "[", "th", "]"}], ",", "th"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548427189795396*^9, 3.548427222821368*^9}, {
  3.5484272998353643`*^9, 3.548427352451791*^9}, {3.548427539146627*^9, 
  3.548427540684813*^9}}],

Cell[BoxData[
 RowBox[{"rotGen", "=", 
  RowBox[{"rotDer", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.548427532826359*^9, 3.548427561152821*^9}}],

Cell[BoxData[
 RowBox[{"TableForm", "[", "rotGen", "]"}]], "Input",
 CellChangeTimes->{{3.548427342084506*^9, 3.548427390073703*^9}, {
  3.5484274202813673`*^9, 3.54842742073841*^9}, {3.548427457836273*^9, 
  3.5484274752962513`*^9}, {3.548427565267516*^9, 3.548427570642518*^9}}],

Cell[BoxData[
 RowBox[{"rotGen", ".", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.548427572781887*^9, 3.548427578040863*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sliceCond", "[", 
   RowBox[{"x_List", ",", "templ_List", ",", "th_"}], "]"}], ":=", 
  RowBox[{"ComplexExpand", "[", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Conjugate", "[", "x", "]"}], ".", 
       RowBox[{"rot", "[", 
        RowBox[{"-", "th"}], "]"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"rotGen", ".", "templ"}], ")"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548427646283306*^9, 3.5484277403844213`*^9}, 
   3.548428010959774*^9, 3.548428164535964*^9, {3.548442212620851*^9, 
   3.548442221396084*^9}, {3.5484422716196423`*^9, 3.548442279619231*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sliceCond", "[", 
   RowBox[{"x_List", ",", "templ_List"}], "]"}], ":=", 
  RowBox[{"ComplexExpand", "[", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"Conjugate", "[", "x", "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"rotGen", ".", "templ"}], ")"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548442820949328*^9, 3.548442839096561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xtmp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.18", "+", 
      RowBox[{"0.3", "I"}]}], ",", 
     RowBox[{"0.2", "+", 
      RowBox[{"0.2", "I"}]}], ",", "30"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548428137231469*^9, 3.548428152597471*^9}}],

Cell[BoxData[
 RowBox[{"templtmp", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.21", "+", 
     RowBox[{"0.32", "I"}]}], ",", 
    RowBox[{"0.28", "+", 
     RowBox[{"0.18", "I"}]}], ",", "28"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.548428203892619*^9, 3.5484282138062983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rot2chart", "[", 
   RowBox[{"x_List", ",", "templ_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"thSol", ",", "xRot", ",", "nrm"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"thSol", "=", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sliceCond", "[", 
          RowBox[{"x", ",", "templ", ",", "th"}], "]"}], "\[Equal]", "0"}], 
        ",", "th"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xRot", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rot", "[", "th", "]"}], ".", "x"}], ")"}], "/.", 
       "thSol"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nrm", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"#", "-", "templ"}], "]"}], "&"}], ",", "xRot", ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xRot", "[", 
       RowBox[{"[", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"nrm", ",", 
           RowBox[{"Min", "[", "nrm", "]"}]}], "]"}], "//", "First"}], " ", 
        "]"}], "]"}], "//", "First"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5484422414346323`*^9, 3.548442549762607*^9}}],

Cell[BoxData[
 RowBox[{"rot2chart", "[", 
  RowBox[{"xtmp", ",", "templtmp"}], "]"}]], "Input",
 CellChangeTimes->{{3.5484423698374033`*^9, 3.5484423771314373`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rot2slice", "[", 
   RowBox[{"x_List", ",", "templ_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "xRot", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xRot", "=", 
      RowBox[{"rot2chart", "[", 
       RowBox[{"x", ",", 
        RowBox[{
        "templ", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       " ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sliceCond", "[", 
      RowBox[{"xRot", ",", 
       RowBox[{
       "templ", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.548442578368896*^9, 3.548442609434883*^9}, {
  3.548442666467703*^9, 3.5484427626589813`*^9}}],

Cell[BoxData[
 RowBox[{"templtmp2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.2", "+", 
     RowBox[{"0.32", "I"}]}], ",", 
    RowBox[{"0.28", "+", 
     RowBox[{"0.18", "I"}]}], ",", "28"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5484428581459427`*^9, 3.548442903056697*^9}}],

Cell[BoxData[
 RowBox[{"rot2slice", "[", 
  RowBox[{"xtmp", ",", 
   RowBox[{"{", 
    RowBox[{"templtmp", ",", "templtmp2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.548442845201438*^9, 3.5484428799754543`*^9}}]
},
WindowSize->{1440, 850},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Linux x86 (64-bit) (February 25, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 164, 2, 31, "Text"],
Cell[712, 24, 256, 5, 31, "Text"],
Cell[971, 31, 138, 2, 32, "Input"],
Cell[1112, 35, 113, 1, 31, "Text"],
Cell[1228, 38, 196, 4, 32, "Input"],
Cell[1427, 44, 182, 2, 31, "Text"],
Cell[1612, 48, 229, 7, 32, "Input"],
Cell[1844, 57, 527, 11, 31, "Text"],
Cell[2374, 70, 4619, 121, 187, "Input"],
Cell[6996, 193, 396, 9, 32, "Input"],
Cell[7395, 204, 123, 2, 32, "Input"],
Cell[7521, 208, 799, 19, 32, "Input"],
Cell[8323, 229, 497, 14, 32, "Input"],
Cell[8823, 245, 160, 3, 32, "Input"],
Cell[8986, 250, 336, 8, 32, "Input"],
Cell[9325, 260, 153, 3, 32, "Input"],
Cell[9481, 265, 280, 4, 32, "Input"],
Cell[9764, 271, 177, 4, 32, "Input"],
Cell[9944, 277, 661, 16, 32, "Input"],
Cell[10608, 295, 386, 10, 32, "Input"],
Cell[10997, 307, 301, 9, 32, "Input"],
Cell[11301, 318, 286, 8, 32, "Input"],
Cell[11590, 328, 1352, 39, 143, "Input"],
Cell[12945, 369, 165, 3, 32, "Input"],
Cell[13113, 374, 776, 20, 99, "Input"],
Cell[13892, 396, 286, 8, 32, "Input"],
Cell[14181, 406, 220, 5, 32, "Input"]
}
]
*)

(* End of internal cache information *)
