(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.0'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     14956,        351]*)
(*NotebookOutlinePosition[     15617,        374]*)
(*  CellTagsIndexPosition[     15573,        370]*)
(*WindowFrame->Normal*)



Notebook[{
Cell[BoxData[
    \(\(Clear[wd];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(wd[] := 
        StringDrop[
          Directory[], \(Flatten[
                StringPosition[Directory[], 
                  ParentDirectory[Directory[]]]\ ]\)[\([2]\)] + 
            1];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(fp = FourierParameters \[Rule] {\(-1\), 1};\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uSpatial[u_, L_] := 
      Module[{ux, uxx, dx, d}, 
        d = \(Dimensions[u]\)[\([1]\)]; \[IndentingNewLine]dx = 
          L/\((d - 1)\); 
        ux = Table[Null, {d}]; \[IndentingNewLine]Do[
          ux[\([i]\)] = \((u[\([Mod[i + 1, d, 1]]\)] - 
                  u[\([Mod[i - 1, d, 1]]\)])\)/\((2  dx)\), {i, 1, 
            d}]; \[IndentingNewLine]uxx = 
          Table[Null, {d}]; \[IndentingNewLine]Do[
          uxx[\([i]\)] = \((ux[\([Mod[i + 1, d, 1]]\)] - 
                  ux[\([Mod[i - 1, d, 1]]\)])\)/\((2  dx)\), {i, 1, 
            d}]; \[IndentingNewLine]Table[{u[\([i]\)], ux[\([i]\)], 
            uxx[\([i]\)]}, {i, 1, d}]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uDer[u_, n_, L_] := 
      Module[{a, d}, \[IndentingNewLine]d = \(Dimensions[u]\)[\([1]\)]; 
        a = Fourier[u, fp]; 
        Do[a[\([k + 1]\)] = \(\((\(-2\) \[Pi]\ I\ k/L)\)\^n\) 
              a[\([k + 1]\)], {k, 0, d/2}]; 
        Do[a[\([d + 1 - k]\)] = Conjugate[a[\([1 + k]\)]], {k, 1, 
            d/2 - 1}]\ ; \ 
        Chop[InverseFourier[a, fp], 10^\(-10\)]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uShiftF[u_, sh_, L_] := 
      Module[{a, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        a = Fourier[u, fp]; \[IndentingNewLine]Do[
          a[\([k + 1]\)] = Exp[\(-2\)\ \[Pi]\ sh\ I\ k/L] a[\([k + 1]\)], {k, 
            1, d/2 + 1}]; \[IndentingNewLine]Do[
          a[\([d + 1 - k]\)] = Conjugate[a[\([1 + k]\)]], {k, 1, 
            d/2 - 1}]; \[IndentingNewLine]Chop[InverseFourier[a, fp], 
          10^\(-9\)]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(uShiftFTraj[traj_, sh_, L_] := 
        Map[uShiftF[#, sh, L] &, traj, {1}];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uClose[u_] := Append[u, u[\([1]\)]\ ]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uAntiSym[u_] := 
      Module[{uAnt, i, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        uAnt = Table[0, {d}]; 
        uAnt[\([1]\)] = \(-u[\([1]\)]\); \[IndentingNewLine]Do[
          uAnt[\([i + 1]\)] = \(-u[\([d + 1 - i]\)]\), {i, 1, d - 1}]; 
        uAnt]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uAntiImag[u_] := 
      Module[{i, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        Table[\(-u[\([Mod[d/2 + 1 - k + 1, d, 1]]\)]\), {k, 1, 
            d}]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uAntiShiftHalf[u_] := 
      Module[{uShift, i, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        uShift = Table[0, {d}]; \[IndentingNewLine]Do[
          uShift[\([i]\)] = \(-u[\([Mod[d/2 + i, d, 1]]\)]\), {i, 1, d}]; 
        uShift]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uShift[u_, s_] := 
      Module[{uShift, i, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        uShift = Table[0, {d}]; \[IndentingNewLine]Do[
          uShift[\([i]\)] = u[\([Mod[s + i, d, 1]]\)], {i, 1, d}]; 
        uShift]\)], "Input",
  InitializationCell->True],

Cell[BoxData[{
    \(Clear[hby]\), "\n", 
    \(hby[x_] := 
      Hue[0.7 + x/2] /; 0 \[LessEqual] x \[LessEqual] 0.5\), "\n", 
    \(hby[x_] := Hue[\((x - 0.5)\)/2.5] /; 0.5 < x \[LessEqual] 1\)}], "Input",\

  InitializationCell->True],

Cell[BoxData[
    \( (*plotEnergy[dir_, color_] := 
        Module[{d, Np, mE, mvx2, mvxx2, Etab, label}, \[IndentingNewLine]<< 
            Graphics`Graphics3D`; \[IndentingNewLine]Etab = 
            Import[dir <> "\</energy.dat\>"]; \[IndentingNewLine]d = \
\(Dimensions[Etab]\)[\([2]\)]; \[IndentingNewLine]Np = \(Dimensions[
                Etab]\)[\([1]\)]; \[IndentingNewLine]mE = 
            Sum[Etab[\([i, 1]\)], {i, 1, Np}]/Np; \[IndentingNewLine]mvx2 = 
            Sum[Etab[\([i, 2]\)], {i, 1, Np}]/Np; \[IndentingNewLine]mvxx2 = 
            Sum[Etab[\([i, 3]\)], {i, 1, Np}]/Np; \[IndentingNewLine]label = 
            StringDrop[
              dir, \(Flatten[
                  StringPosition[
                    dir, "\</\>"]]\)[\([\(-1\)]\)]]; \[IndentingNewLine]pm[
              label] = 
            ListPlot[{{mvx2, mvxx2}}, 
              PlotStyle \[Rule] {color, PointSize[pt]}, 
              DisplayFunction \[Rule] Identity]; \[IndentingNewLine]pme[
              label] = 
            ScatterPlot3D[{{mE, mvx2, mvxx2}}, 
              PlotStyle \[Rule] {color, PointSize[pt]}, 
              DisplayFunction \[Rule] Identity]; \[IndentingNewLine]plt[
              label] = 
            ListPlot[TakeColumns[Etab, {2, 3}], PlotJoined \[Rule] True, 
              PlotRange \[Rule] All, AspectRatio \[Rule] 1, 
              PlotStyle \[Rule] {color, 
                  Thickness[thck]}]; \[IndentingNewLine]plte[label] = 
            ScatterPlot3D[Etab, PlotJoined \[Rule] True, 
              PlotStyle \[Rule] {color, Thickness[thck]}]]*) \)], "Input",
  InitializationCell->True],

Cell[BoxData[{
    \(\(ToDir[file_] := 
        StringDrop[
          StringDrop[
            file, \(Flatten[
                StringPosition[
                  file, "\</\>"]]\)[\([\(-1\)]\)]], \(-4\)];\)\), "\n", 
    \(\(ToPeriod[file_] := 
        ToExpression[
          StringDrop[StringDrop[ToDir[file], 7], \(-7\)]];\)\), "\n", 
    \(\(ToShift[file_] := 
        ToExpression[StringDrop[ToDir[file], 14]];\)\)}], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(cInner[a_, b_] := Conjugate[a] . b;\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(coords[a_, b_, 
        ao_] := {cInner[a - ao, b[\([1]\)]], cInner[a - ao, b[\([2]\)]], 
          cInner[a - ao, b[\([3]\)]]} // Chop\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(fourTraj[traj_] := Map[Fourier[#, fp] &, traj, {1}];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(coordsTraj[traj_, b_, ao_] := 
        Map[coords[#, b, ao] &, traj, {1}];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(UnsortedUnion[x_List] := 
      Module[{len = Length[x], tmp}, 
        tmp = \(Split[
              Sort[Transpose[{x, 
                    Range[len]}]], \((#1[\([1]\)] === #2[\([1]\)] \
&)\)]\)[\([All, 1]\)]; \(Sort[
            Transpose[RotateLeft[Transpose[tmp]]]]\)[\([All, 
            2]\)]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(gsorth[x_] := 
      Module[{y, Nv, d, sm}, Nv = \(Dimensions[x]\)[\([1]\)]; 
        d = \(Dimensions[x]\)[\([2]\)]; \[IndentingNewLine]y = 
          Table[Null, {Nv}]; 
        y[\([1]\)] = x[\([1]\)]/Norm[x[\([1]\)]]; \[IndentingNewLine]Do[
          sm = Sum[
              Conjugate[y[\([j - k]\)]] . x[\([j]\)] y[\([j - k]\)], {k, 1, 
                j - 1}]; \[IndentingNewLine]y[\([j]\)] = \((x[\([j]\)] - 
                  sm)\)/Norm[x[\([j]\)] - sm], {j, 2, Nv}]; y]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(\(\[IndentingNewLine]\)\(\(d1[x_List, t_] := \(D[#, t] &\) /@ 
          x;\)\n\[IndentingNewLine]
    \(d2[x_List, t_] := \(D[#, t, t] &\) /@ x;\)\[IndentingNewLine]\n
    \(norm[x_List] := x/Sqrt[x . x];\)\n\[IndentingNewLine]
    \(FrenetFrame[x_List, t_, phi_, r_] := 
        Module[{xp, xpp, tangent, binormal, normal}, 
          xp = d1[x, t]; \[IndentingNewLine]xpp = 
            d2[x, t]; \[IndentingNewLine]tangent = 
            norm[xp]; \[IndentingNewLine]binormal = 
            norm[Cross[xp, xpp]]; \[IndentingNewLine]normal = 
            Cross[binormal, tangent]; \[IndentingNewLine]x + 
            normal*r*Cos[phi] + r*binormal*Sin[phi]];\)\n
    \)\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(plotEtab[dir_, c_] := 
      Module[{Etab, Nk, mE, pm, pme, p, pE, pE1, pE2, coord, cros, poinc, 
          plPoinc, rPoincE, rPoinc1, plrPoincE, 
          plrPoinc1}, \[IndentingNewLine]Etab = 
          Import[dir]; \[IndentingNewLine]Nk = \(Dimensions[
              Etab]\)[\([1]\)]; \[IndentingNewLine] (*\[IndentingNewLine]dif \
= Map[Greater[#, mind] &, 
              Map[Norm, 
                Etab\  - 
                  Table[Ec2, {\(Dimensions[Etab\ ]\)[\([1]\)]}], {1}], {1}]; 
          Etab = Pick[Etab\ , 
              dif]; \[IndentingNewLine]Nk = \(Dimensions[
                Etab\ ]\)[\([1]\)]; \[IndentingNewLine]ds = 
            Table[Norm[Etab\ [\([i + 1]\)] - Etab\ [\([i]\)]], {i, 
                1, \(Dimensions[Etab\ ]\)[\([1]\)] - 1}]; 
          s = Table[Null, {\(Dimensions[ds]\)[\([1]\)] + 1}]; s[\([1]\)] = 0; 
          Do[s[\([i + 1]\)] = s[\([i]\)] + ds[\([i]\)], {i, 
              1, \(Dimensions[ds]\)[\([1]\)]}]; \[IndentingNewLine]dS = 
            s[\([\(Dimensions[s]\)[\([1]\)]]\)]/Nk; \[IndentingNewLine]adum = 
            TakeColumns[Etab\ , {1}] // Flatten; \[IndentingNewLine]a1s = 
            Union[Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                  1, \(Dimensions[s]\)[\([1]\)]}]]; \[IndentingNewLine]adum = 
            TakeColumns[Etab\ , {2}] // Flatten; \[IndentingNewLine]a2s = 
            Union[Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                  1, \(Dimensions[s]\)[\([1]\)]}]]; \[IndentingNewLine]adum = 
            TakeColumns[Etab\ , {3}] // Flatten; \[IndentingNewLine]a3s = 
            Union[Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                  1, \(Dimensions[s]\)[\([1]\)]}]]; 
          aS = {Interpolation[a1s], Interpolation[a2s], Interpolation[a3s]}; 
          Etab\  = 
            Table[{\(aS[\([1]\)]\)[s*dS], \(aS[\([2]\)]\)[
                  s*dS], \(aS[\([3]\)]\)[s*dS]}, {s, 1, 
                Nk}];\[IndentingNewLine]*) \[IndentingNewLine]p\  = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {2}], 
              TakeColumns[Etab, {3}] - TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            AspectRatio -> Automatic, PlotStyle -> \ c\ , 
            FrameLabel -> \ {\*"\"\<<(\!\(u\_x\)\!\(\()\^2\)\)>\>\"", \
\*"\"\<<(\!\(u\_xx\)\!\(\()\^2\)\)>-<(\!\(u\_x\)\!\(\()\^2\)\)>\>\""}]; \
\[IndentingNewLine]pE = 
          ScatterPlot3D[
            AppendRows[TakeColumns[Etab, {1}], TakeColumns[Etab, {2}], 
              TakeColumns[Etab, {3}] - TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<<E>\>", \
\*"\"\<<(\!\(u\_x\)\!\(\()\^2\)\)>\>\"", \
\*"\"\<<(\!\(u\_xx\)\!\(\()\^2\)\)>\>\""}, 
            PlotStyle -> \ {c\ }]; \[IndentingNewLine]pE1 = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {1}], TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<E\>", \
\*"\"\<<(\!\(u\_x\)\!\(\()\^2\)\)>\>\""}, 
            PlotStyle -> \ c\ ]; \[IndentingNewLine]pE2 = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {1}], 
              TakeColumns[Etab, {3}] - TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {\*"\"\<<(\!\(u\_x\)\!\(\()\^2\)\)>\>\"", \
\*"\"\<<(\!\(u\_xx\)\!\(\()\^2\)\)>-<(\!\(u\_x\)\!\(\()\^2\)\)>\>\""}, 
            PlotStyle -> \ c\ ]; \[IndentingNewLine]coord = 
          Etab[\([All, 2]\)] - Etab[\([All, 3]\)]; \ncros = {Null}; \n
        Do[If[\ \((coord[\([i - 1]\)] > 0)\)\  && \ \((coord[\([i]\)] <= \ 
                  0)\), cros = Append[cros, {i}]], {i, 
            2, \(Dimensions[coord]\)[\([1]\)]}]; \ncros = Drop[cros, 1]; \n
        poinc = \((Extract[Etab[\([All, {1, 2}]\)], cros] + 
                Extract[Etab[\([All, {1, 2}]\)], cros - 1])\)/
            2; \[IndentingNewLine] (*\(plPoinc\  = \([poinc, 
                PlotStyle -> \ {c\ , PointSize[3*pt]}]\);\)*) \n
        plPoinc\  = 
          Show[Graphics[{c\ , Thickness[connPoincThck], 
                Map[Circle[#, connR] &, poinc]}], 
            AspectRatio -> Automatic\ \ , 
            DisplayFunction -> \ Identity]; \[IndentingNewLine]rPoincE = 
          Table[{poinc[\([i, 1]\)], poinc[\([i + 1, 1]\)]}, {i, 
              1, \(Dimensions[poinc]\)[\([1]\)] - 1}]; \n
        rPoinc1 = 
          Table[{poinc[\([i, 2]\)], poinc[\([i + 1, 2]\)]}, {i, 
              1, \(Dimensions[poinc]\)[\([1]\)] - 
                1}]; \[IndentingNewLine]plrPoincE\  = 
          ListPlot[rPoincE, PlotRange -> All, 
            PlotStyle -> {PointSize[pt]}\ \ , DisplayFunction -> \ Identity, 
            AspectRatio -> Automatic]; \[IndentingNewLine]plrPoinc1\  = 
          ListPlot[rPoinc1, PlotRange -> All, 
            PlotStyle -> {PointSize[pt]}\ \ , DisplayFunction -> \ Identity, 
            AspectRatio -> Automatic]; \[IndentingNewLine]{p, pE, pE1, 
          pE2}\[IndentingNewLine]]\)], "Input"]
},
FrontEndVersion->"5.0 for X",
ScreenRectangle->{{0, 1280}, {0, 1024}},
AutoGeneratedPackage->Automatic,
WindowSize->{654, 950},
WindowMargins->{{Automatic, 1}, {Automatic, 0}}
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{
Cell[1754, 51, 75, 2, 27, "Input",
  InitializationCell->True],
Cell[1832, 55, 253, 7, 59, "Input",
  InitializationCell->True],
Cell[2088, 64, 108, 2, 27, "Input",
  InitializationCell->True],
Cell[2199, 68, 711, 14, 123, "Input",
  InitializationCell->True],
Cell[2913, 84, 435, 9, 91, "Input",
  InitializationCell->True],
Cell[3351, 95, 477, 9, 91, "Input",
  InitializationCell->True],
Cell[3831, 106, 141, 3, 27, "Input",
  InitializationCell->True],
Cell[3975, 111, 98, 2, 27, "Input",
  InitializationCell->True],
Cell[4076, 115, 318, 7, 59, "Input",
  InitializationCell->True],
Cell[4397, 124, 213, 5, 43, "Input",
  InitializationCell->True],
Cell[4613, 131, 291, 6, 59, "Input",
  InitializationCell->True],
Cell[4907, 139, 280, 6, 59, "Input",
  InitializationCell->True],
Cell[5190, 147, 237, 6, 59, "Input",
  InitializationCell->True],
Cell[5430, 155, 1612, 29, 299, "Input",
  InitializationCell->True],
Cell[7045, 186, 458, 12, 75, "Input",
  InitializationCell->True],
Cell[7506, 200, 100, 2, 27, "Input",
  InitializationCell->True],
Cell[7609, 204, 196, 4, 43, "Input",
  InitializationCell->True],
Cell[7808, 210, 117, 2, 27, "Input",
  InitializationCell->True],
Cell[7928, 214, 139, 3, 27, "Input",
  InitializationCell->True],
Cell[8070, 219, 361, 9, 75, "Input",
  InitializationCell->True],
Cell[8434, 230, 539, 10, 91, "Input",
  InitializationCell->True],
Cell[8976, 242, 737, 14, 251, "Input",
  InitializationCell->True],
Cell[9716, 258, 5236, 91, 1081, "Input"]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

