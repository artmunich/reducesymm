(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.2'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     28850,        644]*)
(*NotebookOutlinePosition[     29511,        667]*)
(*  CellTagsIndexPosition[     29467,        663]*)
(*WindowFrame->Normal*)



Notebook[{
Cell[BoxData[
    \(\(Clear[wd];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(wd[] := 
        StringDrop[
          Directory[], \(Flatten[
                StringPosition[Directory[], 
                  ParentDirectory[Directory[]]]\ ]\)[\([2]\)] + 
            1];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(CleanInOut[] = 
        Module[{}, Unprotect[In, Out]; Clear[In, Out]; 
          Protect[In, Out]];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(fp = FourierParameters \[Rule] {\(-1\), 1};\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uSpatial[u_, L_] := 
      Module[{ux, uxx, dx, d}, 
        d = \(Dimensions[u]\)[\([1]\)]; \[IndentingNewLine]dx = 
          L/\((d - 1)\); 
        ux = Table[Null, {d}]; \[IndentingNewLine]Do[
          ux[\([i]\)] = \((u[\([Mod[i + 1, d, 1]]\)] - 
                  u[\([Mod[i - 1, d, 1]]\)])\)/\((2  dx)\), {i, 1, 
            d}]; \[IndentingNewLine]uxx = 
          Table[Null, {d}]; \[IndentingNewLine]Do[
          uxx[\([i]\)] = \((ux[\([Mod[i + 1, d, 1]]\)] - 
                  ux[\([Mod[i - 1, d, 1]]\)])\)/\((2  dx)\), {i, 1, 
            d}]; \[IndentingNewLine]Table[{u[\([i]\)], ux[\([i]\)], 
            uxx[\([i]\)]}, {i, 1, d}]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uDer[u_, n_, L_] := 
      Module[{a, d}, \[IndentingNewLine]d = \(Dimensions[u]\)[\([1]\)]; 
        a = Fourier[u, fp]; 
        Do[a[\([k + 1]\)] = \(\((\(-2\) \[Pi]\ I\ k/L)\)\^n\) 
              a[\([k + 1]\)], {k, 0, d/2}]; 
        Do[a[\([d + 1 - k]\)] = Conjugate[a[\([1 + k]\)]], {k, 1, 
            d/2 - 1}]\ ; \ 
        Chop[InverseFourier[a, fp], 10^\(-10\)]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uShiftF[u_, sh_, L_] := 
      Module[{a, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        a = Fourier[u, fp]; \[IndentingNewLine]Do[
          a[\([k + 1]\)] = Exp[\(-2\)\ \[Pi]\ sh\ I\ k/L] a[\([k + 1]\)], {k, 
            1, d/2 + 1}]; \[IndentingNewLine]Do[
          a[\([d + 1 - k]\)] = Conjugate[a[\([1 + k]\)]], {k, 1, 
            d/2 - 1}]; \[IndentingNewLine]Chop[InverseFourier[a, fp], 
          10^\(-9\)]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(uShiftFTraj[traj_, sh_, L_] := 
        Map[uShiftF[#, sh, L] &, traj, {1}];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uClose[u_] := Append[u, u[\([1]\)]\ ]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uAntiSym[u_] := 
      Module[{uAnt, i, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        uAnt = Table[0, {d}]; 
        uAnt[\([1]\)] = \(-u[\([1]\)]\); \[IndentingNewLine]Do[
          uAnt[\([i + 1]\)] = \(-u[\([d + 1 - i]\)]\), {i, 1, d - 1}]; 
        uAnt]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uAntiImag[u_] := 
      Module[{i, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        Table[\(-u[\([Mod[d/2 + 1 - k + 1, d, 1]]\)]\), {k, 1, 
            d}]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uAntiShiftHalf[u_] := 
      Module[{uShift, i, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        uShift = Table[0, {d}]; \[IndentingNewLine]Do[
          uShift[\([i]\)] = \(-u[\([Mod[d/2 + i, d, 1]]\)]\), {i, 1, d}]; 
        uShift]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(uShift[u_, s_] := 
      Module[{uShift, i, d}, d = \(Dimensions[u]\)[\([1]\)]; 
        uShift = Table[0, {d}]; \[IndentingNewLine]Do[
          uShift[\([i]\)] = u[\([Mod[s + i, d, 1]]\)], {i, 1, d}]; 
        uShift]\)], "Input",
  InitializationCell->True],

Cell[BoxData[{
    \(Clear[hby]\), "\n", 
    \(hby[x_] := 
      Hue[0.7 + x/2] /; 0 \[LessEqual] x \[LessEqual] 0.5\), "\n", 
    \(hby[x_] := Hue[\((x - 0.5)\)/2.5] /; 0.5 < x \[LessEqual] 1\)}], "Input",\

  InitializationCell->True],

Cell[BoxData[
    \( (*plotEnergy[dir_, color_] := 
        Module[{d, Np, mE, mvx2, mvxx2, Etab, label}, \[IndentingNewLine]<< 
            Graphics`Graphics3D`; \[IndentingNewLine]Etab = 
            Import[dir <> "\</energy.dat\>"]; \[IndentingNewLine]d = \
\(Dimensions[Etab]\)[\([2]\)]; \[IndentingNewLine]Np = \(Dimensions[
                Etab]\)[\([1]\)]; \[IndentingNewLine]mE = 
            Sum[Etab[\([i, 1]\)], {i, 1, Np}]/Np; \[IndentingNewLine]mvx2 = 
            Sum[Etab[\([i, 2]\)], {i, 1, Np}]/Np; \[IndentingNewLine]mvxx2 = 
            Sum[Etab[\([i, 3]\)], {i, 1, Np}]/Np; \[IndentingNewLine]label = 
            StringDrop[
              dir, \(Flatten[
                  StringPosition[
                    dir, "\</\>"]]\)[\([\(-1\)]\)]]; \[IndentingNewLine]pm[
              label] = 
            ListPlot[{{mvx2, mvxx2}}, 
              PlotStyle \[Rule] {color, PointSize[pt]}, 
              DisplayFunction \[Rule] Identity]; \[IndentingNewLine]pme[
              label] = 
            ScatterPlot3D[{{mE, mvx2, mvxx2}}, 
              PlotStyle \[Rule] {color, PointSize[pt]}, 
              DisplayFunction \[Rule] Identity]; \[IndentingNewLine]plt[
              label] = 
            ListPlot[TakeColumns[Etab, {2, 3}], PlotJoined \[Rule] True, 
              PlotRange \[Rule] All, AspectRatio \[Rule] 1, 
              PlotStyle \[Rule] {color, 
                  Thickness[thck]}]; \[IndentingNewLine]plte[label] = 
            ScatterPlot3D[Etab, PlotJoined \[Rule] True, 
              PlotStyle \[Rule] {color, Thickness[thck]}]]*) \)], "Input",
  InitializationCell->True],

Cell[BoxData[{
    \(\(ToDir[file_] := 
        StringDrop[
          StringDrop[
            file, \(Flatten[
                StringPosition[
                  file, "\</\>"]]\)[\([\(-1\)]\)]], \(-4\)];\)\), "\n", 
    \(\(toDir[file_] := 
        StringDrop[
          file, \(Flatten[
              StringPosition[
                file, "\</\>"]]\)[\([\(-1\)]\)]];\)\), "\[IndentingNewLine]", \

    \(\(ToPeriod[file_] := 
        ToExpression[
          StringDrop[StringDrop[ToDir[file], 7], \(-7\)]];\)\), "\n", 
    \(\(ToShift[file_] := 
        ToExpression[StringDrop[ToDir[file], 14]];\)\)}], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(cInner[a_, b_] := Conjugate[a] . b;\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(coords[a_, b_, 
        ao_] := {cInner[a - ao, b[\([1]\)]], cInner[a - ao, b[\([2]\)]], 
          cInner[a - ao, b[\([3]\)]]} // Chop\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(fourTraj[traj_] := Map[Fourier[#, fp] &, traj, {1}];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(coordsTraj[traj_, b_, ao_] := 
        Map[coords[#, b, ao] &, traj, {1}];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(UnsortedUnion[x_List] := 
      Module[{len = Length[x], tmp}, 
        tmp = \(Split[
              Sort[Transpose[{x, 
                    Range[len]}]], \((#1[\([1]\)] === #2[\([1]\)] \
&)\)]\)[\([All, 1]\)]; \(Sort[
            Transpose[RotateLeft[Transpose[tmp]]]]\)[\([All, 
            2]\)]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(dropRep[x_, prec_] := UnsortedUnion[SetPrecision[x, prec]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(elimPoints[traj_, ds_] := 
        Module[{straj, dif, cros}, 
          dif = Table[
              Norm[traj[\([i]\)] - traj[\([i + 1]\)]], {i, 
                1, \(Dimensions[traj]\)[\([1]\)] - 1}]; 
          cros = {Null}; \[IndentingNewLine]Do[
            If[dif[\([i]\)] > ds, cros = Append[cros, {i}]], {i, 
              1, \(Dimensions[dif]\)[\([1]\)]}]; 
          cros = Drop[cros, 1]; \[IndentingNewLine]straj = 
            Extract[traj, cros]];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(curvature[{x1_, y1_}, {x2_, y2_}, {x3_, y3_}] := 
      Module[{a, d, e, f}, \[IndentingNewLine]a = 
          Det[{{x1, y1, 1}, {x2, y2, 1}, {x3, y3, 
                1}}]; \[IndentingNewLine]d = \(-Det[{{x1\^2 + y1\^2, y1, 
                  1}, {x2\^2 + y2\^2, y2, 1}, {x3\^2 + y3\^2, y3, 
                  1}}]\); \[IndentingNewLine]e = 
          Det[{{x1\^2 + y1\^2, x1, 1}, {x2\^2 + y2\^2, x2, 
                1}, {x3\^2 + y3\^2, x3, 
                1}}]; \[IndentingNewLine]f = \(-Det[{{x1\^2 + y1\^2, x1, 
                  y1}, {x2\^2 + y2\^2, x2, y2}, {x3\^2 + y3\^2, x3, 
                  y3}}]\); \[IndentingNewLine]1/
          Sqrt[\((d\^2 + e\^2)\)/\((4\ a\^2)\) - 
              f\/a]\[IndentingNewLine]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(curvProbl[{x1_, y1_}, {x2_, y2_}, {x3_, y3_}] := 
      Module[{r, a, d, e, f, K}, \[IndentingNewLine]a = 
          Det[{{x1, y1, 1}, {x2, y2, 1}, {x3, y3, 
                1}}]; \[IndentingNewLine]d = \(-Det[{{x1\^2 + y1\^2, y1, 
                  1}, {x2\^2 + y2\^2, y2, 1}, {x3\^2 + y3\^2, y3, 
                  1}}]\); \[IndentingNewLine]e = 
          Det[{{x1\^2 + y1\^2, x1, 1}, {x2\^2 + y2\^2, x2, 
                1}, {x3\^2 + y3\^2, x3, 
                1}}]; \n\ \ \ \ f = \(-Det[{{x1\^2 + y1\^2, x1, 
                  y1}, {x2\^2 + y2\^2, x2, y2}, {x3\^2 + y3\^2, x3, 
                  y3}}]\); \[IndentingNewLine]K = 
          1/Sqrt[\((d\^2 + e\^2)\)/\((4\ a\^2)\) - 
                f\/a]; \[IndentingNewLine]If[\((Abs[a]\  < \ 
                10\^\(-17\))\)\ \  \[Or] \ \((\ Abs[K]\  > \ 10\^3)\), \ 
          True, False]\[IndentingNewLine]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(sPoints[traj_, ds_] := 
        Module[{straj, sdum, cros, s, dif}, 
          dif = Table[
              Norm[traj[\([i]\)] - traj[\([i + 1]\)]], {i, 
                1, \(Dimensions[traj]\)[\([1]\)] - 
                  1}]; \[IndentingNewLine]s = 
            Table[0, {\(Dimensions[dif]\)[\([1]\)] + 
                  1}]; \[IndentingNewLine]Do[
            s[\([i]\)] = s[\([i - 1]\)] + dif[\([i - 1]\)], {i, 
              2, \(Dimensions[
                  s]\)[\([1]\)]}]; \[IndentingNewLine]cros = {{1}}; \
\[IndentingNewLine]sdum = 0; \[IndentingNewLine]Do[
            If[\((s[\([i]\)] - sdum > 
                  ds)\)\  (*\ \(\[Or]\)\(curvProbl[traj[\([i - 1]\)], 
                    traj[\([i]\)], traj[\([i + 1]\)]]\)\ *) , 
              cros = Append[cros, {i}]; sdum = s[\([i]\)]], {i, 
              2, \(Dimensions[dif]\)[\([1]\)]}]; \[IndentingNewLine]cros = 
            Append[cros, {\(Dimensions[dif]\)[\([1]\)] + 
                  1}]; \[IndentingNewLine]straj = 
            Extract[traj, cros]];\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(gsorth[x_] := 
      Module[{y, Nv, d, sm}, Nv = \(Dimensions[x]\)[\([1]\)]; 
        d = \(Dimensions[x]\)[\([2]\)]; \[IndentingNewLine]y = 
          Table[Null, {Nv}]; 
        y[\([1]\)] = x[\([1]\)]/Norm[x[\([1]\)]]; \[IndentingNewLine]Do[
          sm = Sum[
              Conjugate[y[\([j - k]\)]] . x[\([j]\)] y[\([j - k]\)], {k, 1, 
                j - 1}]; \[IndentingNewLine]y[\([j]\)] = \((x[\([j]\)] - 
                  sm)\)/Norm[x[\([j]\)] - sm], {j, 2, Nv}]; y]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \( (*added\ b, 
      a\ as\ input\ arguments . \ 
          Change\ this\ in\ calling\ programs*) \)], "Input"],

Cell[BoxData[
    \(interpTraj[file_, b_, a_, Npt_, Nplt_, NpS_, rSkip_, nd_] := 
      Module[{vfile, vi, v, p, ds, s, dS, adum, a1s, a2s, a3s, aStab}, 
        vfile = OpenRead[file]; \[IndentingNewLine]aStab = 
          Table[Null, {Npt}]; \[IndentingNewLine]Do[
          vi = ReadList[vfile, Number, nd*Nplt, 
              RecordLists \[Rule] True]; \[IndentingNewLine]v = 
            Take[vi, {1, \(Dimensions[vi]\)[\([1]\)], 
                rSkip}]; \[IndentingNewLine]p = 
            coordsTraj[fourTraj[v], b, a]; \[IndentingNewLine]ds = 
            Table[Norm[p[\([i + 1]\)] - p[\([i]\)]], {i, 1, 
                Nplt - 1}]; \[IndentingNewLine]s = 
            Table[Null, {\(Dimensions[ds]\)[\([1]\)] + 
                  1}]; \[IndentingNewLine]s[\([1]\)] = 
            0; \[IndentingNewLine]Do[
            s[\([i + 1]\)] = s[\([i]\)] + ds[\([i]\)], {i, 
              1, \(Dimensions[ds]\)[\([1]\)]}]; \[IndentingNewLine]dS = 
            s[\([\(Dimensions[s]\)[\([1]\)]]\)]/
              NpS; \[IndentingNewLine]adum = 
            TakeColumns[p, {1}] // Flatten; \[IndentingNewLine]a1s = 
            Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                1, \(Dimensions[s]\)[\([1]\)]}]; \[IndentingNewLine]adum = 
            TakeColumns[p, {2}] // Flatten; \[IndentingNewLine]a2s = 
            Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                1, \(Dimensions[s]\)[\([1]\)]}]; \[IndentingNewLine]adum = 
            TakeColumns[p, {3}] // Flatten; \[IndentingNewLine]a3s = 
            Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                1, \(Dimensions[
                    s]\)[\([1]\)]}]; \[IndentingNewLine]aS = {Interpolation[
                a1s], Interpolation[a2s], 
              Interpolation[a3s]}; \[IndentingNewLine]aStab[\([j]\)] = 
            Table[{\(aS[\([1]\)]\)[sx*dS], \(aS[\([2]\)]\)[
                  sx*dS], \(aS[\([3]\)]\)[sx*dS]}, {sx, 1, NpS}], {j, 1, 
            Npt}]; \[IndentingNewLine]Close[
          vfile]; \[IndentingNewLine]aStab]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(interp1Traj[p_, rSkip_, dS_] := 
      Module[{pdum, ds, s, adum, Npt, NpS, aS, a1s, a2s, a3s, 
          aStab}, \[IndentingNewLine]pdum = 
          Take[p, {1, \(Dimensions[p]\)[\([1]\)], 
              rSkip}]; \[IndentingNewLine]Npt = \(Dimensions[
              p]\)[\([\)\(1\)\(]\)]; \[IndentingNewLine]Print[
          Dimensions[p]]; \[IndentingNewLine]ds = 
          Table[Norm[pdum[\([i + 1]\)] - pdum[\([i]\)]], {i, 1, 
              Npt - 1}]; \[IndentingNewLine]s = 
          Table[0, {Npt}]; \[IndentingNewLine]Print[
          Dimensions[ds]]; \[IndentingNewLine]Do[
          s[\([i + 1]\)] = s[\([i]\)] + ds[\([i]\)], {i, 1, 
            Npt - 1}]; \[IndentingNewLine]Print[
          Dimensions[s]]; \[IndentingNewLine]NpS = 
          Floor[s[\([\(Dimensions[s]\)[\([1]\)]]\)]/
              dS]; \[IndentingNewLine]adum = 
          TakeColumns[p, {1}] // Flatten; \[IndentingNewLine]a1s = 
          Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
              1, \(Dimensions[s]\)[\([1]\)]}]; \[IndentingNewLine]adum = 
          TakeColumns[p, {2}] // Flatten; \[IndentingNewLine]a2s = 
          Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
              1, \(Dimensions[s]\)[\([1]\)]}]; \[IndentingNewLine]adum = 
          TakeColumns[p, {3}] // Flatten; \[IndentingNewLine]a3s = 
          Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
              1, \(Dimensions[
                  s]\)[\([1]\)]}]; \[IndentingNewLine]aS = {Interpolation[
              a1s], Interpolation[a2s], 
            Interpolation[a3s]}; \[IndentingNewLine]aStab = 
          Table[{\(aS[\([1]\)]\)[sx*dS], \(aS[\([2]\)]\)[
                sx*dS], \(aS[\([3]\)]\)[sx*dS]}, {sx, 1, 
              NpS}]; \[IndentingNewLine]aStab]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(\(\[IndentingNewLine]\)\(apPoinc[traj_, coord_] := 
      Module[{cros, ctraj}, 
        cros = {Null}; \[IndentingNewLine]ctraj = 
          Take[traj, All, {coord}] // Flatten; \[IndentingNewLine]Do[
          If[\((ctraj[\([i - 1]\)] > 0)\) && \((ctraj[\([i]\)] \[LessEqual] 
                  0)\), cros = Append[cros, {i}]], {i, 
            2, \(Dimensions[ctraj]\)[\([1]\)]}]; \[IndentingNewLine]cros = 
          Drop[cros, 
            1]; \[IndentingNewLine]\((Extract[traj, cros] + 
              Extract[traj, cros - 1])\)/2]\)\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(\(\[IndentingNewLine]\)\(\(d1[x_List, t_] := \(D[#, t] &\) /@ 
          x;\)\n\[IndentingNewLine]
    \(d2[x_List, t_] := \(D[#, t, t] &\) /@ x;\)\[IndentingNewLine]\n
    \(norm[x_List] := x/Sqrt[x . x];\)\[IndentingNewLine]\n
    \(FrenetFrame[x_List, t_, phi_, r_] := 
        Module[{xp, xpp, tangent, binormal, normal}, 
          xp = d1[x, t]; \[IndentingNewLine]xpp = 
            d2[x, t]; \[IndentingNewLine]tangent = 
            norm[xp]; \[IndentingNewLine]binormal = 
            norm[Cross[xp, xpp]]; \[IndentingNewLine]normal = 
            Cross[binormal, tangent]; \[IndentingNewLine]x + 
            normal*r*Cos[phi] + r*binormal*Sin[phi]];\)\)\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(ruslanizE[list_] := \[IndentingNewLine]Map[Times[{2, 4, 4}, #] &, 
        list, {1}]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(plotEtab[Etab_, label_, c_, pt_:  0.01, 
        thck_:  0.005] := \[IndentingNewLine]Module[{Nk, coord, cros, poinc, 
          plPoinc, rPoincE, rPoinc1, plrPoincE, 
          plrPoinc1}, \[IndentingNewLine]Nk = \(Dimensions[
              Etab]\)[\([1]\)]; \[IndentingNewLine]mE = 
          Sum[Etab[\([i, 1]\)], {i, 1, Nk}]/Nk; \[IndentingNewLine]mP = 
          Sum[Etab[\([i, 2]\)], {i, 1, Nk}]/Nk; \[IndentingNewLine]mD = 
          Sum[Etab[\([i, 3]\)], {i, 1, Nk}]/Nk; \[IndentingNewLine]pEPEdot[
            label] = 
          ScatterPlot3D[
            AppendRows[TakeColumns[Etab, {1}], TakeColumns[Etab, {2}], 
              TakeColumns[Etab, {2}] - TakeColumns[Etab, {3}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<E\>", "\<P\>", \*"\"\<\!\(E\& . \)\>\""}, 
            PlotStyle -> \ {c\ }]; \[IndentingNewLine]pPEdot[label]\  = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {2}], 
              TakeColumns[Etab, {2}] - TakeColumns[Etab, {3}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            AspectRatio -> Automatic, PlotStyle -> {c, Thickness[thck]}, 
            FrameLabel -> \ {"\<P\>", \*"\"\<\!\(E\& . \)\>\""}]; \
\[IndentingNewLine]pmPD[label] = 
          ListPlot[{{mP, mD}}, PlotStyle \[Rule] {c, PointSize[pt]}, 
            DisplayFunction \[Rule] Identity]; \[IndentingNewLine]pmEP[
            label] = 
          ListPlot[{{mE, mP}}, PlotStyle \[Rule] {c, PointSize[pt]}, 
            DisplayFunction \[Rule] Identity]; \[IndentingNewLine]pmED[
            label] = 
          ListPlot[{{mE, mD}}, PlotStyle \[Rule] {c, PointSize[pt]}, 
            DisplayFunction \[Rule] Identity]; \[IndentingNewLine]pPD[
            label] = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {2}], TakeColumns[Etab, {3}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<P\>", "\<D\>"}, 
            PlotStyle -> {c, Thickness[thck]}]; \[IndentingNewLine]pEP[
            label] = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {1}], TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<E\>", "\<P\>"}, 
            PlotStyle -> {c, Thickness[thck]}]; \[IndentingNewLine]pED[
            label] = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {1}], TakeColumns[Etab, {3}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<E\>", "\<D\>"}, 
            PlotStyle -> {c, Thickness[thck]}]; \[IndentingNewLine]pDEdot[
            label] = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {3}], 
              TakeColumns[Etab, {2}] - TakeColumns[Etab, {3}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<D\>", \*"\"\<\!\(E\& . \)\>\""}, 
            PlotStyle -> {c, Thickness[thck]}]; \[IndentingNewLine]pEEdot[
            label] = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {1}], 
              TakeColumns[Etab, {2}] - TakeColumns[Etab, {3}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<E\>", \*"\"\<\!\(E\& . \)\>\""}, 
            PlotStyle -> {c, Thickness[thck]}]; \[IndentingNewLine]coord = 
          Etab[\([All, 3]\)] - 
            Etab[\([All, 
                2]\)]; \[IndentingNewLine]cros = {Null}; \
\[IndentingNewLine]Do[
          If[\ \((coord[\([i - 1]\)] > 0)\)\  && \ \((coord[\([i]\)] <= \ 
                  0)\), cros = Append[cros, {i}]], {i, 
            2, \(Dimensions[coord]\)[\([1]\)]}]; \[IndentingNewLine]cros = 
          Drop[cros, 
            1]; \[IndentingNewLine]poinc = \((Extract[
                  Etab[\([All, {1, 2}]\)], cros] + 
                Extract[Etab[\([All, {1, 2}]\)], cros - 1])\)/
            2; \[IndentingNewLine]label\[IndentingNewLine]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(plotEtabDir[dir_, c_, pt_:  0.01, 
        thck_:  0.005] := \[IndentingNewLine]Module[{Etab, 
          label}, \[IndentingNewLine]Etab = 
          ruslanizE@
            Import[dir <> "\</energy.dat\>"]; \[IndentingNewLine]label = 
          toDir[dir]; \[IndentingNewLine]plotEtab[Etab, label, c, pt, 
          thck]\[IndentingNewLine]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(energyTraj[traj_, L_] := 
      Module[{d, E, ux, uxx}, d = \(Dimensions[traj]\)[\([2]\)]; 
        ux = Map[uDer[#, 1, L] &, traj, {1}]; 
        uxx = Map[uDer[#, 2, L] &, traj, {1}]; 
        Transpose[{Table[
                Sum[traj[\([j, i]\)]\^2, {i, 1, d}], {j, 
                  1, \(Dimensions[traj]\)[\([1]\)]}\ ]/d, 
            Table[Sum[ux[\([j, i]\)]\^2, {i, 1, d}], {j, 
                  1, \(Dimensions[traj]\)[\([1]\)]}\ ]/d, 
            Table[Sum[uxx[\([j, i]\)]\^2, {i, 1, d}], {j, 
                  1, \(Dimensions[traj]\)[\([1]\)]}\ ]/d}]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(\(\[IndentingNewLine]\)\(\(Etab = Import[dir];\)\[IndentingNewLine]
      \(Nk = \(Dimensions[
              Etab]\)[\([1]\)];\)\[IndentingNewLine] (*\[IndentingNewLine]dif \
= Map[Greater[#, mind] &, 
            Map[Norm, 
              Etab\  - 
                Table[Ec2, {\(Dimensions[Etab\ ]\)[\([1]\)]}], {1}], {1}]; 
        Etab = Pick[Etab\ , 
            dif]; \[IndentingNewLine]Nk = \(Dimensions[
              Etab\ ]\)[\([1]\)]; \[IndentingNewLine]ds = 
          Table[Norm[Etab\ [\([i + 1]\)] - Etab\ [\([i]\)]], {i, 
              1, \(Dimensions[Etab\ ]\)[\([1]\)] - 1}]; 
        s = Table[Null, {\(Dimensions[ds]\)[\([1]\)] + 1}]; s[\([1]\)] = 0; 
        Do[s[\([i + 1]\)] = s[\([i]\)] + ds[\([i]\)], {i, 
            1, \(Dimensions[ds]\)[\([1]\)]}]; \[IndentingNewLine]dS = 
          s[\([\(Dimensions[s]\)[\([1]\)]]\)]/Nk; \[IndentingNewLine]adum = 
          TakeColumns[Etab\ , {1}] // Flatten; \[IndentingNewLine]a1s = 
          Union[Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                1, \(Dimensions[s]\)[\([1]\)]}]]; \[IndentingNewLine]adum = 
          TakeColumns[Etab\ , {2}] // Flatten; \[IndentingNewLine]a2s = 
          Union[Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                1, \(Dimensions[s]\)[\([1]\)]}]]; \[IndentingNewLine]adum = 
          TakeColumns[Etab\ , {3}] // Flatten; \[IndentingNewLine]a3s = 
          Union[Table[{s[\([i]\)], adum[\([i]\)]}, {i, 
                1, \(Dimensions[s]\)[\([1]\)]}]]; 
        aS = {Interpolation[a1s], Interpolation[a2s], Interpolation[a3s]}; 
        Etab\  = 
          Table[{\(aS[\([1]\)]\)[s*dS], \(aS[\([2]\)]\)[
                s*dS], \(aS[\([3]\)]\)[s*dS]}, {s, 1, 
              Nk}];\[IndentingNewLine]*) \[IndentingNewLine]
      \(p\  = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {2}], 
              TakeColumns[Etab, {3}] - TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            AspectRatio -> Automatic, PlotStyle -> {c, Thickness[thck]}, 
            FrameLabel -> \ {\*"\"\<<(\!\(u\_x\)\!\(\()\^2\)\)>\>\"", \
\*"\"\<<(\!\(u\_xx\)\!\(\()\^2\)\)>-<(\!\(u\_x\)\!\(\()\^2\)\)>\>\""}];\)\
\[IndentingNewLine]
      \(pE = 
          ScatterPlot3D[
            AppendRows[TakeColumns[Etab, {1}], TakeColumns[Etab, {2}], 
              TakeColumns[Etab, {3}] - TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<<E>\>", \
\*"\"\<<(\!\(u\_x\)\!\(\()\^2\)\)>\>\"", \
\*"\"\<<(\!\(u\_xx\)\!\(\()\^2\)\)>\>\""}, 
            PlotStyle -> \ {c\ }];\)\[IndentingNewLine]
      \(pE1 = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {1}], TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {"\<E\>", \
\*"\"\<<(\!\(u\_x\)\!\(\()\^2\)\)>\>\""}, 
            PlotStyle -> {c, Thickness[thck]}];\)\[IndentingNewLine]
      \(pE2 = 
          ListPlot[
            AppendRows[TakeColumns[Etab, {1}], 
              TakeColumns[Etab, {3}] - TakeColumns[Etab, {2}]]\ \ , 
            DisplayFunction -> \ Identity, PlotJoined -> True, 
            PlotRange -> All, AspectRatio -> Automatic, 
            FrameLabel -> \ {\*"\"\<<(\!\(u\_x\)\!\(\()\^2\)\)>\>\"", \
\*"\"\<<(\!\(u\_xx\)\!\(\()\^2\)\)>-<(\!\(u\_x\)\!\(\()\^2\)\)>\>\""}, 
            PlotStyle -> {c, Thickness[thck]}];\)\[IndentingNewLine]
      \(coord = Etab[\([All, 2]\)] - Etab[\([All, 3]\)];\)\n
      \(cros = {Null};\)\n
      \(Do[
          If[\ \((coord[\([i - 1]\)] > 0)\)\  && \ \((coord[\([i]\)] <= \ 
                  0)\), cros = Append[cros, {i}]], {i, 
            2, \(Dimensions[coord]\)[\([1]\)]}];\)\n
      \(cros = Drop[cros, 1];\)\n
      \(poinc = \((Extract[Etab[\([All, {1, 2}]\)], cros] + 
                Extract[Etab[\([All, {1, 2}]\)], cros - 1])\)/
            2;\)\[IndentingNewLine] (*\(plPoinc\  = \([poinc, 
              PlotStyle -> \ {c\ , PointSize[3*pt]}]\);\)*) \n
      \(plPoinc\  = 
          Show[Graphics[{c\ , Thickness[connPoincThck], 
                Map[Circle[#, connR] &, poinc]}], 
            AspectRatio -> Automatic\ \ , 
            DisplayFunction -> \ Identity];\)\[IndentingNewLine]
      \(rPoincE = 
          Table[{poinc[\([i, 1]\)], poinc[\([i + 1, 1]\)]}, {i, 
              1, \(Dimensions[poinc]\)[\([1]\)] - 1}];\)\n
      \(rPoinc1 = 
          Table[{poinc[\([i, 2]\)], poinc[\([i + 1, 2]\)]}, {i, 
              1, \(Dimensions[poinc]\)[\([1]\)] - 1}];\)\[IndentingNewLine]
      \(plrPoincE\  = 
          ListPlot[rPoincE, PlotRange -> All, 
            PlotStyle -> {PointSize[pt]}\ \ , DisplayFunction -> \ Identity, 
            AspectRatio -> Automatic];\)\[IndentingNewLine]
      \(plrPoinc1\  = 
          ListPlot[rPoinc1, PlotRange -> All, 
            PlotStyle -> {PointSize[pt]}\ \ , DisplayFunction -> \ Identity, 
            AspectRatio -> Automatic];\)\[IndentingNewLine]
      {p, pE, pE1, pE2}\[IndentingNewLine]
      \)\(]\)\)\)], "Input"]
},
FrontEndVersion->"5.2 for X",
ScreenRectangle->{{0, 1280}, {0, 1024}},
AutoGeneratedPackage->Automatic,
WindowSize->{629, 954},
WindowMargins->{{Automatic, 4}, {Automatic, 0}}
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{
Cell[1754, 51, 75, 2, 27, "Input",
  InitializationCell->True],
Cell[1832, 55, 253, 7, 59, "Input",
  InitializationCell->True],
Cell[2088, 64, 165, 4, 43, "Input",
  InitializationCell->True],
Cell[2256, 70, 108, 2, 27, "Input",
  InitializationCell->True],
Cell[2367, 74, 711, 14, 139, "Input",
  InitializationCell->True],
Cell[3081, 90, 435, 9, 91, "Input",
  InitializationCell->True],
Cell[3519, 101, 477, 9, 91, "Input",
  InitializationCell->True],
Cell[3999, 112, 141, 3, 27, "Input",
  InitializationCell->True],
Cell[4143, 117, 98, 2, 27, "Input",
  InitializationCell->True],
Cell[4244, 121, 318, 7, 59, "Input",
  InitializationCell->True],
Cell[4565, 130, 213, 5, 43, "Input",
  InitializationCell->True],
Cell[4781, 137, 291, 6, 59, "Input",
  InitializationCell->True],
Cell[5075, 145, 280, 6, 59, "Input",
  InitializationCell->True],
Cell[5358, 153, 237, 6, 59, "Input",
  InitializationCell->True],
Cell[5598, 161, 1612, 29, 299, "Input",
  InitializationCell->True],
Cell[7213, 192, 641, 18, 123, "Input",
  InitializationCell->True],
Cell[7857, 212, 100, 2, 27, "Input",
  InitializationCell->True],
Cell[7960, 216, 196, 4, 59, "Input",
  InitializationCell->True],
Cell[8159, 222, 117, 2, 27, "Input",
  InitializationCell->True],
Cell[8279, 226, 139, 3, 27, "Input",
  InitializationCell->True],
Cell[8421, 231, 361, 9, 91, "Input",
  InitializationCell->True],
Cell[8785, 242, 119, 2, 27, "Input",
  InitializationCell->True],
Cell[8907, 246, 525, 11, 123, "Input",
  InitializationCell->True],
Cell[9435, 259, 786, 14, 178, "Input",
  InitializationCell->True],
Cell[10224, 275, 926, 16, 199, "Input",
  InitializationCell->True],
Cell[11153, 293, 1090, 21, 219, "Input",
  InitializationCell->True],
Cell[12246, 316, 539, 10, 91, "Input",
  InitializationCell->True],
Cell[12788, 328, 130, 3, 27, "Input"],
Cell[12921, 333, 2050, 35, 379, "Input",
  InitializationCell->True],
Cell[14974, 370, 1779, 32, 347, "Input",
  InitializationCell->True],
Cell[16756, 404, 604, 11, 123, "Input",
  InitializationCell->True],
Cell[17363, 417, 730, 13, 235, "Input",
  InitializationCell->True],
Cell[18096, 432, 146, 3, 43, "Input",
  InitializationCell->True],
Cell[18245, 437, 4398, 81, 1039, "Input",
  InitializationCell->True],
Cell[22646, 520, 402, 8, 107, "Input",
  InitializationCell->True],
Cell[23051, 530, 626, 12, 196, "Input",
  InitializationCell->True],
Cell[23680, 544, 5166, 98, 1154, "Input"]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

