%           %experimenting with svn-multi

\svnkwsave{$RepoFile: siminos/froehlich/flow.tex $}
\svnidlong {$HeadURL$}
{$LastChangedDate$}
{$LastChangedRevision$} {$LastChangedBy$}
\svnid{$Id$}

    \ifarticle
    \else

\section{Dynamical systems}

We begin with a very brief discussion of dynamical systems.

A deterministic dynamical system is an abstract space $\pS$, called the state space, along with a rule for how trajectories in the space progress in time. We are concerned with applications to fluid flows, and as such we will only be concerned with systems where M is a manifold (locally it looks like $\mathbb{R}^d$) and the rule is given by a system of autonomous differential equations $\dot{\ssp}=\vel(\ssp)$.

\Eqva\ and \po s trajectories are ubiquitous in dynamical system. These types of trajectories are well understood and provide insight into how other trajectories progress through state space\rf{DasBuch}. Finding these types of trajectories is at the core of current research in turbulent systems. Many papers, such as\rf{KawKida01,kskent92,kstroy89}, are dedicated to finding and exploiting these trajectories to better understand turbulence.

\begin{definition}
\textbf{\Eqva.}
\label{def:eqva}
An \eqv\ $\EQV{}$ is a point $\ssp_{\EQV{}}$ for which the
velocity field of an ordinary differential equation
$\dot{\ssp} = \vel(\ssp)$ is zero,
\beq
\vel(\ssp_{\EQV{}})=0.
\eeq
The trajectory in the state space will remain in this point indefinitely.
\end{definition}


\begin{definition}
\textbf{\Po.}
\label{def:po}
A \po\ is a trajectory $\ssp(t)$ that is a closed curve,
\beq
\ssp(0)=\ssp(\period{}) \,\, for \,\, some \,\, time \,\, \period{}.
\eeq
The smallest $\period{}$ for which this occurs is known as the period.
\end{definition}


\subsection{Linear stability}

When studying the trajectories of a flow, it is useful to
know how small neighborhoods of points are transported by the
flow.

Consider the displacement of an infinitesimally close
neighbor $\ssp+\delta \ssp$. Taylor expanding the flow equation
$\dot \ssp = \vel(\ssp)$ we find that
\beq
\dot \ssp + \dot{\delta \ssp}
  =\vel_i(\ssp+\delta \ssp) \approx \vel_i(\ssp)+\Mvar \delta \ssp
\eeq
where we shall refer to the matrix of velocity gradients
\beq
\Mvar_{ij}(x)=\frac{\partial v_i (x)}{\partial x_j}
\ee{SF:stabMat}
as the \stabmat.
As explained in ChaosBook.org\rf{DasBuch}, a \stabmat\ describes the instantaneous rate of shearing of the infinitesimal neighborhood of $x(t)$ by the flow. That is, it describes how quickly points initially very near to $x(t)$ will diverge away from / converge to it in time. This is generally used in conjunction with \eqv\ to study how trajectories close to the \eqv\ progress in time.

\subsection{\CLe}
	
The \cLe\ were introduced by Gibbon and McGuinness\rf{GibMcCLE82}
as a low-dimensional model of baroclinic instability in the
atmosphere. In the complex form, they are given by
\beq
\begin{split}
 \dot{x} &=-\sigma x+ \sigma y \\
 \dot{y} &=(r-z)x-a y \\
 \dot{z} &= \frac{1}{2}(x y^*+x^*y)-b z\,
 \label{eq:CLe}
\end{split}
\eeq
where $x,y$, $r=r_1+ i\,r_2$, $a=1+i\,e$ are complex and $z$,
$b$, $\sigma$ are real. Rewritten in terms of real variables
$x=x_1+ i\, x_2\,,\ y=y_1+i\, y_2$, the \cLe\ are a 5-dimensional
first order ODE system\rf{SiminosThesis}
\beq
\begin{split}
	\dot{x}_1 &= -\sigma x_1 + \sigma y_1\\
	\dot{x}_2 &= -\sigma x_2 + \sigma y_2\\
	\dot{y}_1 &= (r_1-z) x_1 - r_2 x_2 -y_1-e y_2 \\
	\dot{y}_2 &= r_2 x_1 + (r_1-z) x_2 + e y_1- y_2\\
	\dot{z} &= -b z + x_1 y_1 + x_2 y_2\,.
	\label{eq:CLeR}
\end{split}
\eeq
In all numerical calculations that follow we shall set the
parameters to Siminos's values\rf{SiminosThesis},
\beq
r_1=28,\; b=\frac{8}{3},\;
\sigma=10,\; e=\frac{1}{10},\quad \mbox{and} \quad r_2=0
\,.
\ee{SiminosPrmts}
The \cLe\ exhibit an $\SOn{2}$ symmetry under rotations around the z-axis (see \refexam{exam:FinRot}).

The \cLe\ have a low enough dimension that it is possible to calculate a Hilbert basis for the symmetry. Siminos\rf{SiminosThesis} and ChaosBook\rf{DasBuch} use the Hilbert basis,
\beq
\begin{split}
    u_1 &= x_1^2+x_2^2 \,,\qquad
    u_2  = y_1^2+y_2^2 \cont
    u_3 &= x_1 y_2-x_2 y_1\,,\qquad
    u_4  = x_1 y_1+x_2 y_2\cont
    u_5 &= z\,.
    \label{eq:ipLaser}
\end{split}
\eeq

Here we are not interested in the physical applications of these equations; rather, we use them as a simple example of a dynamical system with continuous (but no discrete) symmetries. Our goal is to find a computationally straightforward method of reducing the dynamics to a lower-dimensional \statesp, where each group orbit of the full system (\ie, set of rotationally equivalent states) is represented by a single point. If successful, the methods that we develop might be applicable to very high-dimensional flows, such as translationally equivariant fluid flows bounded by pipes or planes\rf{GHCW07,GibsonMovies}.

\subsection{Visualizing \cLf}

\refFig{fig:CLEx2y1z} is an example of a long term trajectory on the strange attractor of the \cLe. The dynamics is a big mess - the trajectory seems to oscillate while drifting around $z$-axis. However,  note that the flow appears to have a rotational symmetry about the $z$-axis. The goal of this paper is to introduce a more illuminating way of understanding the dynamics of this flow as well as `cleaning it up'--that is, removing this symmetry and reducing the ODE system from five dimensions to four.
    \PC{label axes, use legible fonts in all figures.}
    \PC{to Stefan: put all single figures into SFIG format, as
        \reffig{fig:CLEx1x2z}. 
		}
                                                    \exerbox{exer:PlotCLf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\SFIG{CLEfullspace}
{}{
A typical $\{y_2,y_1,z\}$ plot of the \cLf\ strange attractor, with initial point $(x_1, x_2, y_1, y_2, z) = (1, 2, 3, 1, 2)$. Notice how the trajectory appears to rotate around the $z$-axis.
    }{fig:CLEx2y1z}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Linear stability}
\label{sect:stability}
%\PC{Write up here the general text on stability, following \refref{DasBuch},
%\\
%\wwwcb{/chapters/stability.pdf}
%    }

When studying the trajectories of a flow, it is useful to
know how small neighborhoods of points are transported by the
flow.
We start by a discussion of the stability of \eqva\ and \po s,
and postpone the discussion of the stability of \reqva\ and \rpo s,
quintessentially continuous symmetry effects, to \refsect{SF:rpos}.

Consider the displacement of an infinitesimally close
neighbor $x+\delta x$. Taylor expanding the flow equation
$\dot x = \vel(x)$ we find that
\beq
\dot x + \dot{\delta x}=v_i(x+\delta x) \approx v_i(x)+\Mvar \delta x
\eeq
where we shall refer to the matrix of velocity gradients
\beq
\Mvar_{ij}(x)=\frac{\partial v_i (x)}{\partial x_j}
\ee{SF:stabMat}
as the \stabmat.
In our first attempt to understand the dynamics of the flow,
we examine the \eqv\ of the system by finding this \stabmat\
$\Mvar$. For the \cLe\ it is the $[5\!\times\!5]$
matrix of velocity gradients,
                                                    \exerbox{exer:StabmatCLf}
\beq
  \Mvar =\left(\barr{ccccc}
    -\sigma    	& 0 		& \sigma & 0    &  0 \\
	0 	& -\sigma       & 0      & \sigma   &  0 \\
	r_1-z  &     -r_2      & -1     & -e & -x_1 \\
	r_2     & r_1-z       	& e  	& -1       & -x_2 \\
	y_1     & y_2           & x_1    & x_2      & -b
    \earr\right)
\,.
\eeq
A \stabmat\ describes the instantaneous rate of shearing of the infinitesimal neighborhood of $x(t)$ by the flow. That is, it describes how quickly points initially very near to $x(t)$ will diverge away from / converge to it in time.

\subsection{\jacobianM}

Consider the trajectory of a  neighbor infinitesimally close
to $\xInit$. Taylor expanding a finite time flow, we find that
\[
f^t(\xInit +\delta x) \approx f^t(\xInit)+\jMps^t(\xInit)\delta x,
\]
where
\beq
\jMps^t(x)_{ij}=\frac{\partial x_i(t)}{\partial x_j}
\ee{SF:jacMat}
 is
the \jacobianM. This means that up to the linear term the
neighborhood is transported by $\delta x(t)=\jMps^t(\xInit)\delta
\xInit$. This means that how nearby trajectories separate or
approach each other is dependent on the eigenvectors and
values of the \jacobianM.

The \jacobianM\ also maps the initial, Lagrangian coordinate
frame to the Eulerian coordinate at time $t$,
\beq
\velField{\ssp(t)}=\jMps^t(\xInit) \velField{\xInit}
\,,
\ee{JacobVeloc}
see \refexer{traLocEigFr}.
    \PC{remember to move \refexer{traLocEigFr}
    and its solution into ChaosBook. Currently it
    appears too early, search for ``traLocEigFr.''
    }

The methods of calculating the \jacobianM\ are discussed in ChaosBook.org\rf{DasBuch} where it is shown that the \jacobianM\ matrix is related to the stability matrix by $\frac{d}{dt} \jMps^t(x)=\Mvar (x) \jMps^t(x)$ or equivalently $\jMps^t(\xInit)= \texttt{T} e^{\int^t_0 d\tau \Mvar (x(\tau))}$, where \texttt{T} stands for a time-ordered product. When using a numerical routine to integrate the equations of motion, using a discrete approximation of either of these two formulas requires minimal additional programming effort.

% PC 13jul2010
\exercise{Transport of local eigenframes.}{     \label{traLocEigFr}
%    \toCB
\noindent (a)
Derive \refeq{JacobVeloc}.
(b)
More generally, consider the
eigen\-vectors $\jEigvec[j]$ of $\jMps^t(\ssp)$
(sometimes referred to as `covariant Lyapunov vectors,'
or, for \po s, as `Floquet vectors')
\index{covariant Lyapunov vector}
\index{Lyapunov!covariant vector}
\beq
\jMps^t(\ssp)\, \jEigvec[j](\ssp(t))
   = \ExpaEig_{j}(t) \,\jEigvec[j] (\ssp(t))
\,,
\ee{finTimeEigs}
and show that a time $t'$ later they are transported into
eigenvectors $\jEigvec[j](\ssp(t+t'))$ of
$\jMps^{t+t'}(\ssp)$.
\authorPC{2010-07-12}
    }% end \exercise{Transport of local eigenframes.


\solution{traLocEigFr}{Transport of local eigenframes.}{
\noindent (a)
Consider two points that are an infinitesimal time apart along a trajectory:
$\delta \xInit
  = \flow{\timeStep}{\xInit}-\xInit \approx \velField{\xInit}\timeStep$.
As $\flow{t+\timeStep}{\xInit} =
\map^t \circ \flow{\timeStep}{\xInit}=\map^{\timeStep} \circ \flow{t}{\xInit}$,
we have
$\flow{\timeStep}{\map^t(\xInit)}=\flow{\timeStep}{\ssp(t)}
\approx x(t) + \velField{\ssp(t)} \timeStep$ and
$\flow{t}{\flow{\timeStep}{\xInit}}
=\flow{t}{\xInit+\velField{\xInit} \timeStep}
\approx \flow{t}{\xInit} + \jMps^t(\xInit) \velField{\xInit} \timeStep$.
Putting these two equations together we get the desired
\refeq{JacobVeloc}.

\noindent (b)
Predrag: I am not sure that this statement is correct, please
prove or disprove. Basically, check that \refeq{SF:transpEigPO}
is true for any orbit, not only \po s.

A tangent subspace $T\pS^{(i)}$ of the \statesp\ is said to be {\em covariant} if
\beq
T\pS^{(i)}(\ssp(t)) = \jMps^t(\xInit) T\pS^{(i)}(\xInit)
\ee{SF:covSubsp}
This definition also applies to covariant vectors, if $T\pS(i)$ is one-dimensional.
Covariant subspaces
are co-moving with the tangent flow.
\authorSF{2010-07-??}
    }% end

\subsection{\Eqva}

An \eqv\ $\EQV{}$ is a point $\ssp_{\EQV{}}$ for which the
velocity field of an ordinary differential equation
$\dot{\ssp} = \vel(\ssp)$ is zero, $\vel(\ssp_{\EQV{}})=0$. These
are points where the flow does not move, and if it reaches an
equilibrium, the flow remains there. For the \cLe\, the
origin $\EQV{0}=(0, 0, 0, 0, 0)$ is always an equilibrium
point, but there are two more families of equilibrium when
both $r_2 + e=0$ and $r_1>1$. If we could set on of these
{\em infinitely precisely} as the initial point of the flow,
instead of seeing the messiness of \reffig{fig:CLEx2y1z}, we
would stay at this single point for all times. In any
simulation, for unstable \reqv\ the (finite precision)
trajectory eventually leaves this point.
                                                    \exerbox{exer:EquiCLe}

% \subsection{Stability of \eqva}

At an equilibrium, the flow manages to stay at a single
point, but what if we start at points near the equilibrium? Will
they collapse into the equilibrium, or will they diverge away
from it? In order to answer this, we find and examine the
eigenvalues and eigenvectors of \Mvar\ evaluated at the
equilibrium $\EQV{0}$, the origin.
                                                    \exerbox{exer:EigenE0}
For the \cLe\, we find that the eigenvalues are
        \PC{ChaosBook convention is to order eigenvalues
        from most positive (unstable) to the most negative,
        that is why I renumbered them. Try to follow that
        everywhere. Replace complex eigenvectors by the real,
        imaginary parts, as that is what you actually use - I
        did this in \refeq{eigVecQ1}. I might have introduced
        errors in renumbering them, so trust your own
        computations, especially regarding the
        \reffig{fig:CLEE0} comments.
        }
\beq
\begin{split}
\lambda_{1,2} &=11.8277 \pm 0.062985 i\\
\lambda_{3,4} &=-22.8277 \pm 0.037015 i\\
\lambda_5 &=-2.66667\\
\end{split}
\eeq
with the associated eigenvectors
    \PC{\refeq{suspectEigVecs} is suspect:
    real, im parts seem interchanged in $e_1$?
	In any case, always rewrite such as pairs of real eigenvectors
	in terms of real,	imaginary parts}
\bea
e_{1} &=& e_2^* =(0.001321+0.4581 i, 0.4581-0.001321 i, i, 1, 0)
\label{suspectEigVecs}\\
e_3 &=& e_4^* = (0.002249-0.7795 i, -0.7795-0.002249 i, 2.8421+i, 1, 0)
\continue
e_5 &=& (0, 0, 0, 0, 1)
\,.
\nnu
\eea
By examining the eigensystem, we can get a sense of what
happens to points near the equilibrium $\EQV{0}$. The
numerical values of the real parts of the eigenvalues
determine how quickly the flow will converge onto or diverge
away from the equilibrium. For a positive real part the flow
will diverge, and for a negative real part it will converge.
Complex eigenvalues also indicate that the motion will be
spiraling.

For the \cLe\ equilibrium $\EQV{0}$, the values of the
imaginary parts are orders of magnitude smaller than the real
parts, so that there will be very little spiraling. The large
values of the real parts tell us that the flow will
diverge/converge from the equilibrium very quickly.
                                                    \exerbox{exer:PlotEigenE0}


\subsection{\Po s}
\label{sect:SFpos}

We can extend this analysis of linear stability to work not only for \eqv\ points, but also allow us to study the dynamics of the system near periodic orbits.

Let $p$ be a prime cycle, $\ssp \in M_p$ be any point on the
cycle, $\period{p}$ the period of the cycle and
$\jMps_p\left(\ssp\right) = \jMps^{\period{p}}(\ssp)$ be
the {\jacobianM} for a single transversal of the cycle.
The {\jacobianM} for the $r$th repeat of the cycle is then
$\jMps^{r
\period{p}}\left(\ssp\right)=\jMps^{\period{p}}\left(f^{\left(r-1\right)
\period{p}}\left(\ssp\right)\right) \cdots
\jMps^{\period{p}}\left(f^{\period{p}}\left(\ssp\right)\right)\jMps^{\period{p}}\left(\ssp\right)
=\jMps_p\left(\ssp\right)^r$.
This means that it suffices to only look at prime cycles when
considering the {\jacobianMs} of periodic orbits.

Next consider the {\jacobianM} of a prime cycle $p$,
$\delta \ssp \left(t+\period{p}\right)
=\jMps_p\left(\ssp\right)\delta \ssp\left(t\right)$.
After traveling once around the cycle, it contracts along
the directions of the Floquet eigenvectors with Floquet
multipliers of magnitude less than 1 and expand in the
directions of Floquet eigenvectors with Floquet multipliers of
magnitude greater than 1.

The value of $\jMps_p\left(\ssp\right)$ depends on the point
on the periodic orbit chosen, but, as we shall show, the
Floquet multipliers are independent of this selection. To see
this, let $\ssp$ be any point on the cycle and
$\jEigvec[j]\left(\ssp\right)$ be a Floquet vector of
$\jMps_p\left(\ssp\right)$ with Floquet multiplier
$\ExpaEig_j$. Consider another
point  $\ssp'=f^t\left(\ssp\right)$, $ 0 < t < \period{p} $
on the periodic orbit. $\jMps^{\period{p} +t}=\jMps^{t+\period{p}}$,
{\jacobianMs} are multiplicative along the flow:
\bea
\jMps^{\period{p}+t}\left(\ssp\right)
&=&\jMps^{\period{p}}\left(f^t\left(\ssp\right)\right)\jMps^t\left(\ssp\right)
=\jMps_p\left(\ssp'\right)\jMps^t\left(\ssp\right)
\continue
\jMps^{t+\period{p}}\left(\ssp\right)
&=&\jMps^t\left(f^{\period{p}}\left(\ssp\right)\right)\jMps^{\period{p}}\left(\ssp\right)
=\jMps^t\left(\ssp\right)\jMps_p\left(\ssp\right)
\,,
\nnu
\eea
and
\bea
\jMps_p\left(\ssp'\right)\jMps^t\left(\ssp\right)\jEigvec[j]\left(\ssp\right)
&=&\jMps^t\left(\ssp\right)\jMps_p\left(\ssp\right)\jEigvec[j]\left(\ssp\right)
    \continue
&=&\jMps^t\left(\ssp\right)\left(\ExpaEig_j \jEigvec[j]\left(\ssp\right)\right)
=\ExpaEig_j \left(\jMps^t(\ssp) \jEigvec[j](\ssp)\right)
\continue
\jMps_p\left(\ssp'\right) \jEigvec[j]\left(\ssp'\right)
&=& \ExpaEig_j
\jEigvec[j]\left(\ssp'\right)
\,,
\label{SF:transpEigPO}
\eea
where
$\jEigvec[j]\left(\ssp'\right)
 = \jMps^t\left(\ssp\right)\jEigvec[j]\left(\ssp\right)$
 is the $\jMps_p$ eigenframe transported for time $t$
 along the $p$ orbit.
So $\ExpaEig_j$ is a Floquet multiplier for
$\jMps_p\left(\ssp'\right)$ too.

    \fi %end of article switch

