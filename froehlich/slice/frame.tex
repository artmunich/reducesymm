% file siminos/froehlich/slice/frame.tex
% $Author$ $Date$

% \section{\Mframes}
%       \label{sec:frame}

Suppose you are observing turbulence in a pipe flow, or your
defibrillator has a mesh of sensors measuring electrical currents that
cross your heart, or you have a precomputed pattern, and are sifting
through the data set of observed patterns for something like it. Here you see a
pattern, and there you see a pattern that seems much like the first one.
How ``much like the first one?''
Think of the first pattern (represented
by a point {\slicep} in the \statesp\  \pS) as a
`template'\rf{rowley_reconstruction_2000,rowley_reduction_2003} or a
`reference state' and use the symmetries of the flow to slide and rotate
the `template' until it overlays the second pattern
(a point $\ssp$ in the \statesp), \ie, act with elements of
the symmetry group \Group\ on the template ${\slicep} \to
{\LieEl}{\slicep}$ until the distance between the two patterns
\beq
|\ssp - {\LieEl}{\slicep}|
    = |\sspRed - \slicep|
    \label{minDistance0}
\eeq
is minimized. Here $\sspRed$ is the point on the group orbit
of $\ssp$ (the set of all
points that $\ssp$ is mapped to under the groups actions),
\beq
\ssp=\LieEl \sspRed
	\qquad
\LieEl \in \Group
\,,
\ee{sspOrbit}
closest to the template {\slicep}, where we shall measure distance
$|\ssp|^2=\braket{\ssp}{\ssp}$ in terms of the Euclidean inner product
\( %beq
\braket{x}{y} = \sum_i^d {x}_i y_i
%    \,,\; %\qquad
% x, y \in \pS \subset \reals^d
	\,.
\) %\ee{innerR}
If the \statesp\ is a normed function space,
\( %\beq
\braket{g}{f} = \int dx \, \dual{g}(x) f(x)
\,,
\) %\ee{innerL2}
we shall measure distance using the $L^2$ norm $|f|^2 = \braket{f}{f}$.
In practice, we always represent such functions by discrete
meshes or truncated basis sets, with a (possibly large)
finite-dimensional \statesp\  $\pS \subset \reals^d$.

If we parameterize a Lie group element $\LieEl=\LieEl(\gSpace)$ by
parameters $\gSpace = (\gSpace_1,\gSpace_2,\cdots\gSpace_N)$, the minimal
distance satisfies the extremum conditions
\beq
\frac{\partial ~~}{\partial \gSpace_a} |\ssp - \LieEl\slicep|^2
   =
\braket{\sspRed - \slicep}{\sliceTan{a}}
    \,,\qquad
	  \sliceTan{a} = \Lg_a \slicep
   = 0
\,.
\label{PCsectQ}
\eeq
To be explicit, consider an element of a compact Lie group that is continuously
connected to the identity expressed as
\beq
\LieEl(\gSpace)=e^{{\gSpace} \cdot \Lg }
    \,,\qquad
\gSpace \cdot \Lg = \sum_{a=1}^N \gSpace_a \Lg_a
\,.
\ee{FiniteRot}
The group action parameters $\gSpace_a$ are often referred to as
``phases,'' or ``shifts.''
As \Group\ is a symmetry of the system, the
length $|\ssp|$ is invariant under symmetry operations, $\Group \subset \On{d}$,
and consequently the Lie algebra {generators} $\Lg_a$ are a set of $N$ linearly
independent $[d\!\times\!d]$ antisymmetric matrices acting linearly on
the {\statesp} vectors $\ssp \in \pS \subset \reals^d$. An infinitesimal
% , $|\delta \gSpace| \ll 1$,
group action is generated by
$
\LieEl(\delta \gSpace) \simeq 1 + \delta \gSpace \cdot \Lg
\,.
$ %\ee{eq:infinitesimal}
A corresponding transformation induced by infinitesimal
time-dependent variations of group `phases'
$\delta \gSpace_a = \timeStep \, \dot{\gSpace_a}$ is
\beq
\dot{\ssp} = \dot{\gSpace} \cdot \groupTan(\ssp)
\,,
\ee{PC:groupTan1}
where the tangent vectors
\beq
 \groupTan_{a}(\ssp) = \Lg _{a} \ssp
    \,,\qquad
 a=1,2,\cdots,N,
\ee{PC:groupTan}
span the group tangent space at $\ssp$.
So $\dot{\gSpace} \cdot \groupTan(\ssp)$ is the velocity
of the flow along the group orbit of \ssp.
We use $\groupTan_a(\ssp)$ notation (rather than
$\Lg_{a}\ssp$) to emphasize that the group action
induces a \emph{tangent field} at $\ssp$.


{\bf Slice:}
The minimum distance condition \refeq{minDistance0} together with
Euclidean norm says that the
closest point $\sspRed$ in the group orbit of \statesp\ point $\ssp$ lies in a
$(d\!-\!N)$-dimensional hyperplane defined by \refeq{PCsectQ},
a hyperplane through the template point $\slicep$,
normal to the group action tangent
space $\sliceTan{}$.
This hyperplane is called a `slice' and is an example of
symmetry reduction by transverse sections of
group orbits\rf{FelsOlver98,FelsOlver99,OlverInv} that
can be traced back to Cartan's \mframes\rf{CartanMF}.

As a generic group orbit is a smooth
curved $N$\dmn\ manifold embedded in
the $d$\dmn\ \statesp, several values of $\gSpace$ might be local extrema of the
distance function \refeq{PCsectQ}. For example, group orbits of \SOn{2}\
are topologically circles, and the distance function \refeq{minDistance0}
has maxima, minima and inflection points as extrema.
  %
The physically most interesting minimum is
presumably the closest one or the infimum, the absolute minimum of \refeq{minDistance0}.
It does not matter whether the group is compact, for example $\SOn{n}$, or
noncompact, for example the Euclidean group $E_2$ that underlies the generation
of spiral patterns\rf{Barkley94}; in either case any group orbit has
one or several locally closest passages to the template state.
  %
We only care about
those that are local (and preferably global) {\em minima}, for which all the eigenvalues of the
symmetric matrix $[N\!\times\!N]$ matrix of second derivatives of
distance,
\beq
\frac{\partial^2}
     {\partial \gSpace_a \partial \gSpace_b}
        |\sspRed - \slicep|^2
    =
%  - \braket{\Lg_a e^{\gSpace \cdot \Lg} \ssp}{\sliceTan{b}}=
  - \braket{\groupTan_a(\sspRed)}{\sliceTan{b}}=
  \braket{\sspRed}{\Lg_a \Lg_b\slicep}
\ee{PCinflPoint}
are positive.

$\Lg_a \Lg_b$ plays a fundamental role in the theory of Lie groups.
Any representation of a compact group $\Group$ is fully
reducible, and for a Lie group
the invariant tensors constructed by contractions
of $\Lg_a$ are useful in identifying irreducible
representations. The simplest such invariant is
\beq
{\Lg} \cdot \Lg = - \sum_\alpha C_2^{(\alpha)} \, \id^{(\alpha)}
\,,
\ee{QuadCasimir}
where $C_2^{(\alpha)}$ is the quadratic Casimir for
irreducible representation labeled $\alpha$, and
$\id^{(\alpha)}$ is the identity on the $\alpha$-irreducible
subspace, 0 elsewhere. $ C_2^{(\alpha)} =0$ if $\alpha$
is an invariant subspace.
The dot product of two tangent fields in
\refeq{PCinflPoint} is thus a sum of inner products
weighted by Casimirs,
\beq
\braket{\groupTan(\sspRed)}{\groupTan(\slicep)}
   = \sum_\alpha C_2^{(\alpha)} {\sspRed}_i\, \delta_{ij}^{(\alpha)} \slicep_j
\,.
\ee{braket}
An example is the Fourier series \refeq{tangL2norm}.
For compact groups $C_2^{(\alpha)}$ are strictly nonnegative by
the antihermiticity \refeq{antiHerm} of Lie algebra generators.


By the antisymmetry of the Lie algebra generators of
$\On{n}$ and its subgroups, \refeq{antiHerm},  we have
$\braket{\slicep}{\sliceTan{a}}
 = \braket{\slicep}{\Lg_{a}\slicep}=0$, and the transformation parameters
$\gSpace$ for which the state $\ssp$ is closest to the template
$\slicep$ are fixed by $N$ slice conditions \refeq{PCsectQ},
\beq
\braket{\sspRed}{\sliceTan{a}} =0
    \,,\qquad
\sspRed = \LieEl(\gSpace) \ssp
\,.
\ee{PCsectQ0}

A given compact group orbit intersects a slice at least twice, and
possibly many times, so we need a prescription for how to
pick a unique \reducedsp\ point as the representative of the entire group
orbit.


The good news is that for a generic template (slice-fixing point)
$\slicep$ (\ie, any $\slicep$ whose group orbit has the $N$-dimensions
of the group \Group), the
slice hyperplane \refeq{PCsectQ} cuts across the group orbit of {\em
every} point in the full \statesp\ \pS.

But is this a useful reduction of the \statesp? A distant pattern
that is a bad match to a given template will have any number of
`minimal' distances, each another bad match.


\section{Computing the moving frame rotation angle}
\label{exam:CLErotAngle}

To show how the rotation into the \slice\ is computed, consider first the
\cLe. There is only one infinitesimal generator for the \SOn{2} symmetry
group, so the \reducedsp\ trajectory is given by $\sspRed=\LieEl(\gSpace)
\ssp$ where $\gSpace$ is such that $\braket{\sspRed}{\sliceTan{}}=0$.
Substituting the \SOn{2}\ Lie algebra generator \refeq{CLfLieGen} and  a
finite angle \SOn{2} rotation \refeq{CLfRots} acting on a
5-dim\-ens\-ion\-al space \refeq{eq:CLeR} into the slice condition
\refeq{PCsectQ1} yields the explicit formula for $\gSpace$:
\bea
0 &=&
    \braket{\ssp}{\sliceTan{}}\cos\gSpace
    +\braket{\groupTan_{}(\ssp)}{\sliceTan{}} \sin\gSpace
\continue
\tan\gSpace
  &=&
   - \, \frac{\braket{\ssp}{\sliceTan{}}}
          {\braket{\groupTan_{}(\ssp)}{\sliceTan{}}}
\,.
\label{SL:CLEsliceRot}
\eea
For \CLe\ this yields
\[
\tan\gSpace =
- \, \frac{x_1 x_2'-x_2 x_1'+y_1 y_2' -y_2 y_1'}
       {x_1 x'_1+x_2 x'_2+y_1 y'_1+y_2 y'_2}
\,.
\]
%    \PC{Stefan, I think you have to explain that, just as in the
%    case of Poincar\'e sections, one keeps track of only oriented
%    crossings, \ie, a circle has only on section in a \slice,
%    not two. That should give you a precise $\pi$ rotation rule
%    for singularity crossing.}
% PC 2010-12-16 - just pick the infimum.
Note that if \gSpace\ is a solution, so is $\gSpace+\pi$. If either of the inner products in \refeq{SL:CLEsliceRot} is nonzero then there are exactly two $\gSpace$.
This formula is particularly simple, as in this example the group
acts only through $m=0$ and $m=1$ representations; in general
the `phases' $\gSpace_a$ have to be computed numerically.

\noindent
{\bf $\SOn{2}$ singularities.}
\label{ex:so2singularities}
Consider next the general form \refeq{SO2irrepAlg-m} of action
of an $\SOn{2}$ symmetry on arbitrary Fourier coefficients of a smooth
function.
Substituting this into the slice condition \refeq{minDistance0} we find that
    \PC{prettify this formula}
\bea
\braket{e^{\gSpace \Lg}\ssp}{\groupTan(\slicep)}
=\braket{\ssp}{(\sum\limits_m (\cos(-m\gSpace) \id^{(m)}
     +\sin(-m\gSpace) \frac{1}{m}\Lg^{(m)})) \sliceTan{}}
\continue
=\sum\limits_m(\cos(m\gSpace) \braket{\ssp}{\Lg^{(m)} \slicep}-\sin(m\gSpace) \braket{\ssp}{\id^{(m)} \slicep}).
\label{eq:so2sing}
\eea
As both $\cos(m\gSpace)$ and $\sin(m\gSpace)$ are expressible as
polynomials of degree m in $\sin(\gSpace)$ and $\cos(\gSpace)$, so
\refeq{eq:so2sing} is expressible of a polynomial whose coefficients are
determined by $\braket{\ssp}{\Lg^{(m)} \slicep}$ and
$\braket{\ssp}{\id^{(m)}}$.
The phase $\gSpace$ corresponds to a root of this polynomial. The
coefficients of the polynomial vary smoothly with $\ssp$, so its roots
vary smoothly too. This means \refeq{eq:neglig} is satisfied for these
$\SOn{2}$ symmetries and we can use the result of \refeq{SF:snglrAngl}.



\ifboyscout
\subsection{\Poincare\ sections from the closest recurrences}
    {\color{red} {\bf PC to Stefan}:
An epiphany; what we do for slice, works for linear \Poincare\ sections
as well (still to be written down, but obvious once it has been said).
   }
\else
\fi

\subsubsection{}



%
% ****** End of file frame.tex ******
