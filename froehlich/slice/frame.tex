% file siminos/froehlich/slice/frame.tex
% $Author$ $Date$

% \section{\Mframes}
%       \label{sec:frame}

Suppose you are observing turbulence in a pipe flow, or your
defibrillator has a mesh of sensors measuring electrical currents that
cross your heart, or you have a precomputed pattern, and are sifting
through the data set of observed patterns for something like it. Here you
see a pattern, and there you see a pattern that seems much like the first
one. How `much like the first one?' Think of the first pattern
(represented by a point {\slicep} in the \statesp\  \pS) as a
`template'\rf{rowley_reconstruction_2000,rowley_reduction_2003} or a
`reference state' and use the symmetries of the flow to slide and rotate
the `{\template}' until it overlays the second pattern (a point $\ssp$ in
the \statesp), \ie, act with elements of the symmetry group \Group\ on
the {\template} ${\slicep} \to {\LieEl}{\slicep}$ until the distance between
the two patterns
\beq
|\ssp - {\LieEl}{\slicep}|
    = |\sspRed - \slicep|
\label{minDistance0}
\eeq
is minimized. Here $\sspRed$ is the point on the group orbit of $\ssp$
(the set of all points that $\ssp$ is mapped to under the groups
actions),
\beq
\ssp=\LieEl \sspRed
	\,,\qquad
\LieEl \in \Group
\,,
\ee{sspOrbit}
closest to the {\template} {\slicep}.
This distance needs to be an invariant of the symmetry group: here
we shall assume \Group\ is a subgroup of the group of Euclidean
transformations, and measure distance
$|\ssp|^2=\braket{\ssp}{\ssp}$ in terms of the Euclidean inner product
\( %beq
\braket{x}{y} = \sum_i^d {x}_i y_i
%    \,,\; %\qquad
% x, y \in \pS \subset \reals^d
	\,,
\) %\ee{innerR}
or, if the \statesp\ is a normed function space,
\( %\beq
\braket{g}{f} = \int dx \, {g}(x) f(x)
\,,
\) %\ee{innerL2}
in terms of the $L^2$ norm $|f|^2 = \braket{f}{f}$. In practice, we
represent such spatially extended functions by discrete meshes or finite
basis sets, within a (possibly large) finite-dimensional \statesp\  $\pS
\subset \reals^d$. An example is a representation of a dissipative PDE by
truncating the Fourier basis \refeq{FourierExp} to a finite number of
modes.

As \Group\ is a symmetry of the system and the length $|\ssp|$ is
invariant under symmetry operations, $\Group$ is a subgroup of
the group of orthogonal transformations $\On{d}$, and its Lie algebra
{generators} $\Lg_a$ (see \refeq{FiniteRot}) are a set of $N$ linearly independent
$[d\!\times\!d]$ antisymmetric matrices acting linearly on the {\statesp}
vectors $\ssp \in \pS \subset \reals^d$.
If we parameterize a Lie group element $\LieEl=\LieEl(\gSpace)$ by
parameters $\gSpace = (\gSpace_1,\gSpace_2,\cdots\gSpace_N)$, the minimal
distance satisfies the extremum conditions
\beq
\frac{\partial ~~}{\partial \gSpace_a} |\ssp - \LieEl\slicep|^2
   =
\braket{\sspRed - \slicep}{\sliceTan{a}}
   = 0
    \,,\qquad
	  \sliceTan{a} = \Lg_a \slicep
\,.
\label{PCsectQ}
\eeq
Thus the minimum distance condition, combined with the Euclidean norm, says
that the point $\sspRed$ in the group orbit of \statesp\ point $\ssp$
closest to the {\template} $\slicep$ lies in a hyperplane
through the point $\slicep$, normal to the group action tangent space
$\sliceTan{}$.

By the antisymmetry of the Lie algebra generators we have
$\braket{\slicep}{\sliceTan{a}} = \braket{\slicep}{\Lg_{a}\slicep}=0$, so
we can replace $\sspRed - \slicep \to \slicep$ in \refeq{PCsectQ}, and
the transformation parameters $\gSpace$ which map the state $\ssp$ to
$\sspRed$, the group orbit point
closest to the {\template} $\slicep$, are determined solely by being
normal to the $N$ group tangent vectors $\sliceTan{a}$,
\beq
\braket{\sspRed}{\sliceTan{a}} =0
    \,,\qquad
\sspRed = \LieEl(\gSpace) \ssp
\,.
\ee{PCsectQ0}
The group orbit points closest to the {\template} thus lie in a $(d\!-\!N)$\dmn\ hyperplane $\pSRed = \pS/Group$, the set of vectors $\sspRed \in  \pSRed$ orthogonal to the group tangent space spanned by tangent vectors
$\{\sliceTan{1},\cdots,\sliceTan{N}\}$
\beq
\sspRed_1\sliceTan{a,1} + \sspRed_2\sliceTan{a,2}
  + \cdots + \sspRed_d\sliceTan{a,d} = 0
\,.
\ee{hyperpl}
In what follows we shall refer to this hyperplane as a
\emph{slice,} and to  \refeq{PCsectQ0} as the \emph{slice conditions}.
Slice so defined is a particular case of symmetry reduction
by transverse sections of group
orbits\rf{FelsOlver98,FelsOlver99,OlverInv} that can be traced back to
Cartan's \mframes\rf{CartanMF}. `Moving frame' refers to the action 
$\LieEl(\gSpace)$ that 
brings a \statesp\ point \ssp\ into the slice.

In the choice of $\slicep$ one should avoid solutions that belong to the
invariant or partially symmetric subspaces; for such choices some or all
$\sliceTan{a}$ vanish identically and impose no slice conditions. The {\template}
$\slicep$ should be a generic \statesp\ point in the sense that its group
orbit has the full $N$ dimensions of the group \Group.
	\PC{comment that this is regrettable, and the reason why
	Sandstede and Fields(?) have to stand on their
	heads while bifurcating
	}

\subsection{Computing the moving frame rotation angle}
\label{exam:CLErotAngle}

Time-evolution and symmetry group actions foliate the \statesp\ into
$(N\!+\!1)$\dmn\ submanifolds: Given a state (a \statesp\ point $\ssp(0)$
at time $\tau=0$), we can trace its  1\dmn\ trajectory $\ssp(\tau)$ by
integrating its equations of motion, and its $N$\dmn\ group orbit by
acting on it with the symmetry group \Group. Locally, a continuous time
flow can be reduced to the set of neighboring points $\ssp(0)$ by a
\PoincSec; a slice does the same for local neighborhoods of group orbits.
By symmetry, two points are equivalent if they are in the same group
orbit. {\em Symmetry reduction} by the \mframes\ is a precise rule for
how to pick a unique point \sspRed\ for each such equivalence class, and
compute the transformation $\sspRed =\LieEl \ssp$ that relates the full
\statesp\ point  $\ssp \in \pS$, to its symmetry reduced representative
$\sspRed \in \pSRed$.

To show how the rotation into the \slice\ is computed, consider first the
\cLe. The \reducedsp\ point $\sspRed$ is given by
$\sspRed=\LieEl(\gSpace) \ssp$ where $\gSpace$ is such that
$\braket{\sspRed}{\sliceTan{}}=0$. Substituting the \SOn{2}\ Lie algebra
generator and a finite angle \SOn{2} rotation \refeq{CLfRots} acting on a
5\dmn\ space \refeq{eq:CLeR} into the slice condition \refeq{PCsectQ0}
yields the explicit formula for $\gSpace$:
\bea
0 &=&
    \braket{\ssp}{\sliceTan{}}\cos\gSpace
    +\braket{\groupTan_{}(\ssp)}{\sliceTan{}} \sin\gSpace
	\continue %\label{SL:CLEsliceRot0}\\
\tan\gSpace &=&
   - \, {\braket{\ssp}{\sliceTan{}}}/
          {\braket{\groupTan_{}(\ssp)}{\sliceTan{}}}
\,.
\label{SL:CLEsliceRot}
\eea
The dot product of two tangent fields in \refeq{SL:CLEsliceRot} is a
sum of inner products weighted by Casimirs \refeq{QuadCasimir},
\beq
\braket{\groupTan(\sspRed)}{\groupTan(\slicep)}
   = \sum_m C_2^{(m)} {\sspRed}_i\, \delta_{ij}^{(m)} \slicep_j
\,.
\ee{braket}
For \cLe\
$\ssp = (x_1,x_2,y_1,y_2,z)$,
$\sspRed = (x_1',x_2',y_1',y_2',z)$,
and the moving frame condition \refeq{SL:CLEsliceRot} yields
\[
\tan\gSpace =
- \, \frac{x_1 x_2'-x_2 x_1'+y_1 y_2' -y_2 y_1'}
       {x_1 x'_1+x_2 x'_2+y_1 y'_1+y_2 y'_2}
\,.
\]
Note that if \gSpace\ is a solution, so is $\gSpace+\pi$.
This formula is particularly simple, as in the \cLe\
example the group acts only through $m=0$ and $m=1$ representations
(in the Fourier mode labeling of \refeq{SO2irrepAlg-Lg}).

Consider next the general form \refeq{SO2irrepAlg-m} of action of an
$\SOn{2}$ symmetry on arbitrary Fourier coefficients of a spatially
periodic function \refeq{FourierExp}. Substituting this into the slice
condition \refeq{PCsectQ0} and using \refeq{SO2irrepAlg-m} we find that
    \PC{RECHECK! and prettify this formula}
\bea
\braket{e^{\gSpace \Lg}\ssp}{\groupTan(\slicep)}
=\braket{\ssp}{\sum\limits_m \left(\cos(-m\gSpace) \id^{(m)}
     +\sin(-m\gSpace) \frac{1}{m}\Lg^{(m)}\right) \sliceTan{}}
\continue
=\sum\limits_m
   \left(
    \braket{\ssp}{\Lg^{(m)} \slicep} \cos(m\gSpace)
  - \braket{\ssp}{\id^{(m)} \slicep} \sin(m\gSpace)
   \right)
   =0
\,.
\label{eq:so2sing}
\eea
Rewriting $\cos(m\gSpace)$, $\sin(m\gSpace)$ as
polynomials of degree $m$ in $\sin(\gSpace)$ and $\cos(\gSpace)$, we can recast
\refeq{eq:so2sing} as a polynomial equation, with coefficients
determined by $\braket{\ssp}{\Lg^{(m)} \slicep}$ and
$\braket{\ssp}{\id^{(m)}\slicep}$. The `phase' $\gSpace$ that rotates
$\ssp$ into any group-orbit traversal of the slice corresponds to a root of
this polynomial. In general these phases have to be computed
numerically.

As a generic group orbit is a smooth curved $N$\dmn\ manifold embedded in
the $d$\dmn\ \statesp, several values of $\gSpace$ might be local extrema
of the distance function \refeq{PCsectQ}. For example, group orbits of
\SOn{2}\ are topologically circles, and the distance function
\refeq{minDistance0} has maxima, minima and inflection points as extrema.
Our prescription is to pick the closest \reducedsp\ point as the unique
representative of the entire group orbit. \ie, the absolute minimum or
the \emph{infimum} of \refeq{minDistance0}. It does not matter whether
the group is compact, for example $\SOn{n}$, or noncompact, for example
the Euclidean group $E_2$ that underlies the generation of spiral
patterns\rf{Barkley94}; in either case any group orbit has one or several
locally closest passages to the {\template} state, and generically only
one that is the closest one.

So we do not have to compute all the roots of the polynomial
\refeq{eq:so2sing} - all we care about is the infimum, or the root that
corresponds to the shortest distance \refeq{minDistance0}.
While post-processing of a full \statesp\ trajectory $\ssp(\tau_j)$
requires a numerical (Newton method) determination of the
`moving frame' rotation
$\gSpace(\tau_j)$ at each time step $\tau_j$, the computation is not
as onerous as it might seem, as the knowledge of $\gSpace(\tau_j)$ and
$\groupTan(\sspRed(\tau_j))$
gives us a very good guess for $\gSpace(\tau_{j+1})$. As we now show, we
can go a step further, and write the equations for the flow restricted to
the \reducedsp\ \pSRed.

%
% ****** End of file frame.tex ******
