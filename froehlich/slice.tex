%           %experimenting with svn-multi

\svnkwsave{$RepoFile: siminos/froehlich/slice.tex $}
\svnidlong {$HeadURL$}
{$LastChangedDate$}
{$LastChangedRevision$} {$LastChangedBy$}
\svnid{$Id$}


\section{\Reducedsp}
\label{sect:reducedStateSp}

\begin{bartlett}
I made a wrong mistake.
\bauthor{Yogi Berra}
\end{bartlett}

\noindent
Now that we know what a symmetry of a dynamical system is, how
(or why) can it actually be used?

Suppose you are staring at turbulence in a pipe flow, or your defibrillator has a mesh of sensors measuring electrical currents that cross your heart. Here you see a pattern, and there you see a pattern that seems much like the first one. Think of the first pattern as a `template'\rf{rowley_reconstruction_2000} (a point {\slicep} in the \statesp) and use the symmetries of the flow to slide and rotate the second pattern (act with the group element ${\LieEl}$ on the point $\ssp \to {\LieEl}\ssp$) until the distance between the two patterns
\beq
|\LieEl\ssp - \slicep|^2=\braket{\LieEl\ssp - \slicep}{\LieEl\ssp - \slicep}
\ee{minDistance}
is minimized. Instead of blindly sliding one pattern over the other until this distance is minimized,
we shall determine the group rotation `angles' by the extremum condition
	\PC{to select minima, need 2nd partials}
\beq
\frac{\partial ~~}{\partial \gSpace_a} |\LieEl(\gSpace_E)\ssp - \slicep|^2 =
-2 \braket{\LieEl(\gSpace_E)\ssp}{\slicep}
 = 0
\,.
\ee{minDistCond}
$\Lg_a$ is antihermitian, so
$0=\braket{\Lg_a e^{\gSpace_E \cdot \Lg}\ssp}{\slicep}
= - \braket{\LieEl_E \ssp}{\Lg_a  \slicep}$,
and
\[
\braket{\LieEl_E \ssp}{\sliceTan{a}} =0
\,.
\]


The basic idea behind symmetry reduction is to define an equivalence relation on the \statesp\ where two points are equivalent if they are in the same group orbit of the symmetry group. With any trajectory in the full \statesp\, $\ssp(\tau)$, we can associate with it a new `\reducedsp' trajectory, $\bar{\sspRed}(\tau)$, which is the equivalence class of the full trajectory at any time (\ie\ $\ssp(\tau) \in \bar{\sspRed}(\tau)$ for each $\tau$). Knowing only the \reducedsp\ trajectory, it is not possible to reconstruct the full space trajectory; additional information is needed to determine which point of the group orbit is in the original trajectory.

If a unique representative from an equivalence class is chosen, then every point in the equivalence class is expressible as a group element acting on this point. If a unique representative, denoted $\sspRed$, is chosen from each equivalence class, then to recover the full space trajectory all that is needed is $\LieEl(\tau)$, the group element needed to rotate the representative $\sspRed(\tau)$ of the equivalence class to $\ssp(\tau)$ (\ie\ $\ssp(\tau)=\LieEl(\tau) \sspRed(\tau)$).


\subsection{\Mslices}
\label{sect:mslices}


Here we describe symmetry reduction by the
{\em {\mslices}} of
Cartan\rf{CartanMF,FelsOlver98,FelsOlver99,OlverInv}.
                                                \exerbox{exer:SO2cSect}
                                                \exerbox{exer:mslicesInv}

The \mslices\ is when the \reducedsp\ representative of a group orbit equivalence class is chosen to be the point where the group orbit intersects a fixed hypersurface (the representatives are where the hypersurface `slices' the group orbits). We begin by describing how the method works near a point in the \statesp.

\begin{definition}
\textbf{\Slice.}
If $\Group$ acts `regularly' on a d-dimensional manifold $\pS$, \ie\ all its group orbits are $N$ dimensional, then we define a \emph{slice}\rf{CartanMF,FelsOlver98,FelsOlver99,OlverInv} through a point $\slicep$ to be a $(d\!-\!N)$ dimensional submanifold $\pSRed$ such that all group orbits in an open neighborhood of $\slicep$ intersect $\pSRed$ transversally and only once.
\end{definition}

If we are working in a subspace of $\mathbb{R}^d$, then the simplest hypersurface through $\slicep$ one can construct is a hyperplane. The restriction that the slice intersect the group orbits in an open neighborhood of $\slicep$ transversally guarantees locally that there is a unique representative of a group orbit in the \slice. The easiest way to have the hyperplane be transverse to the group orbits is to require the hyperplane be normal to the group action.
Being able to choose a hyperplane normal to the group action requires that the state space have an inner product. For the rest of this paper we will assume that the state space has an inner product denoted by $\braket{x}{y}$ (for $\mathbb{R}^d$ the inner product is the usual Euclidean product, \ie\ the dot product $\braket{x}{y}=\sum_{i=1}^d x_i y_i$).
This leads us to the definition of a linear slice.

\begin{definition}
\label{def:slice}
\index{slice}
\textbf{Linear \slice.}
Pick a non-zero \emph{slice-fixing point} $\slicep \in \pS$.
We call the $(d\!-\!N)$-dimensional hyperplane $\sspRed \in \pSRed$
a \emph{linear \slice}, where
\(
\braket{\sspRed - \slicep}{\sliceTan{a}}=0
\) %ee{PCsectQ1}
is normal to all group tangents $ \sliceTan{a}= \Lg_a \slicep$ at $\slicep$. The {slice-fixing point} should lie outside the invariant subspace $\pS_\Group$ or any of the invariant subspaces $\pS_H$ defined in \refeq{dscr:FPsubsp}. Were \slicep\ invariant under the group, then $\sliceTan{a}=0$ and the `\slice' so defined would be the entire space.
    \PC{Extend this claim to the invariant subspaces as well}
    \PC{In constructing his return map, Lorenz, I think,
    used projections on the invariant axes $z$ and $\dot{z}$.
    Is that not a \slice? Rethink}

As $ \braket{\slicep}{\sliceTan{a}}=\braket{\slicep}{\Lg_a \slicep} =0 $ by the antihermiticity of \Lg, the condition that a point \sspRed\ lies in the \slice\ \pSRed\ reduces to
\beq
\braket{\sspRed}{\sliceTan{a}}=0
    \,,\qquad
\sliceTan{a} = \Lg_a \slicep
\,.
\ee{PCsectQ1}
\end{definition}


While in general a {\slice} need not be a hyperplane,
we find the linear slice condition \refeq{PCsectQ1} easiest to implement.
For the linear case, the same slice is fixed by any
point on the ray $const\; \slicep$ through the point \slicep.

In this paper, whenever we use the term \slice\ it will refer to a hyperplane as in the above definition. The main focus of this paper is these linear slices.

As we shall show in \refsect{sect:slices}, a given group orbit intersects a slice at
least twice, and potentially arbitrarily many times, so we need a prescription for
how to pick a unique \reducedsp\ point as the representative of the entire group orbit.
We shall eliminate half of the slice crossings as we do for
\Poincare\ sections, by fixing the orientation of the crossing.
The choice of which of the remaining crossings is the representative
is more arbitrary.

\begin{definition}
\label{def:movingFrame}
\index{moving frame}
\textbf{Moving frame.}
For any $\ssp$, the slice condition \refeq{PCsectQ1} on $\sspRed =
\LieEl(\gSpace)\ssp$ determines the group
action $\LieEl(\gSpace)$ that brings $ \ssp$ into the \slice.
We begin to fix the unique \reducedsp\ by requiring that the crossing is
oriented:
\beq
\braket{\groupTan_{}(\ssp)}{\sliceTan{}} > 0.
\ee{SF:orientedSlice}
In general this will not be sufficient to select unique representative and additional constraints are required.
If there is a set of angles
$\{\gSpace_1\leq\gSpace_2\leq\cdots\leq\gSpace_k \}$ that
satisfy the oriented slice transversal conditions
\refeq{PCsectQ1}, \refeq{SF:orientedSlice}, we take the
smallest angle $\gSpace_1$.
    \PC{problem: this makes sense only for \SOn{2}}
Such a map from a point in the full \statesp\ to the group action
$\gSpace$ is called a
\emph{moving frame}\rf{FelsOlver98,FelsOlver99,OlverInv}.
\end{definition}

\example{\CLe\ rotation angle.}{\label{exam:CLErotAngle}
To show how the rotation into the \slice\ is computed, consider first the \cLe. There is only one infinitesimal generator for the \SOn{2} symmetry group, so the \reducedsp\ trajectory is given by $\sspRed=\LieEl(\gSpace) \ssp$ where $\gSpace$ is such that $\braket{\sspRed}{\sliceTan{}}=0$. Substituting the \SOn{2}\ Lie algebra generator \refeq{CLfLieGen} and  a finite angle \SOn{2} rotation \refeq{CLfRots} acting on a 5-dim\-ens\-ion\-al space \refeq{eq:CLeR} into the slice condition \refeq{PCsectQ1} yields the explicit formula for $\gSpace$:
\beq
    \braket{\ssp}{\sliceTan{}}\cos\gSpace+\braket{\groupTan_{}(\ssp)}{\sliceTan{}} \sin\gSpace=0
\ee{SL:CLEsliceRot}
\[
     \tan\gSpace= - \frac{\braket{\ssp}{\sliceTan{}}}
                      {\braket{\groupTan_{}(\ssp)}{\sliceTan{}}}
\]
\[
    (x_1 x_2'-x_2 x_1'+y_1 y_2' -y_2 y_1')\cos\gSpace
    + (x_1 x'_1+x_2 x'_2+y_1 y'_1+y_2 y'_2)\sin\gSpace
=0
\,.
\]
%    \PC{Stefan, I think you have to explain that, just as in the
%    case of Poincar\'e sections, one keeps track of only oriented
%    crossings, \ie, a circle has only on section in a \slice,
%    not two. That should give you a precise $\pi$ rotation rule
%    for singularity crossing.}
Note that if \gSpace\ is a solution, so is $\gSpace+\pi$. If either of the inner products in \refeq{SL:CLEsliceRot} is nonzero then there are exactly two $\gSpace$.
This formula is particularly simple, as in this example the group
acts only through $m=0$ and $m=1$ representations; in general
the `phases' $\gSpace_a$ have to be computed numerically.

    }%end \example{\CLe\ rotation angle

\SFIG{CLEreduced}
{}{
A typical $\{y_1,y_2,z\}$ plot of the reduced \cLf\ strange attractor
with initial point
$(x_1, x_2, y_1, y_2, z) = (1, 2, 3, 1, 2)$ in the slice normal to $\sliceTan{}=(1,0,0,0,0)$. Contrast this plot with \reffig{fig:CLEx2y1z},
and note the apparent discontinuities in the reduced flow.
    }{fig:CLErx2y1z}


	\ifarticle
	\else
	
\subsection{\Mslices, finite group actions}
\label{sect:MovFrame}

     \Private{
\noindent{\bf Predrag -
July 19, Aug 12 2009; Sep 19 2010}
    }

Split up the integration of an $\Group$-equivariant ODE into
a sequence of finite time steps, each followed by a group action
such that the next segment initial point is in the point
$\sspRed \in$ {\slice}, a $(d\!-\!1)$-dimensional hyperplane
normal to the group rotation tangent $\sliceTan{}$ at point
$\slicep$:
    \PC{repeat of \refeq{PCsectQ1}?}
    \PC{Stefan, rewrite the whole text in terms of
        $\braket{.}{.}$.}
\[ %beq
\braket{\sspRed - \slicep}{\sliceTan{a}}=0
    \,,\qquad
\sliceTan{a} = \Lg_a \slicep
\,.
\] %ee{PCsectQ}

[...]
                                                    \exerbox{exer:PCsectionCLe}
                                                    \exerbox{exer:SO2rotAngle}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% computed by PCunrot.nb
\SFIG{ProblemsPill} %PCunrot}
{}{
{\Mslices}, finite time steps version: a
trajectory started on the \slice, with $\ssp_1^{(0)}
=0$, evolves for a finite time to a \statesp\ point with a
non-zero $\hat{\ssp}_1^{(1)}$. The {\em entire} \statesp\ is then
rotated (the `frame is moved') so that the equivalent point
on the circle lies on the \slice, $\ssp_1^{(1)} =0$.
Thus after every finite time step followed by a rotation the
trajectory returns to the 4$\dmn$ $\ssp_1 =0$
\reducedsp.
}
{fig:PCunrot}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\refFig{fig:PCunrot} illustrates the {\mslices},
finite time version.
    \PC{Draw your own \refFig{fig:PCunrot}
        - need to draw a longer segment of the initial trajectory,
        to make it clearer that the whole segment is rotated.
       }

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\exercise{\SOn{2}  rotation angle:}{\label{exer:SO2rotAngle}
Continue the discussion of \refexam{exam:SO2irrepst} and write down the formula for $\gSpace$ for a Fourier expansion of a periodic function. Show that now the \slice\ condition is a polynomial in $\cos\gSpace$, $\sin\gSpace$, and that, depending on the magnitudes of the Fourier series terms, the group orbit may traverse a slice arbitrarily many times.
    \PC{is it still true that the rotation is by $\pi$?}
    } %end \SOn{2}  rotation angle.

\exercise{Determination of group invariants by the {\mslices}:
    }{ \label{exer:mslicesInv}
Show that the $d-N$ \reducedsp\ coordinates determined by the {\mslices} are independent group invariants, and that the {\mslices} allows the determination of (in general non-polynomial) invariants of the group action by a simple  algorithm that works well in high-dimensional \statesp s.
    }

\solution{exer:mslicesInv}
{Determination of group invariants by the {\mslices}:}{
(To be written by Stefan: read and understand relevant parts of Fels and
Olver\rf{FelsOlver98,FelsOlver99,OlverInv}, Siminos\rf{SiminosThesis})
    }

	\fi%end article switch


\subsection{Linear \slice s}
\label{sect:slices}

    \PC{this is a rewrite in progress of \refsect{sect:raw}}
For this \slice\ to be operationally useful, we first must show that a \slice\ \refeq{PCsectQ1}
cuts the group orbit of every point in the full \statesp.

Let $\ssp \in \pS$ be a point in the \statesp, and $\Group$ be Lie group with group elements represented  by $\LieEl=e^{\gSpace \cdot \Lg}$, as in \refeq{FiniteRot}.
    \PC{this looks like a repeat of what is to come, dropped: `` We want to show that there is a point on the group orbit of $\ssp$ which lies in \pSRed, \ie\ there exists a group element $\LieEl=e^{\gSpace \cdot \Lg}$, $\sspRed= \LieEl \ssp \in \pSRed$ such that $\braket{\LieEl \ssp}{\sliceTan{a}}=0$ for all $a$.
    ''}

Consider $f(\gSpace)=\braket{e^{\gSpace \cdot \Lg} \ssp}{\slicep}$, the projection of the group orbit of $\ssp$ onto the slice-fixing ray through \slicep\ (If the state space is real, this differs by a constant from $\|e^{\gSpace \cdot \Lg}\ssp - \slicep\|$, the function used in\rf{rowley_reconstruction_2000,rowley_reduction_2003} to find a point in a slice).
$f$ is a continuous and differentiable function of \gSpace. If $\ssp$ is the invariant subspace \refeq{def:centralizer}, its group orbit is itself and $f(\gSpace)$ takes a constant value.

If $\gSpace_E$ is an extremum of $f$ then all of the first order partial derivatives of $f$ vanish at $\gSpace_E$, $\frac{\partial f(\gSpace_E)}{\partial \gSpace_a} =\braket{\Lg_a e^{\gSpace_E \cdot \Lg} \ssp}{\slicep}=0$. $\Lg_a$ is antihermitian, so
$0=\braket{\Lg_a e^{\gSpace_E \cdot \Lg}\ssp}{\slicep}
= - \braket{\LieEl_E \ssp}{\Lg_a  \slicep}$,
and
\[
\braket{\LieEl_E \ssp}{\sliceTan{a}} =0
\,.
\]
We therefore have that $\sspRed= \LieEl_E \ssp$ is normal to all the group tangents of $\ssp$ so it is in \pSRed. This means that the slice condition is satisfied by $\sspRed_E = \LieEl_E \ssp$ corresponding to an extremum of $f$, and thus $\sspRed_E$ is in the slice (for $\mathbb{R}^n$ this is equivalent to looking for the extrema of $\|e^{\gSpace \cdot \Lg}\ssp - \slicep\|$\rf{rowley_reconstruction_2000,rowley_reduction_2003}, so this says that any points that are locally the closest or the farthest from a our slice fixing point will be in the slice). All that is left to do then is to show that $f$ has extrema. But as the group is compact, the group orbit of every point in \pS\ is compact, so its projection on the slice-point $\slicep$ has at least two extremal points, and thus every group orbit intersects the \slice. For example, group orbits of \SOn{2}\ are topologically circles, and their projections have maxima, minima and inflection points as extrema.
    \PC{
    Stefan, if I have removed some essential part of your proof, please restore it.
    The narrative continues in \refsect{sect:sliceSing}.
    }


\subsection{Dynamics in the slice}
\label{sect:MovFrameODE}

Now that we have shown these slices can be used for the entire state space, our next objective is to investigate
what the equations of motion look like for the \reducedsp\ trajectories.

The \reducedsp\ trajectory is given by $\ssp(\tau)=\LieEl(\tau) \sspRed(\tau)$. Differentiating both sides with respect to time and setting $\velRed=\frac{d \, \sspRed}{d \, \tau}$ we find that,
\[
\vel(\ssp)=\dot{\LieEl} \, \sspRed+\LieEl \, \velRed(\sspRed) \]
\[
\vel(\LieEl \, \sspRed)=\dot{\LieEl} \, \sspRed+\LieEl \, \velRed(\sspRed) \]
\[
\vel=\velRed + \LieEl^{-1} \, \dot{\LieEl} \, \sspRed
\,. 
\]
The product of the inverse of the Lie group element and its time derivative give the group tangent at the point: 
$\LieEl^{-1}\dot{\LieEl}=e^{-\gSpace \cdot \Lg} \,
\frac{d ~~}{d \, \tau} e^{\gSpace \cdot \Lg}=\dot{\gSpace}\cdot \Lg$, leaving us with the equation for the velocity of the reduced flow in the slice:
\beq
\velRed(\sspRed)=\vel(\sspRed)-\dot{\gSpace}(\sspRed)\cdot \groupTan(\sspRed).
\ee{eq:redVel}

Equation \refeq{eq:redVel} tells us that the velocity in the slice is the difference between the velocity in the full space and the portion in the direction of the group tangent, or, conversely, the velocity in the full space is the sum of the velocity in the slice and the velocity normal to it, along the group tangent. The component of the velocity in the direction of the group orbit is removed to leave only that part which is in the slice.

This equation is true for any factorization $\ssp(\tau)=\LieEl(\tau) \sspRed(\tau)$, and provides no information on how to calculate $\gSpace$, which depends on the choice of the slice.
Let $\sliceTan{a}$ be the group tangents \refdef{def:slice} at the slice fixing point. When we add on the restrictions of our linear slices \refdef{def:slice}, we find that $\gSpace$ must satisfy the system of equations:
\beq
\braket{\velRed(\sspRed)}{\sliceTan{a}}
=\braket{\vel(\sspRed)}{\sliceTan{a}}
 -\braket{\dot{\gSpace}\cdot \groupTan(\sspRed)}{\sliceTan{a}}=0
\label{eq:slicecondition}
\eeq
for each group tangent $\sliceTan{a}$ at the slice fixing point. $\SOn{2}$ has a single group tangent resulting in the explicit system of equations:
\bea
\dot{\gSpace}(\sspRed) &=& \frac{\braket{\vel(\sspRed)}{\sliceTan{}}}
               {\braket{\groupTan(\sspRed)}{\sliceTan{}}}
\continue
\velRed(\sspRed) &=& \vel(\sspRed)
   -\dot{\gSpace}(\sspRed) \cdot \groupTan(\sspRed).
\label{eq:so2reduced}
\eea


    \ifarticle
    \else


 %                                                   \exerbox{exer:CLEsmall-x1x2}
 %                                                   \exerbox{exer:csectionCLeODE}
 %                                                   \exerbox{exer:csectionPhase}
    \PC{still have to derive the general case: ``
Let $\sliceTan{}$ be a vector normal to the plane of the slice. Then the dynamics within the slice are given by
\bea
\dot{\gSpace_a}(\sspRed) &=& \frac{\braket{\vel(\sspRed)}{\sliceTan{a}}}
               {\braket{\groupTan(\sspRed)}{\sliceTan{}}}
\continue
\velRed(\sspRed) &=& \vel(\sspRed)
   -\dot{\gSpace}(\sspRed) \cdot \groupTan(\sspRed)
\label{SF:sliceEas}
\eea
where $\velRed(\sspRed)$ is the velocity in the slice.
    ''}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 File: infMF.xfig
\SFIG{ProblemsPill} %infMF}
{}{
Method of moving frames, infinitesimal formulation.
}
{fig:infMF}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \PC{Draw your own \reffig{fig:infMF}.
        }
                                                        \exerbox{exer:csectionReduced}
    \PC{
A more elegant derivation is given in
\refrefs{rowley_reconstruction_2000,rowley_reduction_2003}.
    }


%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CLEpcSect.png computed by  CLEfinal.nb (repo: vaggelis)
% CLEpcSect2.png computed by CLEfinal.nb (repo: vaggelis)
\begin{figure}[ht]
\begin{center}
(a) % \includegraphics[width=0.40\textwidth]{CLEpcSect}
(b) %\includegraphics[width=0.43\textwidth]{CLEpcSect2}
\end{center}
\caption{
Method of moving frames, \slice\ fixed by a point on an
\reqv\ group orbit, $\sspRed = \ssp_{\REQB{}1}$. The strange
attractor of \reffig{fig:CLEx1x2z} in the \reducedsp\
of \refeq{EqMotionMovFramePC}:
(a) $\{x_1,x_2,z\}$ projection,
(b) $\{x_1,y_1,z\}$ projection.
Color-coding indicates $(\hat{\ssp} \cdot \hat{\sspRed})_4$
where $\hat{.}$ stands for unit vector, with green indicating values
of the inner product close to $1$ and brown indicating values
close to $0$.
    }
\label{fig:CLEpcSect}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
A long time trajectory of \refeq{EqMotionMovFramePC} with
$x^*$ on the \reqv\ \REQB{1} group orbit is shown in
\reffig{fig:CLEpcSect}.
                                                        \exerbox{exer:PCsectionCLe}
    \PC{draw your own \reffig{fig:CLEpcSect}:\\
        * Mark $\ssp_{\REQB{}1}$ \\
        * Draw stable eigenvector of $\ssp_{\REQB{}1}$\\
        * State value of $\ssp_{\REQB{}1}$ somewhere
        }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% computed by PCunrot.nb
\SFIG{ProblemsPill} %PCunrot1}
{}{
Method of moving frames, continuous time version, for the
$\slicep=(0,1,0,0)$,
$x_1=0,\;x_2>0$, \slice. The strange attractor of
\reffig{fig:CLEx1x2z} in the \reducedsp,
$\{x_2,y_2,z\}$ projection exhibits a discontinuity at
$x_2=0$.
}
{fig:PCunrot1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The method encounters singularities in
subsets of \statesp\rf{SiminosThesis}.
                                                    \exerbox{exer:csectionCLe}
A typical trajectory is shown in \reffig{fig:PCunrot1}.

    \fi %end of article switch
	
	
\section{\Slice\ singularities}
\label{sect:sliceSing}

Looking back at equation \refeq{eq:so2reduced}, we see that the \mslices\ potentially introduces singularities to the flow. When the group tangent of a point is in the slice, $\braket{\groupTan(\sspRed)}{\sliceTan{}}$ is zero. Hence  $\dot{\gSpace}(\tau)$ is not defined and as a consequence neither is the velocity in the slice. These singularities do not exist in the full space and are entirely artifacts of the \mslices. When the full space trajectory passes through one of these points the trajectory just passes through unhindered. The hope is then that these singularities do not greatly affect the trajectory in the reduced space.

	\ifarticle
	\else
	
In \refsect{sect:slices} we noted that the projection $f(\gSpace)$
can have inflection points,
    \PC{Are we only interested in Laplace-Beltrami operator on the
    group manifold
    \\
    \(
    \frac{\partial^2 ~~}{\partial \gSpace^2} f(\gSpace) =
    - \braket{\groupTan(\sspRed)}{\sliceTan{}} =
    \braket{\sspRed}{\dual{\Lg} \cdot {\Lg}\,\slicep}
    \)
    }
\beq
\frac{\partial^2 f(\gSpace_E)}
     {\partial \gSpace_a \partial \gSpace_b}
    =
  - \braket{\Lg_a e^{\gSpace_E \cdot \Lg} \ssp}{\sliceTan{b}}=
  - \braket{\groupTan_a(\sspRed_E)}{\sliceTan{b}}=0
\ee{PCinflPoint}
What role do they play? They are non-generic, but
if we consider projections of a successive instants of a trajectory
$f(\gSpace)=\braket{e^{\gSpace(t) \cdot \Lg} \ssp(t)}{\slicep}$, coalescence of
nearby minima, maxima pairs cannot be avoided. At the instant of coalescence
the denominator in \refeq{SF:sliceEas} goes through a simple pole,
and the integrated trajectory within slice jumps. Our next task is
to compute the size of the jump.
    \PC{`` from the principal value of the integrated velocity field on a trajectory through this singularity.'' Stefan, take it from here.}
    \PC{could it be that inflections are generic only for \SOn{2},
        but of higher codimension and thus not encountered
        by 1$d$ time trajectory for higher-dimensional Lie groups?}

Once we determine the trajectory point at which
a singularity occurs, we have to describe what happens to the \reducedsp\ trajectory when it passes through the singularity. The trajectory in the \reducedsp\ is given by $\sspRed(\tau)=\LieEl^{-1}(\tau) \ssp(\tau)$, so if we know how $\LieEl(\tau)=\exp({-\gSpace(\tau) \cdot \Lg})$ behaves as the trajectory passes through a singularity, then we know how the \reducedsp\ trajectory behaves.



%\subsection{\CLe\ singularities}
%\label{sect:cLeSing}

%To answer this question, let us first look at the example of the \cLe. There is only one infinitesimal generator for the \SOn{2} symmetry group, so the rotation angle $\gSpace$ into the \reducedsp\ trajectory is given by \refeq{SL:CLEsliceRot}.

%If $\ssp(\tau)$ is a trajectory in full state space, then the
 %\reducedsp\ flow $\sspRed(\tau)$ goes through a singularity when
 %$\braket{\groupTan_{}(\sspRed^*)}{\sliceTan{}}=0$
%at time $\tau=0$, $\sspRed^* = \sspRed(0)$.
%The angle $\gSpace^*$ for rotating a point into the slice must satisfy
 %   \PC{Isn't some of this already worked out in \refexam{exam:CLErotAngle}?
  %      You should refer to already derived results, rather than repeating
   %     the same text}
%\bea
%0             &=&
%\braket{\ssp}{\sliceTan{}}\cos(\gSpace^*) +
%\braket{\groupTan_{}(\ssp)}{\sliceTan{}}\sin(\gSpace^*)
%    \continue
%\tan(\gSpace^*) &=&
%-{\braket{\ssp}{\sliceTan{}}}/{\braket{\groupTan_{}(\ssp)}{\sliceTan{}}}
% \,.
%\label{SF:SO2angleRot}
% \refeq{SF:SO2angleRot}
%\eea
%This equation has two solutions
%$\{\sspRed^*=\LieEl(\gSpace^*)\ssp, \LieEl(\gSpace^*+\pi)\ssp\}$
%unless both $\braket{\sspRed^*}{\sliceTan{}}$
%and $\braket{\groupTan_{}(\sspRed^*)}{\sliceTan{}}$ are zero,
%in which case any angle works (this is exactly the situation
%the trajectory is in when it passes through a singularity
%$\ssp^*$).

%Consider $\gSpace(\tau)$ approaching the singularity value
%$\gSpace^*$ as $\tau \rightarrow 0$.
%The trajectory is smooth, so it can be approximated by the linear
%term in the Taylor expansion,
%$
%\ssp(\tau)=\sspRed^*+\vel^*\tau+O(\tau^2)
%\,,\qquad
%\vel^* = \vel(\sspRed^*)
%    \,.
%$
%    \PC{Stefan had ``
%$\ssp(\tau)=\ssp(0)+\vel(0)\tau+\Mvar(\period{})\frac{\tau^2}{2}$ where $\Mvar$ is the stability matrix and $\period{}$ is between $0$ and $\tau$.
%    '' This looks wrong to me. In any case, the order ${\tau^2}{2}$ term is
%    not used.
% -\frac{\braket{\ssp(0)+\vel(0)\tau
% +\Mvar(\period{})\frac{\tau^2}{2}}{\sliceTan{a}}}{
% \braket{\Lg(\ssp(0)+\vel(0)\tau+\Mvar(\period{})\frac{\tau^2}{2})}{\sliceTan{}}}
%    }
%Hence as $\tau \rightarrow 0$,
%\bea
%\tan(\gSpace)
% = -\frac{\braket{\ssp}{\sliceTan{}}}{\braket{\groupTan_{}(\ssp)}{\sliceTan{}}}
%&\rightarrow&
%-\frac{\braket{\sspRed^*+\vel^*\tau}{\sliceTan{}}}
%{\braket{\Lg(\sspRed^*+\vel^*\tau)}{\sliceTan{}}}
%    \continue
%\tan(\gSpace^*) &=&
%     -\frac{\braket{\vel^*}{\sliceTan{}}}
%      {\braket{\groupTan_{}(\vel^*)}{\sliceTan{}}}
%\,.
%\label{SF:snglrAngl}
%\eea
%So at the singular point the slice-rotation angle $\gSpace^*$ is computed as in
%\refeq{SF:SO2angleRot}, but using $\vel^*$ rather than $\ssp^*$; as
%$\ssp$ and  $\vel(\ssp)$ rotate rigidly together, that is OK.

%If we add on the restriction $\braket{\groupTan_{}(\ssp)}{\sliceTan{}}$ \refeq{SF:orientedSlice} be nonnegative so that we get a unique representative from each trajectory, then as the trajectory approaches the singularity $\braket{\groupTan_{}(\ssp)}{\sliceTan{}}\approx \tau \braket{\Lg\vel^*}{\sliceTan{}}$. As $\tau$ goes from negative to positive, this expression changes sign, so when the trajectory goes through the slice,
%according to \refdef{def:movingFrame} we must rotate the trajectory by $\pi$ in order for it to satisfy the restriction.


    \fi %end of article switch

\subsection{Passing through a singularity}
\label{sect:passingSing}

The behavior of the \reducedsp\ trajectory is entirely determined by the $\gSpace$ used to rotate the full space trajectory into the slice. If we can find an expression for $\gSpace$ as the trajectory approaches a singularity then we know the behavior of the \reducedsp\ trajectory as it approaches a singularity.

Suppose the trajectory passes through a singularity at time $\tau=\tau_0$.
$\ssp(\tau)$ is $C^{\infty}$ since we can explicitly calculate any order derivative using $\dot{\ssp}=\vel(\ssp)$. This allows us to use Taylor expansions to approximate the trajectory at any time $\tau_0$; $\ssp(\tau)=\ssp(\tau_0)+\vel(\ssp(\tau_0)) (\tau-\tau_0)+O((\tau-\tau_0)^2)$. Being in the linear slice imposes the condition \refeq{PCsectQ1} on $\gSpace(\tau)$ for each infinitesimal generator $\sliceTan{a}$ of the Lie group at $\slicep$. Using the results of \refsect{sect:slices} we can rotate the trajectory in the full state space so that $\ssp(\tau_0)$ is in the slice and the equivariance of the flow \refeq{eq:FiniteRot} allows us to work with this equivalent trajectory. This gives us the condition for $\gSpace$ \refeq{eq:slicecondition} in terms of the Taylor expansion:
\[
\braket{e^{\gSpace \cdot \Lg}(\ssp(\tau_0)+\vel(\ssp(\tau_0)) (\tau-\tau_0)+O(\tau^2))}{\sliceTan{a}}
\]
If in addition we know that all the higher order terms in the inner product are negligible compared to the linear term near $\tau_0$,
\beq
\braket{e^{\gSpace \cdot \Lg} O((\tau-\tau_0)^2)}{\sliceTan{a}}
\ll \braket{e^{\gSpace \cdot \Lg}\vel(\ssp(\tau))(\tau-\tau_0)}{\sliceTan{a}},
\ee{eq:neglig}
then we can take the limit of this expression as $\tau \rightarrow \tau_0$:
\bea
&&\braket{e^{\gSpace \cdot \Lg}(\ssp(\tau_0)+\vel(\ssp(\tau_0)) (\tau-\tau_0)+O(\tau^2))}{\sliceTan{a}}
    \continue
&\approx& \braket{e^{\gSpace \cdot \Lg}\ssp(\tau_0)+ e^{\gSpace \cdot \Lg}\vel(\ssp(\tau_0)) (\tau-\tau_0)}{\sliceTan{a}}
    \continue
&\approx&  \braket{e^{\gSpace \cdot \Lg}\vel(\ssp(\tau_0)) (\tau-\tau_0)}{\sliceTan{a}}
    \continue
&\approx&  (\tau-\tau_0)\braket{e^{\gSpace \cdot \Lg}\vel(\ssp(\tau_0))}{\sliceTan{a}}\approx 0
\,.
\eea
$\gSpace$ approaches $\gSpace^*$ such that $\braket{e^{\gSpace^* \cdot \Lg}\vel(\ssp(\tau_0))}{\groupTan(\slicep)}= 0$ so $\gSpace$ approaches an angle that rotates $\vel(\ssp(\tau_0))$ into the slice. Which angle it approaches before and after the singularity depend on the restrictions put on the moving frame (\refdef{def:movingFrame}, and the trajectory can jump from one $\gSpace$ to another depending on this choice. The only affect passing through a singularity will have on the \reducedsp\ trajectory then is to cause it jump from one point on a group orbit to another at the singularity, and the trajectory will be smooth otherwise.

\example{\CLe\ singularities.}
{
Suppose the singularity occurs at $\tau=0$. From \refexam{exam:CLErotAngle} we have the equation for $\gSpace$
\bea
\tan(\gSpace) &=&
-\frac{{\braket{\ssp}{\sliceTan{}}}}{{\braket{\groupTan_{}(\ssp)}{\sliceTan{}}}}.
\eea
Rotate the trajectory so that $\ssp(\tau_0)$ is in the slice. Using the Taylor expansion for the trajectory and letting $\tau \rightarrow 0$ we find that:
\bea
\tan(\gSpace)
&=& -\frac{\braket{\ssp_0+\vel(\ssp_0)\tau+O(\tau^2)}{\sliceTan{}}}{\braket{\groupTan(\ssp_0+\vel(\ssp_0)\tau+O(\tau^2))}{\sliceTan{}}}
\continue
\tan(\gSpace)
&\rightarrow& -\frac{\braket{\ssp_0}{\sliceTan{}}+\tau\braket{\vel(\ssp_0)}{\sliceTan{}}+O(\tau^2)}{\braket{\groupTan(\ssp_0)}{\sliceTan{}}+\tau
\braket{\vel(\ssp_0)}{\sliceTan{}}+O(\tau^2)}
\continue
\tan(\gSpace) &\rightarrow&
     -\frac{\braket{\vel(\ssp_0)}{\sliceTan{}}}
      {\braket{\groupTan_{}(\vel(\ssp_0))}{\sliceTan{}}}
\,.
\label{SF:snglrAngl}
\eea
As predicted, $\gSpace$ approaches an angle that rotates $\vel(\ssp_0)$ into the slice.
Next add on the restriction $\braket{\groupTan_{}(\ssp)}{\sliceTan{}}$ (\refdef{def:movingFrame}) be nonnegative, then as the trajectory approaches the singularity $\braket{\groupTan(\ssp)}{\sliceTan{}}\approx \tau \braket{\Lg\vel^*}{\sliceTan{}}$. As $\tau$ goes from negative to positive, this expression changes sign. Hence we must rotate the trajectory by $\pi$ to satisfy the condition.
}
%\SFIG{jump}
%{}{
%A $\{y_2,y_1,z\}$ plot of the \reducedsp\ \cLe\ trajectory with initial point passing $(x_1, x_2, y_1, y_2, z) = (1, 2, 3, 1, 2)$ through a singularity at time $\tau=0.1$ in the slice normal to $\sliceTan{}={-0.0345614, 0.16259, 0.0144152, -0.0789286, 0}$. The blue portion is the trajectory before the singularity, the purple and the yellow trajectories are the two possible continuations of the trajectory after the singularity (notice they differ by a rotation of $\pi$). The yellow trajectory is the one chosen by the constraint [ref]

%    }{fig:jump}

\example{$\SOn{2}$ singularities.}
{\label{ex:so2singularities}
Consider now the general from of an $\SOn{2}$ symmetry from \refexam{exam:SO2irrepst}. Plugging this into the slice condition \refeq{PCsectQ1} we find that
\bea
\braket{e^{\gSpace \Lg}\ssp}{\groupTan(\slicep)}
=\braket{\ssp}{(\sum\limits_m (\cos(-m\gSpace) \id^{(m)}
     +\sin(-m\gSpace) \frac{1}{m}\Lg^{(m)})) \sliceTan{}}
\continue
=\sum\limits_m(\cos(m\gSpace) \braket{\ssp}{\Lg^{(m)} \slicep}-\sin(m\gSpace) \braket{\ssp}{\id^{(m)} \slicep}).
\label{eq:so2sing}
\eea
Both $\cos(m\gSpace)$ and $\sin(m\gSpace)$ are expressible as polynomials of degree m in $\sin(\gSpace)$ and $\cos(\gSpace)$, so \refeq{eq:so2sing} is expressible of a polynomial whose coefficients are determined by $\braket{\ssp}{\Lg^{(m)} \slicep}$ and $\braket{\ssp}{\id^{(m)}}$. $\gSpace$ corresponds to a root of this polynomial. The coefficients of the polynomial vary smoothly with $\ssp$, so its roots vary smoothly too. This means \refeq{eq:neglig} is satisfied for these $\SOn{2}$ symmetries and we can use the result of \refeq{SF:snglrAngl}.
}

\subsection{Behavior of $\dot{\gSpace}$}

Consider the behavior of $\dot{\gSpace}$ as a trajectory passes through a singularity. The singularity occurs when the denominator of \refeq{eq:slicecondition} has a 0. But what about the numerator, $\braket{\vel(\sspRed)}{\sliceTan{}}$?. We know that $\sspRed=e^{\gSpace\cdot\Lg}\ssp$, and as the \reducedsp\ trajectory approaches a singularity $\sspRed_0$, $\gSpace$ approaches $\gSpace_0$ where $\gSpace_0$ is an angle that rotates the full space velocity at $\ssp_0$ into the slice. Hence $\braket{\vel(\sspRed)}{\sliceTan{}}$ approaches $\braket{\vel(\sspRed_0)}{\sliceTan{}}
=\braket{\vel(e^{\gSpace_0\cdot\Lg}\ssp_0}{\sliceTan{}}
=\braket{e^{\gSpace_0\cdot\Lg}\vel(\ssp_0)}{\sliceTan{}}$,
but $\gSpace_0$ is an angle which rotates $\vel(\ssp_0)$ into the slice, so this inner product is 0. So the numerator also approaches 0 as the trajectory approaches a singularity.

\subsection{Singularities of $\SOn{2} \times \SOn{2}$}

While most systems in fluid dynamics do not exhibit a single $\SOn{2}$ symmetry, many do have continuous symmetries which are the products of $\SOn{2}$ groups, each of which act on different coordinates of the state space. The \KS\ equations\rf{ku,siv}, {\pCf}\rf{Visw07b,GHCW07,HGC08,HalcrowThesis}, and pipe flow\rf{Wk04,Kerswell05} all have continuous symmetries of this form.

                                                    %\toCB
% PC cribbed from Penrose p. 254:
\begin{definition}
\label{def:productGroup}
\textbf{Product group.}
If \Group\ and H are any two groups, then they can be combined in
what is called the {\em product group} $\Group \times H$, whose
elements are pairs $(\LieEl,h)$, where $\LieEl$ belongs to \Group, and
$h$ belongs to $H$, with the group multiplication rule
\[
(\LieEl_1,h_1)(\LieEl_2,h_2)=(\LieEl_1 \LieEl_2,h_1 h_2)
\,.
\]
\end{definition}

Suppose that the state space is the product of two spaces,
$\mathbb{X}=\mathbb{A} \times \mathbb{B}$. Let $\Group$ be a Lie group
with two infinitesimal generators, $\Lg_1$ and $\Lg_2$, such that the
$e^{\gSpace_1 \Lg_1}$ action on $\mathbb{X}$ fixes the $\mathbb{B}$
coordinates ($e^{\gSpace_1 \Lg_1} \, (a,b)=(a',b')$ where $b'=b$) and
$e^{\gSpace_2 \Lg_2}$ fixes the $\mathbb{A}$ coordinates ($\Group$ is the
product (see \refdef{def:productGroup}) of two $\SOn{2}$ groups which act on
different coordinates of $\mathbb{X}$).

We begin by looking at the action of infinitesimal rotations of $\Lg_1$.
$e^{\delta \gSpace_1 \Lg_1}(a,b)=(1+\delta \gSpace_1 \Lg_1)
(a,b)$\refeq{eq:infinitesimal}. $e^{\delta \gSpace \Lg_1}$ fixes the
$\mathbb{B}$ coordinates, so $e^{\delta \gSpace \Lg_1}=(a',b)$ for some
$a'$. This results in $(a',b)=(a,b)+\delta \gSpace_1 \Lg_1(a,b)$ so
$\delta \gSpace_1 \Lg_1(a,b)=(a'-a,0)$. This is true for any $\delta
\gSpace_1$, so $\Lg_1$ maps the $\mathbb{B}$ coordinates to 0. The same
argument gives us that $\Lg_2$ maps the $\mathbb{A}$ coordinates to 0.
Looking at $\Lg_1 \Lg_2$ we find $\Lg_1 \Lg_2 (a,b)=\Lg_1 (0,b')=(0,0)$
for any $(a,b) \in \mathbb{X}$, which is only possible if $\Lg_1
\Lg_2=0$. The same argument tells us that $\Lg_2 \Lg_1=0$ %(this also
follows from $\Lg_1 \Lg_2=0$ and the fact that the $\Lg_i$ are
antihermitian).

We can now use $\Lg_1 \Lg_2=\Lg_2 \Lg_1=0$ to demonstrate a significant
result about the singularities of this symmetry group.

Suppose we are rotating a trajectory $\ssp(\tau)$ into the slice normal
to the group tangents at $\slicep$. Using
$\sliceTan{a}=\groupTan_1(\slicep)$ for equation
\refeq{eq:slicecondition} tells us that
$\braket{\vel(\sspRed)}{\groupTan_1(\slicep)}-\dot{\gSpace_1} \braket{
\groupTan_1(\sspRed)}{\groupTan_1(\slicep)}-\dot{\gSpace_2} \braket{
\groupTan_2(\sspRed)}{\groupTan_1(\slicep)}=0$.

We have $\braket{\groupTan_2(\sspRed)}{\groupTan_1(\slicep)}=0$ since
$\Lg_1 \Lg_2=0$, leaving us with
$\braket{\vel(\sspRed)}{\groupTan_1(\slicep)}
-\dot{\gSpace_1}\braket{\groupTan_1(\sspRed)}{\groupTan_1(\slicep)}=0$.
This gives us the equation for $\dot{\gSpace_1}$,
\beq
\dot{\gSpace_1}=\frac{\braket{\vel(\sspRed)}{\groupTan_1(\slicep)}}
                     {\braket{\groupTan_1(\sspRed)}{\groupTan_1(\slicep)}}.
\eeq
This is the same as \refeq{eq:so2reduced} for the rotation group
consisting of only the rotations generated by $\Lg_1$. This equation is
independent of the action of $\Lg_2$. This means a point being singular
depends only on whether or not it is singular in either of the slices
normal to only one of the group tangents. This permits us to break up the
problem of determining if a point is singular and how this affects the
\reducedsp\ trajectory for the entire group into the same problem for
each of the $\SOn{2}$ groups generated by one of the infinitesimal
generators individually, a situation we are comfortable with.

This makes sense since if a point $\sspRed$ is in the slice normal to
$\groupTan_2(\slicep)$ then any point in the $\Lg_1$ orbit is in the
slice since $\braket{e^{\gSpace_1
\Lg_1}\sspRed}{\groupTan_2(\slicep)}=\braket{(1+\gSpace_1
\Lg_1+\ldots)\sspRed}{\groupTan_2(\slicep)}
=\braket{\sspRed}{\groupTan_2(\slicep)}+\braket{\gSpace_1
\Lg_1 \sspRed}{\groupTan_2(\slicep)}+\ldots=0$. The first inner product
is zero because we assumed that $\sspRed$ was in the slice and the rest
of the terms are zero because $\Lg_1 \Lg_2=0$. So the only restriction
for the values of $\gSpace_1$ that rotate the point into the slice are
the restrictions it gets from the $\groupTan_1(\slicep)$ condition.

This argument is easily extended to a product of arbitrarily many
$\SOn{2}$ acting on different coordinates of the state space (any two of
the $\SOn{2}$ act on distinct coordinates so the singularities are
pairwise independent). In \refexam{ex:so2singularities} we found a simple
description for what happens to the \reducedsp\ trajectory as it passes
through singularity of a single $\SOn{2}$ symmetry group (it is rotated
by a finite amount), so using this result we can handle the singularities
for the product of arbitrarily many $\SOn{2}$ groups which pairwise act
on different coordinates of the state space.
