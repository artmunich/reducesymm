(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     38452,       1051]
NotebookOptionsPosition[     38150,       1037]
NotebookOutlinePosition[     38495,       1052]
CellTagsIndexPosition[     38452,       1049]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"cLeRot", "[", 
   RowBox[{"x0_", ",", "tx_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "finds", " ", "the", " ", "point", " ", "in", " ", "the", " ", "group", 
    " ", "orbit", " ", "of", " ", "x0", " ", "in", " ", "th", " ", "slice", 
    " ", "normal", " ", "to", " ", "tx"}], "*)"}], 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xi", "=", 
       RowBox[{"x0", "//", "Flatten"}]}], ",", 
      RowBox[{"ti", "=", 
       RowBox[{"tx", "//", "Flatten"}]}], ",", 
      RowBox[{"T", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
        "}"}]}], ",", "G", ",", "theta", ",", "v"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{"T", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{"theta", "//", "Flatten"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", ".", "ti"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"theta", ".", "ti"}], ")"}]}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"-", "theta"}], "]"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"G", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"Sin", "[", "theta", "]"}], ",", "0", ",", "0", ",", "0"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
           RowBox[{"Cos", "[", "theta", "]"}], ",", "0", ",", "0", ",", "0"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"Sin", "[", "theta", "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
           RowBox[{"Cos", "[", "theta", "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
        "}"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"xi", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"xi", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"G", ".", "xi"}], ")"}], "//", "Flatten"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Text"], 
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{"T", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}]}], "Text"], 
     StyleBox[";", "Text"], 
     StyleBox["\[IndentingNewLine]", "Text"], 
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{"theta", "//", "Flatten"}]}], "Text"], 
     StyleBox[";", "Text"], 
     StyleBox["\[IndentingNewLine]", "Text"], 
     StyleBox[
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"theta", ".", "ti"}], "<", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xi", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"xi", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], ",", 
            RowBox[{"xi", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], "Text"], 
     StyleBox[";", "Text"], 
     StyleBox["\[IndentingNewLine]", "Text"], 
     StyleBox["xi", "Text"]}]}], 
   StyleBox["\[IndentingNewLine]", "Text"], 
   StyleBox["]", "Text"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cLeRot2", "[", 
   RowBox[{"x0_", ",", "tx_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "the", " ", "angle", " ", "used", " ", "to", " ", "rotate",
     " ", "x0", " ", "into", " ", "the", " ", "slice", " ", "normal", " ", 
    "to", " ", "tx"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xi", "=", 
       RowBox[{"x0", "//", "Flatten"}]}], ",", 
      RowBox[{"ti", "=", 
       RowBox[{"tx", "//", "Flatten"}]}], ",", 
      RowBox[{"T", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
        "}"}]}], ",", "G", ",", "theta", ",", "v", ",", "check"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{"T", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{"theta", "//", "Flatten"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xi", ".", "ti"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"theta", ".", "ti"}], ")"}]}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"theta", "=", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"-", "theta"}], "]"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"G", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"Sin", "[", "theta", "]"}], ",", "0", ",", "0", ",", "0"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
           RowBox[{"Cos", "[", "theta", "]"}], ",", "0", ",", "0", ",", "0"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"Cos", "[", "theta", "]"}], ",", 
           RowBox[{"Sin", "[", "theta", "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
           RowBox[{"Cos", "[", "theta", "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
        "}"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"xi", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Input"], 
     StyleBox[
      RowBox[{"xi", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"G", ".", "xi"}], ")"}], "//", "Flatten"}]}], "Input"], 
     StyleBox[";", "Input"], 
     StyleBox["\[IndentingNewLine]", "Text"], 
     StyleBox[
      RowBox[{"check", "=", 
       RowBox[{"T", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xi", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}]}], "Text"], 
     StyleBox[";", "Text"], 
     StyleBox["\[IndentingNewLine]", "Text"], 
     StyleBox[
      RowBox[{"check", "=", 
       RowBox[{"check", "//", "Flatten"}]}], "Text"], 
     StyleBox[";", "Text"], 
     StyleBox["\[IndentingNewLine]", "Text"], 
     StyleBox[
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"check", ".", "ti"}], "<", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theta", "=", 
          RowBox[{"theta", "+", "Pi"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], "Text"], 
     StyleBox[";", "Text"], 
     StyleBox["\[IndentingNewLine]", "Text"], 
     StyleBox["theta", "Text"]}]}], 
   StyleBox["\[IndentingNewLine]", "Text"], 
   StyleBox["]", "Text"]}]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"cLetraj", "[", 
    RowBox[{"x0_", ",", "tf_"}], "]"}], "  ", ":=", "\[IndentingNewLine]", 
   RowBox[{
    StyleBox[
     RowBox[{"(", "*"}]], 
    RowBox[{
    "Finds", " ", "the", " ", "fullspace", " ", "trajectory", " ", "with", 
     " ", "initial", " ", "point", " ", "x0", " ", "for", " ", "a", " ", 
     "time", " ", "tf"}], 
    StyleBox[
     RowBox[{"*", ")"}]]}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r1", "=", "28"}], ",", 
       RowBox[{"r2", "=", "0"}], ",", 
       RowBox[{"b", "=", 
        RowBox[{"8", "/", "3"}]}], ",", 
       RowBox[{"e", "=", 
        RowBox[{"1", "/", "10"}]}], ",", 
       RowBox[{"s", "=", "10"}], ",", 
       RowBox[{"tf1", "=", "tf"}], ",", 
       RowBox[{"xi", "=", 
        RowBox[{"x0", "//", "Flatten"}]}], ",", "traj", ",", "v", ",", "x", 
       ",", "eqns", ",", "xde", ",", "ic", ",", "sol", ",", "x1", ",", "x2", 
       ",", "y1", ",", "y2", ",", "z", ",", "t"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", "t_", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "s"}], "*", 
           RowBox[{"x1", "[", "t", "]"}]}], "+", 
          RowBox[{"s", "*", 
           RowBox[{"y1", "[", "t", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "s"}], "*", " ", 
           RowBox[{"x2", "[", "t", "]"}]}], "+", 
          RowBox[{"s", "*", " ", 
           RowBox[{"y2", "[", "t", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r1", "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}], "*", 
           RowBox[{"x1", "[", "t", "]"}]}], "-", 
          RowBox[{"r2", "*", " ", 
           RowBox[{"x2", "[", "t", "]"}]}], "-", 
          RowBox[{"y1", "[", "t", "]"}], "-", 
          RowBox[{"e", "*", " ", 
           RowBox[{"y2", "[", "t", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"r2", "*", " ", 
           RowBox[{"x1", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r1", "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}], "*", 
           RowBox[{"x2", "[", "t", "]"}]}], "+", 
          RowBox[{"e", "*", " ", 
           RowBox[{"y1", "[", "t", "]"}]}], "-", 
          RowBox[{"y2", "[", "t", "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "b"}], " ", "*", 
           RowBox[{"z", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"x1", "[", "t", "]"}], "*", " ", 
           RowBox[{"y1", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"x2", "[", "t", "]"}], "*", " ", 
           RowBox[{"y2", "[", "t", "]"}]}]}]}], "}"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"x", "[", "t_", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "[", "t", "]"}], ",", 
         RowBox[{"x2", "[", "t", "]"}], ",", 
         RowBox[{"y1", "[", "t", "]"}], ",", 
         RowBox[{"y2", "[", "t", "]"}], ",", 
         RowBox[{"z", "[", "t", "]"}]}], "}"}]}], ";", "\n", "\t", 
      RowBox[{"eqns", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"v", "[", "t", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"xde", "=", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2", ",", "z"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ic", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x1", "[", "0", "]"}], "\[Equal]", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"x2", "[", "0", "]"}], "\[Equal]", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"y1", "[", "0", "]"}], "\[Equal]", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"y2", "[", "0", "]"}], "\[Equal]", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"z", "[", "0", "]"}], "\[Equal]", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}]}], "}"}]}], ";", "\n", "\t", 
      RowBox[{"sol", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"eqns", ",", "ic"}], "}"}], ",", "xde", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "tf1"}], "}"}], ",", 
          RowBox[{"MaxSteps", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
        "Flatten"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"traj", "[", "t_", "]"}], "=", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], "/.", "sol"}]}], ";", 
      "\[IndentingNewLine]", "traj"}]}], "\[IndentingNewLine]", "]"}]}],
  FontSize->14], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cLeRotSlice", "[", 
   RowBox[{"x0_", ",", "tf_", ",", "tx_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Finds", " ", "the", " ", "reduced", " ", "space", " ", 
    RowBox[{"trajectory", ".", " ", "Does"}], " ", "this", " ", "by", " ", 
    "taking", " ", "the", " ", "full", " ", "space", " ", "trajectory", " ", 
    "and", " ", "then", " ", "rotating", " ", "it", " ", "into", " ", "the", 
    " ", 
    RowBox[{"slice", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xi", "=", 
       RowBox[{"x0", "//", "Flatten"}]}], ",", 
      RowBox[{"tfi", "=", "tf"}], ",", 
      RowBox[{"ti", "=", 
       RowBox[{"tx", "//", "Flatten"}]}], ",", "traj", ",", "t", ",", 
      "slice"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"traj", "=", 
      RowBox[{"cLetraj", "[", 
       RowBox[{"xi", ",", "tfi"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"slice", "[", "t_", "]"}], ":=", 
      RowBox[{"cLeRot", "[", 
       RowBox[{
        RowBox[{"traj", "[", "t", "]"}], ",", "ti"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "slice"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cLeSliceFind", "[", 
   RowBox[{"x0_", ",", "tf_", ",", "a_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Finds", " ", "the", " ", "normal", " ", "to", " ", "a", " ", "slice", " ",
     "where", " ", "the", " ", "trajectory", " ", "through", " ", "x0", " ", 
    "passes", " ", "through", " ", "a", " ", 
    RowBox[{"singularity", ".", " ", "The"}], " ", "singularity", " ", 
    "occurs", " ", "at", " ", "time", " ", 
    RowBox[{"tf", "/", "2."}], " ", "The", " ", "method", " ", "produces", 
    " ", "two", " ", "linearly", " ", "independent", " ", "vectors", " ", 
    "and", " ", "the", " ", "vector", " ", "a", " ", "is", " ", "used", " ", 
    "to", " ", "determine", " ", "what", " ", "linear", " ", "combination", 
    " ", "of", " ", "the", " ", "two", " ", "vectors", " ", "you", " ", 
    "want", " ", "to", " ", "use", " ", "for", " ", "the", " ", "normal", " ",
     "to", " ", "the", " ", 
    RowBox[{"slice", "."}]}], "*)"}], 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xi", "=", 
       RowBox[{"x0", "//", "Flatten"}]}], ",", 
      RowBox[{"tfi", "=", "tf"}], ",", "traj", ",", "x1", ",", 
      RowBox[{"T", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
        "}"}]}], ",", "A", ",", "r", ",", "s", ",", "t"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"traj", "=", 
      RowBox[{"cLetraj", "[", 
       RowBox[{"xi", ",", "tfi"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x1", "=", 
      RowBox[{"traj", "[", 
       RowBox[{"tfi", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ")"}], "^", "2"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"x1", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"x1", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"x1", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"x1", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s", "/", "r"}], ",", 
          RowBox[{
           RowBox[{"-", "t"}], "/", "r"}], ",", "0", ",", "1", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "t"}], "/", "r"}], ",", 
          RowBox[{
           RowBox[{"-", "s"}], "/", "r"}], ",", "1", ",", "0", ",", "0"}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", ".", "A"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cLeVel", "[", "x0_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "returns", " ", "the", " ", "full", " ", "space", " ", "velocity", " ", 
    "at", " ", "the", " ", "point", " ", "x0"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r1", "=", "28"}], ",", 
      RowBox[{"r2", "=", "0"}], ",", 
      RowBox[{"b", "=", 
       RowBox[{"8", "/", "3"}]}], ",", 
      RowBox[{"e", "=", 
       RowBox[{"1", "/", "10"}]}], ",", 
      RowBox[{"s", "=", "10"}], ",", 
      RowBox[{"xi", "=", 
       RowBox[{"x0", "//", "Flatten"}]}], ",", "v"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "s"}], "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{"s", "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "s"}], "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "+", 
         RowBox[{"s", "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1", "-", 
            RowBox[{"xi", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "-", 
         RowBox[{"r2", "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "-", 
         RowBox[{"xi", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "-", 
         RowBox[{"e", "*", " ", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"r2", "*", " ", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1", "-", 
            RowBox[{"xi", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "+", 
         RowBox[{"e", "*", " ", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "-", 
         RowBox[{"xi", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "b"}], " ", "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"xi", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"xi", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "v"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"singOrbit", "[", 
   RowBox[{"xsing_", ",", "tx_", ",", "tf_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "a", " ", "function", " ", "from", " ", "0", " ", "to", 
    " ", "tf", " ", "which", " ", "maps", " ", "out", " ", "the", " ", 
    "group", " ", "orbit", " ", "of", " ", "the", " ", "singularity", " ", 
    "point", " ", "xsing", " ", "between", " ", "the", " ", "angles", " ", 
    "necessary", " ", "to", " ", "rotate", " ", "the", " ", "full", " ", 
    "space", " ", "velocity", " ", "at", " ", "xsing", " ", "into", " ", 
    "the", " ", "slice", " ", "normal", " ", "to", " ", 
    RowBox[{"tx", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xsingi", "=", 
       RowBox[{"xsing", "//", "Flatten"}]}], ",", 
      RowBox[{"ti", "=", 
       RowBox[{"tx", "//", "Flatten"}]}], ",", "v", ",", "theta0", ",", 
      "orbit", ",", "G", ",", "theta", ",", "t", ",", "orbit1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"cLeVel", "[", "xsingi", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"theta0", "=", 
      RowBox[{"cLeRot2", "[", 
       RowBox[{"v", ",", "ti"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"theta", "[", "t_", "]"}], ":=", 
      RowBox[{"theta0", "-", 
       RowBox[{"Pi", "*", 
        RowBox[{"t", "/", "tf"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "[", "t_", "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"theta", "[", "t", "]"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"theta", "[", "t", "]"}], "]"}], ",", "0", ",", "0", ",", 
          "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            RowBox[{"theta", "[", "t", "]"}], "]"}]}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"theta", "[", "t", "]"}], "]"}], ",", "0", ",", "0", ",", 
          "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"theta", "[", "t", "]"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"theta", "[", "t", "]"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            RowBox[{"theta", "[", "t", "]"}], "]"}]}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"theta", "[", "t", "]"}], "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xsingi", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xsingi", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xsingi", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xsingi", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xsingi", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"xsingi", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"orbit1", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{"G", "[", "t", "]"}], ".", "xsingi"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"orbit", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{"orbit1", "[", "t", "]"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", "orbit"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.4984049046342497`*^9, 3.4984049050248747`*^9}, {
  3.4984050371029997`*^9, 3.4984055150404997`*^9}, {3.4984065747592497`*^9, 
  3.4984066262904997`*^9}, {3.499437505759*^9, 3.499437906274625*^9}, {
  3.499437944774625*^9, 3.4994380150715*^9}, {3.499438253743375*^9, 
  3.499438289399625*^9}, {3.49943859535275*^9, 3.499438597493375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "x0", " ", "is", " ", "the", " ", "initial", " ", "point", " ", "of", " ",
      "the", " ", "trajectory"}], ",", " ", 
    RowBox[{
    "tf", " ", "is", " ", "the", " ", "amount", " ", "of", " ", "time", " ", 
     "to", " ", "calculate", " ", "the", " ", "trajectory"}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "the", " ", "normal", " ", "to", " ", "a", " ", 
     "slice", " ", "which", " ", "has", " ", "a", " ", "singularity", " ", 
     "at", " ", 
     RowBox[{"tf", "/", "2"}], " ", "is", " ", 
     RowBox[{"calculated", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x0", "=", 
     RowBox[{"{", 
      RowBox[{"1.3", ",", "2", ",", "3.12", ",", "1.111", ",", "2"}], "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tf", "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tx", "=", 
     RowBox[{"cLeSliceFind", "[", 
      RowBox[{"x0", ",", "tf", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "A", " ", "check", " ", "to", " ", "make", " ", "sure", " ", "the", " ", 
     "trajectory", " ", "passes", " ", "through", " ", "a", " ", 
     "singularity", " ", "at", " ", "time", " ", 
     RowBox[{"tf", "/", "2."}], " ", "Both", " ", "values", " ", "should", 
     " ", "be", " ", "close", " ", "to", " ", "0."}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"traj", "=", 
     RowBox[{"cLetraj", "[", 
      RowBox[{"x0", ",", "tf"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xsing", "=", 
     RowBox[{"traj", "[", 
      RowBox[{"tf", "/", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"tx", ".", "xsing"}], "\[IndentingNewLine]", 
   RowBox[{"tx", ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xsing", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"xsing", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"xsing", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"xsing", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", "0"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Find", " ", "the", " ", "reduced", " ", "space", " ", "trajectory", " ", 
     "that", " ", "passes", " ", "through", " ", "the", " ", "singularity", 
     " ", "and", " ", "one", " ", "that", " ", "begins", " ", "at", " ", "a", 
     " ", "nearby", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice", "=", 
     RowBox[{"cLeRotSlice", "[", 
      RowBox[{"x0", ",", "tf", ",", "tx"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"slice2", "=", 
     RowBox[{"cLeRotSlice", "[", 
      RowBox[{
       RowBox[{"x0", "+", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0.1", ",", "0", ",", "0"}], "}"}]}], 
       ",", "tx", ",", "tx"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Calculate", " ", "the", " ", "group", " ", "orbit", " ", "the", " ", 
     "trajectory", " ", "will", " ", "be", " ", 
     RowBox[{"following", ".", " ", "May"}], " ", "have", " ", "to", " ", 
     "switch", " ", "which", " ", "half", " ", "of", " ", "the", " ", "group",
      " ", "orbit", " ", "is", " ", 
     RowBox[{"used", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sorbit", "=", 
     RowBox[{"singOrbit", "[", 
      RowBox[{"xsing", ",", "tx", ",", "tf"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Plots", " ", "the", " ", "three", " ", "trajectories"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ParametricPlot3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"slice", "[", 
           RowBox[{"s", "/", "2"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"slice", "[", 
           RowBox[{"s", "/", "2"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"slice", "[", 
           RowBox[{"s", "/", "2"}], "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"slice", "[", 
           RowBox[{
            RowBox[{"tf", "/", "2"}], "+", 
            RowBox[{"s", "/", "2"}]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"slice", "[", 
           RowBox[{
            RowBox[{"tf", "/", "2"}], "+", 
            RowBox[{"s", "/", "2"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"slice", "[", 
           RowBox[{
            RowBox[{"tf", "/", "2"}], "+", 
            RowBox[{"s", "/", "2"}]}], "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"slice2", "[", "s", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"slice2", "[", "s", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"slice2", "[", "s", "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"sorbit", "[", "s", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sorbit", "[", "s", "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sorbit", "[", "s", "]"}], "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "tf"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", "Blue", ",", "Red", ",", "Green"}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "y1", ",", "z"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfex0fetagVeOx07vmgKhbS+DaW+TexDa6gVE/BCU
vvsGQr+B0N6y4uvA9CJ1CJ2oD6GVHCC0pQuYPm3tB6G3xkLo3RDae0MRhP+9
BMLvrYfwuxshdMMCiPgeCH364gqo+Ssh/L0HIPRnCO1t9RFCL/sNEQ8XWg/m
B4mC6F2e9/8tFQLSJ1VFloFozzxpMH1yoyqE/mcJoT2sIbSMJ4R+5AWhHf0h
+rzAdIL3u1PLgXT4VaYzIBoAuf+zww==
  "]]
},
WindowSize->{615, 750},
WindowMargins->{{Automatic, 92}, {Automatic, 50}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 30985, 841, 2352, "Input"],
Cell[31533, 863, 6613, 172, 632, "Input"]
}
]
*)

(* End of internal cache information *)
