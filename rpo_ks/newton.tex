% newton.tex
% $Author$ $Date$


\section{Newton method  for \rpo\ searches}
\label{sec:NewtRPOs}
% Predrag           jun 20 2006
% Vaggelis          may 20 2006

Alternatively one can use Newton's shooting method with auxiliary conditions as in \refref{Visw07b}.
The relative periodic condition in Fourier space reads
\beq
    a_p=\mathbf{g}(\shift_p)  \flow{\period{p}}{a_p}
\,,
    \label{eq:RPOcond}
\eeq
with period $\period{p}$ and shift $\shift_p$.
% The Fourier transformation diagonalizes the rotation operator \ES{dropped: $\mathbf{g}(\shift_p)  a(t+\period{p})=a(t)$},
% \beq
%             \mathbf{g}_{jk}(\shift_p) = \delta_{jk} e^{i q_k\, \shift_p}\,,
%     \label{eq:RPO}
% \eeq
% so in Fourier modes representation the relative periodic condition
% \beq
%     e^{i q_k\, \shift_p}a_k(t+\period{p})=a_k(t)  % \forall k \in \mathds{Z}
%     \qquad \mbox{(no summation on $k$)}
%     \label{eq:RPOcondition}
% \eeq
% amounts to the $k$th mode complex plane rotation by an
% angle $-k\, \shift_p /\tildeL$.
% A \rpo\ returns after time $\period{}$ to a point in
% \statesp\ with components $a_k(t+\period{})$  with respect to $a_k(t)$.
% Starting with an initial guess $a$ for a point on a \rpo\ $p$
% we use Newton's method to find an improved approximation to $a_p$
% of condition  \refeq{eq:RPO}:

Let
$a$, $\period{}$ and $\shift$
be our guess cycle point, period, and shift, respectively.
Taylor expand $\mathbf{g}(\shift_p)  \flow{\period{p}}{a_p}$
around \ES{Corrected: We Taylor expand around guess point $a$ and not $a_p$ because this is what we know and we want to be able to write $J$ \etc\ in terms of known quantities. This makes $\delta a$ look awkward but there's no other way to do it.} $a$ to linear order in
$(\delta a,\delta \period{},\delta \shift)
   =(a_p-a,\period{p} - \period{},\shift_p-\shift)$:
\beq
    \left({1}-\jMps^{(\period{},\shift)}\right) \delta a
   - \mathbf{g}(\shift)v(f^{\period{}}(a)) \delta \period{}
                            - \mathbf{L}\mathbf{g}(\shift)\flow{\period{}}{a} \delta \shift
                    \,\simeq\, \mathbf{g}(\shift)\flow{\period{}}{a}-a\,,
    \label{eq:NewtonBasicCond}
\eeq
where $\jMps^{(\period{},\shift)}_{ij}
  = \mathbf{g}(\shift)\partial a_i(\period{})/\partial a_j(0)$
is the \rpo\ {\jacobianM}, and
$L_{kj}=i q_k \delta_{kj}$ is the Lie algebra translation
generator.
\PC{
    recheck - factor $i$ might be wrong. ES: checked, it's correct.
   }
The matrix $\jMps^{(\period{},\shift)}$
has two unit eigenvalues on the \rpo\ $p$,
one associated with the invariance along
the direction of the flow and the other with the
translational invariance of the system. Thus \refeq{eq:NewtonBasicCond}
needs to be augmented by two conditions to
eliminate the (close to) zero eigenvalues of
$\mathbf{1}-\jMps^{(\period{},\shift)}$. Following
\refref{Visw07b} we impose \ES{dropped: locally transverse sections}
conditions
\beq
    v(a)\cdot\delta a  =  0
    \,,\qquad
    \left(\mathbf{L} \mathbf{g}a\right)\cdot \delta a  =  0
\,.
\label{eq:NewtonAux}
\eeq
The requirement imposed by \refeq{eq:NewtonAux}
on the variations of the initial $\delta a$ of \refeq{eq:NewtonBasicCond}
is that they   vanish along the directions of the flow
and of infinitesimal translations.

Equations \refeq{eq:NewtonBasicCond} and \refeq{eq:NewtonAux}
can be stated compactly as a
$[N\!+\!2]\!\times\![N\!+\!2]$ matrix condition:
\beq
    \left( \begin{array}{ccc}
       {1}-\jMps^{(\period{},\shift)}    & -\mathbf{g}(\shift)v(f^{\period{}}(a))
                                        & -\mathbf{L}\mathbf{g}(\shift)f^{\period{}}(a)  \\
        v(a)^{\dagger}          & 0     & 0     \\
        (\mathbf{L}\mathbf{g}a)^\dagger    & 0     & 0
     \end{array}
     \right)
     \left(\begin{array}{c}
       \delta a \\
       \delta \period{} \\
       \delta \shift
     \end{array}\right)
     =
     \left(\begin{array}{c}
       \mathbf{g}(\shift)f^{\period{}}(a)-a \\
       0     \\
       0
     \end{array}\right)\,.
     \label{eq:NewtonScheme}
\eeq
where $v^\dagger$ denotes the adjoint of $v$.
