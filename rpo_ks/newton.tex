% newton.tex
% $Author$ $Date$


% \subsection{Newton method  for \rpo\ searches}
% \label{sec:NewtRPOs}
% Predrag           jun 20 2006
% Vaggelis          may 20 2006


The relative periodic condition is
\[
    u(x+\shift,t+\period{})=u(x,t)
        \,,
\]
or, in Fourier space
\beq
    a_p=\mathbf{g}(\shift_p)  \flow{\period{p}}{a_p}
\,,
    \label{eq:RPOcond}
\eeq
with period $\period{p}$ and shift $\shift_p$.
The Fourier transformation diagonalizes the rotation operator,
\beq
    \mathbf{g}(\shift)  a(t+\period{})=a(t)\,,\qquad
            \mathbf{g}_{jk}(d) = \delta_{jk} e^{ik\, \shift/\tildeL}\,,
    \label{eq:RPO}
\eeq
so in the Fourier representation the relative periodic condition
\beq
    e^{ik\, \shift /\tildeL}a_k(t+\period{})=a_k(t)  % \forall k \in \mathds{Z}
    \qquad \mbox{(no summation on $k$)}
    \label{eq:RPOcondition}
\eeq
amounts to the $k$th mode complex plane rotation by an
angle $-k\, d /\tildeL$.
% A \rpo\ returns after time $\period{}$ to a point in
% \statesp\ with components $a_k(t+\period{})$  with respect to $a_k(t)$.
% Starting with an initial guess $a$ for a point on a \rpo\ $p$
% we use Newton's method to find an improved approximation to $a_p$
% of condition  \refeq{eq:RPO}:

Let
$a$, $\period{}$ and $\shift$
be our guess cycle point, period, and shift, respectively.
Taylor expand $\mathbf{g}(\shift_p)  \flow{\period{p}}{a_p}$
around the desired \rpo\ $p$ to linear order in
$(\delta a,\delta \period{},\delta \shift)
   =(a-a_p,\period{} - \period{p},\shift-\shift_p)$:
\beq
    \left({1}-\jMps^{(\period{},\shift)}\right) \delta a
   - \mathbf{g}(\shift)v(f^{\period{}}(a)) \delta \period{}
                            - \mathbf{L}(\mathbf{g}(\shift)\flow{\period{}}{a})\delta \shift
                    \,\simeq\, \mathbf{g}(\shift)\flow{\period{}}{a}-a\,,
    \label{eq:NewtonBasicCond}
\eeq
where $\jMps^{(\period{},\shift)}_{ij}
  = \mathbf{g}(\shift)\partial a_i(\period{})/\partial a_j(0)$
is the \rpo\ {\jacobianM}, and
$L_{kj}=\frac{ik}{\tildeL}\delta_{kj}$ is the Lie algebra translation
generator.
\PC{
    recheck - factor $i$ might be wrong
   }
The matrix $\jMps^{(\period{},\shift)}$
has two unit eigenvalues on the \rpo\ $p$,
one associated with the invariance along
the direction of the flow and the other with the
translational invariance of the system. Thus \refeq{eq:NewtonBasicCond}
needs to be augmented by two conditions to
eliminate the (close to) zero eigenvalues of
$\mathbf{1}-\jMps^{(\period{},\shift)}$. Following
\refref{Visw07b} we impose locally transverse sections
conditions
\bea
    v(a)\cdot\delta a & = & 0 \label{eq:NewtonAux1} \,\\
    \mathbf{L}(\mathbf{g}a)\cdot \delta a & = & 0
\,.
\label{eq:NewtonAux2}
\eea
The requirement imposed by \refeqs{eq:NewtonAux1}{eq:NewtonAux2}
on the variations of the initial $\delta a$ of \refeq{eq:NewtonBasicCond}
is that they   vanish along the directions of the flow
and of infinitesimal translations.

Equations \refeq{eq:NewtonBasicCond} and \refeqs{eq:NewtonAux1}{eq:NewtonAux2}
can be stated compactly as a
$[N\!+\!2]\!\times\![N\!+\!2]$ matrix condition:
\beq
    \left( \begin{array}{ccc}
       {1}-\jMps^{(\period{},\shift)}    & -\mathbf{g}(d)v(f^{\period{}}(a))
                                        & -\mathbf{L}(\mathbf{g}(\shift)f^{\period{}}(a))  \\
        v(a)^{\dagger}          & 0     & 0     \\
        (\mathbf{L}\mathbf{g}a)^\dagger    & 0     & 0
     \end{array}
     \right)
     \left(\begin{array}{c}
       \delta a \\
       \delta \period{} \\
       \delta \shift
     \end{array}\right)
     =
     \left(\begin{array}{c}
       \mathbf{g}(d)f^{\period{}}(a)-a \\
       0     \\
       0
     \end{array}\right)\,.
     \label{eq:NewtonScheme}
\eeq
where $v^\dagger$ denotes the adjoint of $v$.
\PC{Ruslan, explain you do not use Newton at all}
