% fourierRLD.tex
% $Author$ $Date$

\section{Solving \KSe\ numerically}
\label{sec:fourierRLD}
% Predrag               jun 20 2006


The \KSe\ in terms of Fourier modes:
\beq
  \hat{u}_k = {\cal F}[u]_k = \frac{1}{L}\int_0^L u(x,t) e^{-i q_kx}dx\,,
  \qquad u(x,t) = {\cal F}^{-1}[\hat{u}] = \sum_{k\in{\mathbb Z}} \hat{u}_k e^{i q_k x}
\eeq
 is given by
\beq
  \dot{\hat{u}}_k = (q_k^2-q_k^4) \hat{u}_k -
  \frac{i q_k}{2}{\cal F}[({\cal F}^{-1}[\hat{u}])^2]_k\,.
\eeq
Since $u$ is real, the Fourier modes are related by $\hat{u}_{-k} =
\hat{u}^\ast_k$.

The above system is truncated as follows: The Fourier transform
${\cal F}$ is replaced by its discrete equivalent
\beq
  a_k = {\cal F}_N[u]_k = \sum_{n = 0}^{N-1} u(x_n)
  e^{-i q_k x_n}\,,\qquad u(x_n) = {\cal F}_N^{-1}[a]_n
  = \frac{1}{N}\sum_{k = 0}^{N-1} a_k e^{i q_k x_n}\,,
\eeq
where $x_n = 2\pi\tildeL/N$ and $a_{N-k} = a^\ast_k$.  Since $a_0
= 0$ due to galilean invariance and setting $a_{N/2} = 0$ (assuming
$N$ is even), the number of independent variables in the truncated
system is $N-2$.  The truncated system looks as follows:
\beq
  \dot{a}_k = \pVeloc_k(a) = [q_k^2-q_k^4]a_k -
  \frac{i q_k}{2}{\cal F}_N[({\cal F}_N^{-1}[a])^2]_k\,.
\ee{eq:KS}

where $k = 1,\ldots,N/2-1$.  Note that, since $a_k \in \mathbb{C}$,
\refeq{eq:KS} represents a system or ordinary differential equations in
${\mathbb R}^{N-2}$.
%, although in the Fourier transform we need
%to use $a_k$ over the full range of $k$ values from 0 to $N-1$.
The discrete Fourier transform ${\cal F}_N$ can be computed by FFT.
In Fortran and C, the FFTW library \refref{FFTW05} can be used.
% In Matlab, it is more convenient to use complex
% variables for $a_k$.  Note that Matlab function {\tt fft} is, in
% fact, the inverse Fourier Transform.

In order to find the Jacobian of the solution, or compute Lyapunov
exponents of the \KSe , one needs to solve the equation for a
displacement vector $b$ in the tangent space: \beq
  \dot{b} = \frac{\partial \pVeloc(a)}{\partial a} b\,.
\eeq
Since ${\cal F}_N$ is a linear operator, it is easy to show that
\beq
  \dot{b_k} = [q_k^2-q_k^4]b_k -
  iq_k{\cal F}_N[{\cal F}_N^{-1}[a]\cdot
  {\cal F}_N^{-1}[b]]\,,
\ee{eq:KStan}
where the dot indicates componentwise product of two vectors, \ie,
$a\cdot b = \diag(a)\,b = \diag(b)\,a$.  This
equation needs to be solved simultaneously with \refeq{eq:KS}.

When evaluating the Jacobian of the KS flow map, $J(a,t) = \partial
f^t(a)/\partial a$, the partial derivatives need to be evaluated
separately with respect to the real and imaginary parts of the
components of complex-valued vector $a$.  Therefore, the initial
conditions for \refeq{eq:KStan} that yield the partial derivative of
$f^t(a)$ with respect to Re $a_k$ and Im $a_k$, are $b_j(0) = 1 +
0i$ and $b_j(0) = 0 + 1i$, respectively, for $j = k$ and $b_j(0) =
0$ otherwise.
