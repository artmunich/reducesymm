\renewcommand{\inputfile}{\version\ - edited 2007-03-11 symODEs}
% section: Symmetries of dynamical systems
% $Author$ $Date$

\subsection{Definition of symmetry}

We consider a system of \ode's of the form
\beq
	\dot{x} = \vf(x,\lambda)
	\label{eq:difeq}
\eeq
where $\vf: \Rls{n}\times\Rls{r}$ a $C^\infty$ mapping. When
not important we will suppress the $r$-dimensional vector of parameters
$\lambda$ in the notation.

As is well known any compact Lie group acting on $\Rls{n}$ can be identified
with a subgroup of $\On{n}$, \cf\ for example \refref{golubII}
for a sketch of the proof. Therefore, without loss of generality
we will concentrate on subgroups $\Gamma\subseteq\On{n}$ in the following.

\begin{definition}
\label{def:symmetry}
\index{symmetry}
We call a group element $\gamma\in\On{n}$ a symmetry of \refeq{eq:difeq} if for every solution
$x(t)$, $\gamma x(t)$ is also a solution.
\end{definition}

The question now arises on how to check for symmetries of \refeq{eq:difeq} since
we generally do not have knowledge of the set of all solutions. Let $x(t)$ be a solution
of \ref{eq:difeq}. Then by \refDef{def:symmetry} $y(t)=\gamma x(t)$ is another solution 
and therefore satisfies \refneq{eq:difeq}:
\[
 \dot{y}(t)=\vf{y(t)}=\vf(\gamma x(t))\,.
\]
On the other hand
\[
 \dot{y}(t)=\gamma \dot{x} = \gamma \vf(x(t))\,,
\]
for any solution $x(t)$. Since solutions exist for any $x\in\Rls{n}$ we are led to the following 
condition for $\gamma$ to be a symmetry of \refeq{eq:difeq}:
\beq
	\vf(\gamma x) =\gamma \vf(x)
	\label{eq:equiv}
\eeq
for all $x\in\Rls{n}$. We say that $\vf$ \emph{commutes} with $\gamma$ or that $\vf$ is $\gamma$-\emph{equivariant}.
When $\vf$ commutes with all $\gamma\in\Gamma$ we say that $\vf$ is $\Gamma$-equivariant\index{equivariant}.
% When $f$ is $\gamma$-equivariant
% the \ode~ \ref{eq:difeq} remains invariant under the action of $\gamma$.

Clearly the finite time flow $\flow{t}{\gamma x_o}$ through $\gamma x_o$ 
satisfies the equivariance condition $\flow{t}{\gamma x_o}=\gamma \flow{t}{x_o}$ from 
the definition of symmetry and uniqueness of solutions.


\index{Lorenz equations!symmetry}For example, the vector field in Lorenz equations  \refneq{eq:lorenz} is equivariant under the group
$\Zn{2}\cong\Dn{1}$ acting on \Rls{3} by
\[
	\Rot{\pi}(x,y,z) = (-x,-y,z)\,.
\]
Notice that this transformation can be considered as either as rotation by $\pi$ around the $z$ axis (hence the
group \Zn{2}) or as a reflection about the origin in a plane perpendicular to the $z$-axis (hence the group \Dn{1}).

\index{Complex Lorenz equations!symmetry}As another example, the vector field in \CLe~ \refneq{eq:CLe} is equivariant under the group \SOn{2} acting on $\Rls{5}\cong \Clx{2}\times \Rls{}$
by
\beq
 \Rot{\theta} (x,y,z) = (e^{i\theta} x, e^{i\theta} y, z)\,,\ \ \  \theta\in[0,2\pi)\,.
 \label{eq:RotCLe}
\eeq

\index{Armbruster-Guckenheimer-Holmes flow!symmetry}Finally, the symmetry group of the \AGHe~\refneq{eq:AGH} is \On{2} acting by
\begin{eqnarray*}
  \Rot{\theta}(z_1,z_2) &=& (e^{i\theta} z_1, e^{i 2\theta} z_2)\,,\ \ \  \theta\in[0,2\pi)\,,\\
  \Refl(z_1,z_2) &=& (\conj{z}_1,\conj{z}_2)\,.
\end{eqnarray*}


\subsection{Phase space stratification}

In order to understand the implications of equivariance for the solutions
of \refeq{eq:difeq} we first have to closely examine the way a compact 
Lie group acts on \Rls{n}.

\index{group orbit} The \emph{group orbit} of $x\in\Rls{n}$ is the set
\beq
	\Gamma x = \{\gamma x: \gamma\in\Gamma\}\,.
\eeq

\index{isotropy subgroup}\index{stabilizer} Define the \emph{isotropy subgroup} or \emph{stabilizer} of $x\in\Rls{n}$ as
\beq
	\stab{x}=\{\gamma\in\Gamma:\gamma x=x\}\,.
\eeq
Thus the isotropy subgroup describes the symmetries of a point $x$. The following usefull lemma
relates the isotropy subgroups of points on the same group orbit.

\begin{lemma}
\label{lm:stabGorbit}
Points on the same group orbit of $\Gamma$ have conjugate isotropy subgroups:
\beq
	\stab{\gamma x}=\gamma \stab{x} \gamma^{-1}\,.
\eeq
\end{lemma}
See \refref{golubII} for the proof.

\refLem{lm:stabGorbit} implies that we can characterize a group orbit by its \emph{type}, defined
as the conjugacy class of its isotropy subgroups.

\begin{proposition}
 Let $\Gamma$ be a compact Lie group acting on \Rls{n}. Then
 \begin{enumerate}
  \item If $\Gamma$ is finite then $|\Gamma|=|\stab{x}||\Gamma x|$.
  \item If $\Gamma$ is continuous then $\dim \Gamma = \dim \stab{x}+\dim \Gamma x$.
 \end{enumerate}
\end{proposition}
The proof can be found in \refref{golubII}. We note a usefull relation from the proof: $\dim\Gamma x =\dim(\Gamma/\stab{x})$, where the \emph{coset space} of a subgroup $\Sigma$  of $\Gamma$ is defined as $\Gamma/\Sigma=\{\gamma\Sigma|\gamma\in\Gamma\}$. Also recall that the (left) \emph{cosets} of $\Sigma$ in $\Gamma$ are the sets $\gamma\Sigma=\{\gamma\sigma|\sigma\in\Sigma\}$.

\index{stratum} 
Therefore, when $\Gamma$ is continuous each group orbit is a smooth compact manifold of dimension
$\dim \Gamma x=\dim \Gamma-\dim \stab{x}$. The union of orbits of the same type is called a \emph{stratum}
and is itself a smooth manifold. Thus \Rls{n} is stratified by the action of $\Gamma$ into
a disjoint union of strata which are in an $1-1$ correspondance to the group orbit types. Notice that in general
the strata do not have the same dimension.

As an example we will consider \Dn{3}, the symmetry group of the equilateral triangle \reffig{fig:D3triangle}, acting on $\Rls{2}\cong\Clx{}$ by
\begin{eqnarray*}
  \Drot z &=& e^{i\frac{2\pi}{3}} z\,,\\
  \Refl z  &=& \conj{z}\,.
\end{eqnarray*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
    % \vspace*{-5pt}
\begin{center}
		\includegraphics[width=0.25\textwidth]{figs/D3triangle}
\end{center}
\caption[D3 symmetry illustration.]{
    {\small
    \Dn{3} leaves the equilateral triangle setwise fixed. The reflection symmetry axes have been denoted $I_i$.}}
\label{fig:D3triangle}
    \vspace*{-5pt}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% The subgroups are $\Idg=\{e\}$, $\Zn{2}(\Refl)$ and which is isomorfic to the subs $\Zn{2}$ generated by.
% We observe that points on reflection symmetry axis $I_1$ are in the fixed point subspace of 


% The notion of equivariance is related to the symmetries of the \ode\ \refeq{eq:difeq}. We will also
% be interested on the symmetries of solutions.

\subsection{Moving frames}

In this section we present the method of moving coframes of Fels and Olver\cite{FelsOlver98,FelsOlver99}, also \cf~\refref{OlverInv} for
a pedagogical exposition. The method can be used to generate functionally independent fundamentall invariants for the action
of a group $\Gamma$ on a space $V$ under certain conditions. The method draws inspiration from the method of moving frames of 
Cartan\ES{cite Cartan}. Here we follow \refref{OlverInv} but first motivate the method through an
example.

Consider $\Sigma=\SOn{2}$ acting on $\Rls{5}$ by
\beq
	x \mapsto  \Rot{\theta}x\,,
	\label{eq:SO2act}
\eeq
where
\beq
	\Rot{\theta}=	\left(\barr{ccccc}
				\cos(\theta) & -\sin(\theta) & 0	   & 0		    & 0\\
				\sin(\theta) & \cos(\theta)  & 0	   & 0		    & 0\\		
				0	     & 	0	     & \cos(\theta) & -\sin(\theta) & 0\\
				0	     &  0	     & \sin(\theta) & \cos(\theta) & 0\\
				0	     &  0	     & 0	    & 0		   & 1\\	
			\earr\right)\,,\ \ \theta\in[0,2\pi)\,.
\eeq
Notice that this is the same action as in \refeq{eq:RotCLe} but now we don't make the identification 
$\Rls{5}\cong \Clx{2}\times \Rls{}$. Thus the following have direct application in symmetry reduction
of \CLe. Choose coordinates $x_1,x_2,y_1,y_2,z$ on $\Rls{5}$. Notice that the fixed point subspace
of the action of $\SOn{2}$ defined above is the $z$-axis. The isotropy subgroup of the $z$-axis is thus
$\SOn{2}$, while the isotropy subgroup of $V_R\equiv\Rls{5}\backslash\{x_1=x_2=y_1=y_2=0\}$ is the identity element. 

\begin{definition}
\label{def:free}
\index{free}
A group $\Gamma$ acts freely on $V$ if all isotropy subgroups are trivial: \stab{x}=\{e\} for all $x\in V$. 
$\Gamma$ acts locally freely if all isotropy subgroups are discrete subgroups of $\Gamma$.
\end{definition}

Thus $\Sigma$ does not act freely on $\Rls{5}$ but acts freely on $V_R$. If we don't 
restrict $\theta$ in $[0,2\pi)$ then the group $\Rls{}$ acts locally freely on $V_R$
since the isotropy subgroup is the discrete subgroup $2\pi\mathbb{Z}$ of integer multiples of $2\pi$.

\begin{definition}
\label{def:faithfull}
\index{faithfull}
A group $\Gamma$ acts faithfully (or effectively) on $V$ if it has trivial global isotropy subgroup.
\end{definition}
\ES{define global isotropy subgroup}

\begin{definition}
\label{def:regular}
\index{regular}\index{semi-regular}
A group $\Gamma$ acts semi-regularly on $V$ if all its orbits have the same dimension. If in addition for each point $x\in V$
there exists an arbitrarily small neigborhood $U$ such that each orbit of $\Gamma$ intersects $U$ in a pathwise connected subset, then the group
acts regurarly.
\end{definition}
\ES{Think of regular versus semi-regular action as the group orbits being circles versus filling a 2-torus. I'll try to find a specific example of semiregular action.}

Thus $\Sigma=\SOn{2}$ acts regurarly on $V_R$ but not on $\Rls{5}$. For groups acting regularly we can define a cross-section for the group orbits. 

\begin{definition}
\label{def:cross-section}
\index{cross-section}
Let $\Gamma$ act regularly on a $n$-dimensional manifold $V$ with $r$-dimensional orbits. Define a (local) \emph{cross-section}
to be an $(m-r)$-dimensional submanifold $K$ of $V$ such that $K$ intersects each orbit transversally and at most once.
\end{definition}

\begin{proposition}[\cite{OlverInv}]
 If a Lie group $\Gamma$ acts regularly on a manifold $V$, then one can construct a local cross-section  
 passing through any point $x\in V$.
\end{proposition}

A cross-section $K$ can be defined by means of level sets of functions $K_i(x)=c_i$, where $x\in V$ and $i=1,\ldots,r$. If the $K_i(x)$
coincide with the local coordinates $x_i$ on the manifold $V$, \ie~$K_i(x)=x_i$, then we call $K$ a \emph{coordinate cross
section}. In our example we can define a coordinate cross-section for the action of $\Sigma=\SOn{2}$ on $\Rls{5}\backslash\{x_1=x_2=y_1=y_2=0\}$  by, for instance, $x_1=0$. 

We can now construct a moving frame for the action \refneq{eq:SO2act} of $SO(2)$ as follows. We write out explicitly the
group transformations:
\beq
\begin{split}
 	\overline{x}_1 &= x_1 \cos\theta - x_2 \sin\theta\cont
	\overline{x}_2 &= x_1 \sin\theta + x_2 \cos\theta\cont 
	\overline{y}_1 &= y_1 \cos\theta - y_2 \sin\theta\cont
	\overline{y}_2 &= y_1 \sin\theta + y_2 \cos\theta\cont	
	\overline{z} &= z\,.
	\label{eq:CLEexplSO2}
\end{split}
\eeq
Then make $\overline{x}$ equal to the constant in the choice of cross-section, \ie~set $\overline{x}=0$. Thus, we can solve
the first of \refeq{eq:CLEexplSO2} for the group parameter $\theta$ and substitute in the remaining equations. We get
\beq
\begin{split}
	\theta &= 2 \tan^{-1}\frac{-x_2+\sqrt{x_1^2+x_2^2}}{x_1} \cont
	\overline{x}_2 &= \sqrt{x_1^2+x_2^2} \cont
	\overline{y}_1 &= \frac{x_2 y_1-x_1 y_2}{\sqrt{x_1^2+x_2^2}}\cont
	\overline{y}_2 &=\frac{x_1 y_1+x_2 y_2}{\sqrt{x_1^2+x_2^2}}\,.
\end{split}
\eeq
\ES{The solution $\theta = 2 \tan^{-1}\frac{-x_2+\sqrt{x_1^2+x_2^2}}{x_1}$ was returned by Mathematica. If we use 
$\theta = \arctan\frac{x_2}{x_1}$ our results are multiplied by $sgn(x_2)$.} We notice that $\overline{x}_2,\overline{y}_1,
\overline{y}_2,\overline{z}$ are $SO(2)$
invariant. In fact they are the \emph{fundamental invariants} for our problem: any other invariant can be expressed
as a function of $\overline{x}_2,\overline{y}_1, \overline{y}_2,\overline{z}$ and they are functionally independent.
Thus they serve to distinguish orbits in the neighborhood of the cross-section, \ie~two points lie on the same group
orbit if and only if all the fundamental invariants agree.

 The \emph{normalization} procedure for the computation of invariants applied in the example of $SO(2)$ can be applied
in much more general situations as follows. Assume $\Gamma$ acts (locally) freely on X and
thus $\Gamma$-orbits have the same dimension as $\Gamma$, say $r$. Choose a coordinate cross-section $K=\{x_1=c_1,\ldots,x_r=c_r\}$. 
defined by the first $r$ coordinates (relabel coordinates as necessary.) Introduce local coordinates $g=(g_1,\ldots,g_r)$ on $\Gamma$ in
the neighborhood of the identity. Write out explicitly the group transformations:
\beq
	\overline{x}= g.x = w(g,x)\,.
	\label{eq:transNorm}
\eeq
Equating the first $r$ components of the function $w$ to the constants in the definition of the cross-section $K_i(x)=c_i$ yields the \emph{normalization equations} for $K$:
\beq
	\overline{x}_1=w_1(g,x)=c_1,\ldots,\overline{x}_r=w_r(g,x)=c_r\,.
	\label{eq:normalization}
\eeq
From the definition of cross-section and the Implicit Function Theorem the normalization equations \refneq{eq:normalization} can always be solved for the group parameters in terms of $x$, yielding the \emph{moving frame} associated with $K$: $g=\gamma(x)$. Substitution
of the moving frame equation back to \refeq{eq:transNorm} will yield the $n-r$ fundamental invariants. For proof \cf~\refrefs{FelsOlver98,FelsOlver99}.

The power of the method shows in the calculation of invariants for groups acting on a high-dimensional space. For example the
task of computing invariants for the standard action of $\SOn{2}$ on $\Clx{n}\cong\Rls{2n}$ defined by
\beq
	\left(\barr{cc} \overline{b}_k \\ \overline{c}_k\earr \right)=\left(\barr{cc}
			    			\cos(k\theta) & -\sin(k\theta)\\
						\sin(k\theta) & \cos(k\theta)\\
			   			\earr\\	
						\right) \left(\barr{cc} b_k \\ c_k\earr\right)\,,\ \ k=1,\ldots n\,.
	\label{eq:SO2stand}
\eeq
with $b_k,c_k\in\Rls{}$. The Gr\"{o}bner basis methods usually perform poorly as $n$ becomes larger than six\ES{I need to quote
the literature or try it to fully justify this.}. On a 1GHz Pentium III processor the fundamental invariants for $n=16$, for the cross 
section $b_1=0$, were computed in approximatelly 130s. Most importantly the time was mostly 
spend in simplification of expressions. If one only wants to project equivariant dynamics on the orbit space then the moving frame method,
through its geometric interpretation, can be used to perform the projection without explicit knowledge of the fundamental invariants. 
This idea will become clear in the example of orbit space projection
for \CLe\ES{refer to appropriate section when written.}. The fundamental invariants for \SOn{2} acting as in \refeq{eq:SO2stand} with
$n=6$ calculated with the method of moving frames are listed in \reftab{tab:SO2n6}. Notice another advantage of the method: no syzygies are present\ES{Well, I don't think one can notice it, but it is proved, so we are happy.}.

\begin{table}
\label{tab:SO2n6}
\[
\begin{array}{ll}
  \sqrt{b_1^2+c_1^2} & \\
 \frac{-b_1^2 b_2+b_2 c_1^2-2 b_1 c_1 c_2}{b_1^2+c_1^2} & \frac{2 b_1 b_2 c_1-b_1^2 c_2+c_1^2 c_2}{b_1^2+c_1^2} \\
 \frac{-3 b_1^2 b_3 c_1+b_3 c_1^3+b_1^3 c_3-3 b_1 c_1^2 c_3}{\left(b_1^2+c_1^2\right){}^{3/2}} & \frac{-b_1^3 b_3+3 b_1 b_3 c_1^2-3 b_1^2 c_1 c_3+c_1^3
c_3}{\left(b_1^2+c_1^2\right){}^{3/2}} \\
 \frac{b_4 \left(b_1^4-6 b_1^2 c_1^2+c_1^4\right)+4 b_1 c_1 \left(b_1^2-c_1^2\right) c_4}{\left(b_1^2+c_1^2\right){}^2} & \frac{4 b_1 b_4 c_1 \left(-b_1^2+c_1^2\right)+\left(b_1^4-6
b_1^2 c_1^2+c_1^4\right) c_4}{\left(b_1^2+c_1^2\right){}^2} \\
 \frac{b_5 c_1 \left(5 b_1^4-10 b_1^2 c_1^2+c_1^4\right)-b_1 \left(b_1^4-10 b_1^2 c_1^2+5 c_1^4\right) c_5}{\left(b_1^2+c_1^2\right){}^{5/2}} & \frac{b_1
b_5 \left(b_1^4-10 b_1^2 c_1^2+5 c_1^4\right)+c_1 \left(5 b_1^4-10 b_1^2 c_1^2+c_1^4\right) c_5}{\left(b_1^2+c_1^2\right){}^{5/2}} \\
 \frac{b_6 \left(-b_1^6+15 b_1^4 c_1^2-15 b_1^2 c_1^4+c_1^6\right)-2 b_1 c_1 \left(3 b_1^4-10 b_1^2 c_1^2+3 c_1^4\right) c_6}{\left(b_1^2+c_1^2\right){}^3}
& \frac{2 b_1 b_6 c_1 \left(3 b_1^4-10 b_1^2 c_1^2+3 c_1^4\right)+\left(-b_1^6+15 b_1^4 c_1^2-15 b_1^2 c_1^4+c_1^6\right) c_6}{\left(b_1^2+c_1^2\right){}^3}
\end{array}
\]
\caption[Fundametal invariants for SO(2), n=6.]{Fundamental invariants for the standard action of \SOn{2} on \Rls{6}}
\end{table}


\input{chapters/lasersSym}