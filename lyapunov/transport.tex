\ifsvnmulti
 \svnkwsave{$RepoFile: lyapunov/transport.tex $}
 \svnidlong {$HeadURL$}
 {$LastChangedDate$}
 {$LastChangedRevision$} {$LastChangedBy$}
 \svnid{$Id$}
\fi

\section{Transport of vector fields}
\label{sect:transport}
%
% An extract from  ChaosBook.org {appendApplic.tex}, Appendix
% PC Lyapunov vectors setting up?      	20sep2009
% \section{\EvOper\ for Lyapunov exponents}
% \label{c-vatt-det}
\renewcommand{\ssp}{x}

For higher-dimensional flows only the \jacobianMs\ are
multiplicative, not individual eigenvalues, and the
 evaluation of Lyapunov spectra
requires the extension of evolution equations
to the flow in the tangent space.
The text that follows is clipped from \refref{Vattay}
and the ChaosBook Appendix
\HREF{http://chaosbook.org/chapters/appendApplic.pdf}
     {Transport of vector fields}.
(Probably should also
credit also Lazutkin, I vaguely remember a similar
construction in his work, except that at the moment
I cannot find a reference).
First one determines a periodic orbit, by any scheme.
Once one has it, determine the Lyapunov {\em unit}
vectors by the tangent space eigenvalue
condition, with flow forced by
the (already known) periodic solution. To make it a workable scheme we
need to reformulate this, and instead of computing Floquet
multiplier, evaluate the Floquet exponent along each such
tangent eigen-direction. Should be doable, as it is a 1-dimensional
integration. Failing this, we need to learn how other people compute
Lyapunov vectors...

The key idea is to extend the dynamical system by
the tangent space of the flow,
suggested by the standard numerical methods for evaluation of
Lyapunov exponents:      %\rf{BGS80}:
start at $\xInit$ with
an initial infinitesimal tangent space vector in the
$d$-dimensional tangent space
$\eta(0) \in T\pS_{\ssp}$,
and let the flow transport it  along the
trajectory $\ssp(t)= f^t(\xInit)$.

The dynamics in the tangent bundle
$(\ssp,\deltaX) \in  {\bf T}\pS$
is governed by the system of equations of variations:
% \refeq{die}:
%\rf{arnold92}:
	\PC{fix notation: ${\bf(T)}\pS$?}
\[
\dot{\ssp}=\vel(\ssp) \,, \quad
\dot{\eta}=\Mvar(\ssp) \, \eta\, .
%\label{die}
\]
Here $\Mvar(\ssp)$ is % \refeq{DerMatrix},
the {\stabmat} (\velgradmat) of the flow.
We write the solution as
\beq
x(t)=f^t(\xInit) \,, \quad
 % {\bf \eta}(\xInit,\eta_0,t)
\eta(t)=\jMps^t(\xInit) \, \eta_0 \, ,
\ee{xit}
with the tangent space vector $\eta$ transported by
the {\jacobianM} $\jMps^t(\xInit) = \partial \ssp(t)/ \partial \xInit$.
% \refeq{hOdes}.

% As explained in \refsect{s_lin_stab},
The growth rate of this vector is multiplicative along the trajectory
and can be represented as $\eta(t)=|{\eta}(t)|/|{\eta}(0)| \, u(t)$
where $ u(t)$ is a ``unit'' vector in some norm $||.||$.
For asymptotic times and for almost every initial $(\xInit,\eta(0))$,
this factor converges to the leading eigenvalue of the
linearized stability matrix of the flow.

We implement this multiplicative evaluation
of Floquet multipliers by adjoining
the $d$-dimensional transverse tangent space
$\eta \in {\bf T} \pS_x$; $\eta(\ssp) \cdot \vel(\ssp)=0$
to the ($d$+1)-dimensional dynamical evolution
space $x\in \pS \subset \reals^{d+1}$.
	\PC{this looks wrong: $ \vel(\ssp)$ is not normal
            to other eigenvectors. Keep the marginal direction?}
In order to determine the length of the vector $\eta$
we introduce a homogeneous
differentiable scalar function $g(\eta)=||\eta||$.
It has  the property $g(\Lambda \eta)=|\Lambda | \, g(\eta)$
for any $\Lambda $.
An example is the projection of a vector to its $d$th component
\[  %\begin{equation}
 g \left( \begin{array}{c}
	\eta_1 \\
	\eta_2 \\
	\cdots \\
	\eta_d
\end{array} \right)= |\eta_d| \,.
%\label{proj_norm}
\] %\end{equation}

Any vector $\eta(0) \in T\pS_{\ssp}$ can now be represented by the product
$
\eta=\Lambda {u}
$,
where $ {u}$ is a ``unit'' vector in the sense that its
norm is $||{u}||=1$, and the factor
\begin{equation}
\Lambda^t(x_0,{u}_0)=g(\eta(t)) = g(\jMps^t(x_0) {u}_0)
\label{lamb_def}
\end{equation}
is the multiplicative ``stretching'' factor.

Unlike the leading eigenvalue of the \jacobianM, the stretching factor is
multiplicative along the trajectory:
\[
\ExpaEig^{t'+t}(x_0,{u}_0)=\ExpaEig^{t'}(x(t),{u}(t))
				\, \ExpaEig^t(x_0,{u}_0).
\]
The ${u}$ evolution constrained to $E {\bf T}_{g,x}$, the space of unit transverse
tangent vectors,
is given by rescaling of  \refeq{xit}:
\begin{equation}
%{u}(x_0, {u}_0, t)
{u}'
=R^t(x,{u})=
\frac{1}{\ExpaEig^t(\ssp,{u})} \jMps^t(\ssp) {u} \, .
%{u}(x(t))\in E {\bf T}_{g,x }
\label{R}
\end{equation}

We note  next that if the trajectory $f^t(x)$ is periodic with
period $T$, the tangent space contains $d$ periodic solutions
\[
\jEigvec[i](x(T+t))=\jEigvec[i](x(t)) \,, \quad i=1,...,d ,
\]
corresponding to the $d$ unit eigenvectors $\{\jEigvec[1],
\jEigvec[2], \cdots, \jEigvec[d]\}$ of the transverse stability
matrix, with ``stretching'' factors (\ref{lamb_def})  given by
its eigenvalues
\[
\monodromy_p(x) \jEigvec[i](x) = \ExpaEig_{p,i} \, \jEigvec[i](x)
\,, \quad i=1,...,d.
\qquad \mbox{(no summation on $i$)}
\]

\noindent{\bf Predrag} what follows was developed for evaluation
of spectral determinants on the extended, tangent bundle space. Not
sure we need it, but we might... (need stability eigenvalues
to solve Newton equations for eigendirections?)

In order to
compute the stability of the $i$th eigen-direction solution, it
is convenient to expand the variation around the eigenvector
$\jEigvec[i]$ in the stability matrix\ eigenbasis
$
\delta {u} = \sum \delta u_\ell \, \jEigvec[\ell]
\, .
$
The variation of the map (\ref{R}) at a complete period $t=T$
is then given by
\begin{eqnarray}
\delta R^T (\jEigvec[i])  &=&
\frac{\monodromy \delta{u}}{g(\monodromy \jEigvec[i])}
-\frac{\monodromy \jEigvec[i] }{g(\monodromy \jEigvec[i])^2}
\left(
 \frac{\partial g(\jEigvec[i])}{\partial {u}}
	 \monodromy  \delta{u}
\right)
			\nonumber \\
	&=&
\sum_{k \neq i} \frac{\ExpaEig_{p,k} }{ \ExpaEig_{p,i }}
 \left( \jEigvec[k] -\jEigvec[i]
       \frac{\partial g(\jEigvec[i])}{\partial u_k}\right)\delta u_k
\, .
\label{var_R}
\end{eqnarray}
The $\delta u_i$ component does not contribute to this sum
since $g(\jEigvec[i]+du_i\jEigvec[i])=1+du_i$ implies $\partial
g(\jEigvec[i]) / \partial u_i = 1$. Indeed, infinitesimal
variations $\delta{u}$ must satisfy
\[
g({u}+\delta{u})=g({u})=1 \quad \Longrightarrow \quad
\sum_{\ell=1}^d \delta u_\ell
	  \frac{ \partial g({u})}{\partial u_\ell} = 0
\,,
%\label{constra}
\]
so the allowed variations are of form
\beq
\delta {u} = \sum_{k\neq i}
		\left( \jEigvec[k] -\jEigvec[i]
              \frac{\partial g(\jEigvec[i])}{\partial u_k}\right)c_k
    \,, \quad |c_k| \ll 1
\, ,
\ee{eigvNormalz}
and in the neighborhood of the $\jEigvec[i]$ eigenvector
the $\int d{u}$ integral can be expressed as
\[
\int_g d{u} = \int \prod_{k\neq i} dc_k
\, .
\]
%
%The integral over ${u}$ is restricted to
%$ET_{g,x}$, the space of unit tangent vectors
%transverse to the ($d$+1)-dimensional flow,
%is ($d$-1)-dimensional. For example, if the norm is such that
%the Euclidean length of $ {u}$ is 1,
%this space is a ($d$-1)-dimensional unit hemisphere,
%and if the norm is given by (\ref{proj_norm}), $ET_{g,x}$
%is the ($d$-1)-dimensional hyperplane fixed by condition $\eta_d=1$.
Inserting these variations into the $\int d{u}$ integral we obtain
\begin{eqnarray}
\int_g d{u}\, &&
\prpgtr{ \jEigvec[i]+\delta{u} -R^{T}(\jEigvec[i])
				-\delta R^T(\jEigvec[i]) + \dots}
	\nonumber \\
= \, && \int \prod_{k\neq i} dc_k \,
	\prpgtr{(1-\ExpaEig_{k}/\ExpaEig_{i}) c_k + \dots }
	\nonumber \\
	&&= \prod_{k\neq i} \frac{ 1}{ \left| 1-
			{\ExpaEig_{k} / \ExpaEig_{i } }\right|}
\, .
\nonumber
\end{eqnarray}
Ershov and Potapov\rf{ErshPot98} use the more customary
$\jEigvecT[j] \cdot \jEigvec[j] =1$ norm. That replaces
\refeq{eigvNormalz} by a more familiar looking formula
\beq
\delta \jEigvec[j] = \sum_{k\neq j}
		\frac{\jEigvecT[k] \cdot \delta {\bf M} \, \jEigvec[j]}
              {\alpha^{(k)} - \alpha^{(j)}}
       \jEigvec[k]
\, ,
\ee{eigvNormalzEP}
${\bf M} = \jMps^T \jMps$, with eigenvalues $\alpha^{(j)}$,
where everything is evaluated at time $t$. They credit Landau
and Lifshitz
{\em Quantum Mechanics}\rf{Landau59c} for this formula.
