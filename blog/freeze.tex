% siminos/blog/freeze.tex
% $Author$ $Date$

%\chapter{Deep freeze}
%\label{c-freeze}

\begin{description}

\item[2010-11-04 Evangelos]
I propose a third way. I needed to revisit the problem because symmetry
reduction is needed in what Kazz and Hugues do (and in what they want me
to do).

My proposition is based on rewriting (with pen and paper) invariant
variables obtained from slicing into a polar form. The second step is to
invoke L. Tuckerman's insight on polar variables singularities to modify
the invariants to avoid slice-induced jumps. Taking care of reflections
is the final step. Since there is no computer algebra used, the final
variables have a simple form which can be easily used in numerics - in
any dimension and with no extra man-power.

It is all in the
\begin{verbatim}
siminos/ksReduced/
\end{verbatim}
 directory, as a single section in a paper
which I propose the three of us write. I meant to write a first
draft before I upload it, but I will have to explain very soon to Kazz
and Hugues how I implement automated searches for nearby orbits.

Comments should go right here, to keep siminos/ksReduced as
article-like as possible.

\item[2012-01-03 Predrag] fix this:
\begin{verbatim}
The style file: plain.bst
Database file #1: ksReducedNotes.bib
Warning--entry type for "REVTEX41Control" isn't style-file defined
--line 1 of file ksReducedNotes.bib
Warning--entry type for "aip41Control" isn't style-file defined
--line 2 of file ksReducedNotes.bib
Database file #2: ../bibtex/siminos.bib
Warning--to sort, need author or key in REVTEX41Control
Warning--to sort, need author or key in aip41Control
(There were 4 warnings)
\end{verbatim}

\item[2012-01-10 Predrag] for time being this is the blog section, and
called by the `global 'reduction paper \texttt{siminos/ksReduced/} as
well.

\end{description}

\section{Norms, distances}
\label{sect:norms}

\subsection{Proximity of chaotic attractor to \eqva\ and \reqva}
\label{sec:proxeq}

{\bf RLD} Nov 2008  excised \reffig{f:ks_prox_eq} from the rpo.tex paper:

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[t]
\begin{center}
\includegraphics[width=0.9\textwidth, clip=true]{ks_prox_eq_tw}
\end{center}
\caption{\color{blue}
Proximity of a typical chaotic orbit of the \KSe with $L =
22$ to \eqva\ and \reqva. (a) chaotic orbit (same as in
refFig~{f:ks\_L22}); ~(b) distances of the chaotic orbit to
\eqva\ $\EQV{1}$, $\EQV{2}$, and $\EQV{3}$, are shown by
blue, green, and red lines, respectively. The distances are
measured according to \refeq{eq:proxeq}; ~(c) distances of
the chaotic orbit to \reqva\ TW$_{\pm 1}$ and TW$_{\pm 2}$,
are shown by blue, and green lines, respectively. The
distances are measured according to \refeq{eq:proxtw}.
     } \label{f:ks_prox_eq}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In order to illustrate the relative influence of \eqva\ and \reqva\ on the dynamics
within the KS chaotic attractor for $L = 22$, we calculated the distance of a
typical orbit, to different \eqva\ and \reqva.

The distance of a state-space point $a$ to \eqv\ $a_{\EQV{k}}$ is measured as a
Euclidean distance in Fourier space minimized with respect to the translation
of the \eqv\ by $\Shift_{\shift/L}$:
\beq
  d_{\EQV{k}} = \min_\shift \|a - \Shift_{\shift/L} a_{\EQV{k}} \|\,,\quad k = 1,2,3.
\label{eq:proxeq}
\eeq
Similarly, the distance to \reqv\ $a_{\REQV{\pm}{k}}$ is defined as follows
\beq
  d_{\REQV{k}{}} = \min_{\shift} \|a - \Shift_{\shift/L} a_{\REQV{\pm}{k}} \|\,,\quad k = 1,2,
\label{eq:proxtw}
\eeq
where we consider the distance to both $a_{\REQV{-}{k}}$ and $a_{\REQV{+}{k}}$, thus
minimizing both with respect to translation $\Shift_{\shift/L}$ and reflection $\Refl$.

The plot of $d_{\EQV{k}}$ in \reffig{f:ks_prox_eq}(b) show that \EQV{2} has a dominant
influence on the dynamics, \EQV{3} is influencing the dynamics more intermittently, while
\EQV{1} has little effect on the dynamics.  Similarly, as shown in \reffig{f:ks_prox_eq}(c),
the chaotic orbit does not visit the neighborhoods of \reqva , so their influence on
the chaotic dynamics is also minimal.

\subsection{Norms blog}

\begin{description}
\item[2011-11-16 Predrag] My problem is with the norm, or notion of
distance used in siminos/ksReduced. In fluid dynamics the community has
settled on
\beq
  \Norm{\ssp-\ssp'}^2  = \braket{\ssp-\ssp'}{\ssp-\ssp'} =
\frac{1}{V}
\int_\Omega \! d {\bf x} \;
(\vec{u}-\vec{u}') \cdot (\vec{u}-\vec{u}')
\,.
\label{innerproduct} \eeq
There is no compelling reason to use this {`energy norm'}, other than
that velocity fields is what is given in a numerical computation. What
norm one actually uses depends very much on the application. In the study
of `optimal perturbations' that move a laminar solution to a turbulent
one, both energy \citep{TeHaHe10} and dissipation \citep{LoCaCoPeGo11}
norms have been used.

If field $u(x,t)$ in \KSe\  is interpreted as
`flame-front velocity', the time-dependent $L^2$ norm
of $u$,
\beq
  \expctE= \Lint{\pSpace} V(x,t)= \Lint{\pSpace} \frac{u^2}{2}
  \,,
  \label{ksEnergyFreeze}
\eeq
has a physical interpretation\rf{ksgreene88} as the average `energy'
density of the flame front, in analogy to the mean kinetic energy
density for the Navier-Stokes.
I think for \KS\ it would be the safest to use
\beq
  \Norm{\ssp-\ssp'}^2  = \braket{\ssp-\ssp'}{\ssp-\ssp'} =
\Lint{\pSpace} ({u}-{u}')^2
\,.
\label{KSnormFr} \eeq
The virtue of energy norm is that it is representation independent. If
one goes to siminos/ksReduced/ invariant basis, the $2N-1$
$\SOn{2}$-invariant and functionally independent variables are
\bseq\label{eq:SO2cheb}
  \begin{align}
    \overline{b}_k &=
		    b_k\, \chebT_k\left(b_1/r_1\right)+
		    c_k\,\frac{c_1}{r_1} \chebU_{k-1}\left(b_1/r_1\right)\,, \label{eq:SO2cheb1}\\
    \overline{c}_k &=
		    b_k\, \frac{c_1}{r_1} \chebU_{k-1}\left(b_1/r_1\right)+
		    c_k\,\chebT_k\left(b_1/r_1\right)\,,  \label{eq:SO2cheb2}
  \end{align}
\eseq
for $k=1,\ldots N$, where $r_k\equiv\sqrt{b_i^2+c_i^2}$ and $\chebT_k,\,\chebU_k$
are Chebyshev polynomials of the first and second type, respectively.
The Chebyshev polynomials $\chebT_k,\,\chebU_k$ are degree $k$, so they tend
to significantly distort the state space layout of the attractor.

Evangelos, please confirm that you are using distance function \refeq{KSnormFr},
not the norm
\beq
\Norm{u}  =   {\textstyle\frac{1}{2}} \sum_{k=0}^{\infty}
   (\overline{b}_k^2+\overline{c}_k^2)
\,,
\label{normNotGood} \eeq

\item[2011-12-1 Evangelos] I do not understand norm \refeq{KSnormFr}. Take for instance a pure sin
equilibrium solution of KSe and compare it to itself under \refeq{KSnormFr} - you get zero. Now
translate it by $l<L$, and compare to the original: you get non-zero distance. Thus this norm is
not translation invariant.

I use $2\,\Norm{u}$ of \refeq{normNotGood}, since I see reduced KS as a
dynamical system defined in terms of invariant variables
$\overline{b}_k,\,\overline{c}_k$.

Please observe that although the Chebyshev polynomials
$\chebT_k,\,\chebU_k$ are degree $k$, they are functions of $b_1/r_1$ in
\refeq{eq:SO2cheb}. Therefore $\overline{b}_k, \overline{c}_k $ are not
really invariant polynomials in $b_k,\,c_k$. In fact, \refeq{eq:SO2cheb}
is equivalent to reducing to a slice with $c_1=0$. Therefore, even though
transformations \refeq{eq:SO2cheb} are nonlinear, they preserve
$r_k\equiv\sqrt{b_i^2+c_i^2}$. To see this, recall that they can be
written in the polar form
\bseq\label{eq:SO2polar0}
  \begin{align}
    \overline{b}_k &=
		    r_k\, \cos(\phi_k-k\,\phi_1)\,, \label{eq:SO2polar1}\\
    \overline{c}_k &=
		    r_k\, \sin(\phi_k-k\,\phi_1)\,.\label{eq:SO2polar2}
  \end{align}
\eseq
So any deformation of state space is a result of symmetry reduction
(identification of points along group orbits) and the discontinuity at
$r_1=0$.

If we were to follow Tuckerman's recipe and multiply \refeq{eq:SO2polar}
by $r_1^k$ we would indeed have invariant polynomials of order $k+1$ in
the $b_i,\,c_i$. In siminos/ksReduced, we try to keep state-space
distortion to a minimum, therefore multiplying by $r_1$ (or $r_1^2$).

\item[2012-02-23 PC]
\index{recurrence!plot}
In literature on \emph{recurrence plots} I see Euclidean, Manhattan, and
maximum norms. The maximum norm for defining distances in \statesp\ is
reputed to have lower computational demands than other norms.

\end{description}



\section{Freeze! drop that knife, no slicing here}
\label{sect:freeze}
\renewcommand{\LieElrep}{\ensuremath{g}} % Siminos Lie group element

\begin{description}

\item[2009-03-01 Evangelos] {\bf The Terrible Thesis figures}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
\begin{center}
  (\textit{a})\includegraphics[width=0.45\textwidth, clip=true]{ksSO2inv134}
  (\textit{b})\includegraphics[width=0.45\textwidth, clip=true]{ksSO2inv145}
\end{center}
\caption[\KS\ \SOn{2} reduced  state-space projection II]
{Two different projections of L=22 \KS\ dynamics on
invariants given in \reftab{tab:SO2n6}. Shown are 20
short \rpo s. Part of the unstable manifold of $\REQV{-}{1}$
is shown in black and part of the unstable manifold of
$\EQV{1}$ is shown in brown.}
\label{fig:SO2inv}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\PCedit{PC: Poincar\'{e} surface of section \reffig{f:drivedragPoinc}
probably does not make sense - the motions of various magnitudes squared,
are only shadows of the true dynamics in the full state space.
       }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
\begin{center}
    \includegraphics[width=0.6\textwidth, clip=true]{energyPoinc}
\end{center}
\caption[Poincar\'{e} surface of section for L=22]
        {
Shown on Poincar\'{e} surface of section
$\expct{(u_{xx})^2} = \expct{(u_{x})^2}$:
\EQV{1}, \EQV{2} and \EQV{3} in red, green and blue solid points respectively,
connections from \EQV{1} to $A(L/4)\EQV{1}$,
from $A(L/4)\EQV{1}$ to \EQV{1} and from \EQV{3} to $A(L/4)\EQV{1}$ in green,
yellow-green and blue circles respectively,
a typical ``turbulent" evolution (black) and all \po s and \rpo s
determined so far for $L=22$.
        }
\label{f:drivedragPoinc}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

 \RLDedit{with small subsets of
symmetric (eventually) \po s lying on $d=0$, $d=L/2$, \etc\ lines.}

{All orbits we found with $d = 0$ have reflection symmetry,
so they are discussed later as \po s.  We found no orbits with
$d = L/m$ exactly, so the highlighted statement needs to be dropped or
modified somehow.}

 It is the unstable manifold of the \EQV{2}
{\eqv}, drawn by tracing out a set of points along one of the complex
eigenvectors, that start close to it. Surprisingly, everybody connects
to the \EQV{2} shifts by 1/2 wavelength ($d = L/4$) but as we are in
$\infty$-dimensions they do it not as the usual homoclinic connection, but in
many (all?) possible intermediate ways. This might be a clue for how to
partition symbolic dynamics.
What is great about
this is that the \EQV{2} unstable manifold has a heteroclinic connection to itself
$L/2$ shifted, but
even better, to \EQV{2}, and \EQV{3} unstable manifold has a heteroclinic
connection to \EQV{2}.
That makes for a rigid backbone -
we hope this will help us develop a symbolic dynamics for \rpo s.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% former {figure}[t] \label{f:KS22cage}
\begin{figure} [t]
\begin{center}
\includegraphics[width=0.3\textwidth]{ks22_E1_UM_diag}
\includegraphics[width=0.3\textwidth]{ks22_E2_UM_diag}
\end{center}
\caption[OBSOLETE: EQV{1}~\eqv\ unstable manifold]
        {OBSOLETE:
\EQV{1}~\eqv\ unstable manifold,
    with the trajectory connecting the
\EQV{2}~\eqv\ point to the unique corresponding heteroclinic
point in the \EQV{3}~\eqv\ family.
\EQV{3}~unstable manifold in turn connects \EQV{3} to the
stable manifold of \EQV{2}.
  %
\PCedit{
Edit the cage of heteroclinic connections,
xfig file /rpo\_ks/figs/ks22\_E1\_UM\_diag.fig
and rpo\_ks/figs/ks22\_E2\_UM\_diag.fig
    }
        }
\label{f:KS22cage}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\item[2011-11-01 Ruslan] (muttering to himself)             \toCB
I know Predrag wants to do it on a slice, but
i) I'm yet to see a sliced KS and
ii) I'm not convinced that slicing is useful in high dimensions anyway:
I can see the benefit of reducing a 3-d flow to a 2-d map, but I'm not
sure it is as beneficial to work with a 6-d map instead of an 8-d flow.

\item[2011-11-04 Predrag]              \toCB
How high does 100.000 dimensions sound to you?

i) I have said ciao to Chao, so currently no one is slated to slice
\KS.

ii) Instead, we have sliced transitionally turbulent pipe flow, and
for the first time we have \rpo s embedded in pipe turbulence. The great
advantage of the pipe flow is that it has no streamwise reflection
symmetry, so all exact solutions are relative, and there is no room for
philosophy - you either do it or do not do it. \emph{Invite Ashley Willis
for a seminar}.

iii) Every continuous symmetry must be reduced in order
to organize the flow, a local chart describing a neighborhood of a
template is a slice in group action directions, Poincar\'e section in
time evolution directions. One MUST go to Poincar\'e section to organize
the attractor by local stable-manifold road maps. In \pCf\ we have many
\po s, but together they just make a jumble in the state space. It's obvious
why if you just work through the 3-disk example in ChaosBook.org - only
in the Poincar\'e section is the topology of the strange attractor
cleanly laid out. (Getting this across has ballooned ChaosBook's
initial 2-chapter review of dynamics into 10 chapters and counting...)

\item[2011-11-04 Ruslan] Thank you for replying to my 'muttering', and
thanks for the suggestion: will invite Ashley over.  Indeed things are
much easier without reflections.  I agree with (iii) if a good slice can
be found, but the 'curse of dimensionality' will be hard to beat.  Your
slice quilt in \reffig{fig:Tesselate} looks good in 2-d (with 16 slices),
but in $n$-d you'll need $4^n$ slices to achieve the same resolution.

\item[2011-11-04 Predrag] Too pessimistic. If the `physical dimension' is
large, we are indeed screwed. If it is 4-8 (\KS) or 100-1000 (\pCf\ in
the minimal cell) I expect the number of qualitatively different states
to be a handful, a factor of 2-4 for each spatial direction.
%If you think
%$3D$ turbulent pipe flow is `much easier' be my guest - go do it. It will
%be news to Ashley and Marc who did not get the memo.
%
%\item[2011-11-04 Ruslan] I did not say pipe flow was easy, I was rather
%referring to something like CLE.

\item[2011-11-04 Ruslan]
But even if we only do it locally, in order to really tackle the symmetry
reduction problem in \KS, I'd suggest we try to do it not around one of
the RPOs or PPOs, but in the vicinity of the $\EQV{2} \to
\tau_{1/4}\EQV{2}$ heteroclinic cage.  We claimed in our paper that it
organizes the \KS\ flow for $L = 22$, now it would be good to put some
meat on this carcass.

\item[2011-11-04 Predrag] Agreed. We do not have enough experience with
actually picking good templates, we should try various choices. My
understanding is that a good set of templates should enumerate all topologically
distinct states of the system. For example, for a stretch \&\ fold flow
one needs two, one for `stretch' part of the unstable manifold, the other
for `stretch \&\ flip' part. The embedding dimension does not matter.
The problem is manpower.

\item[2011-11-05 Ruslan] Manpower is not a problem if we are all pulling
in the same direction.  If you agree that the case of the
$\EQV{2} \to \tau_{1/4}\EQV{2}$ heteroclinic cage is sufficiently interesting,
then we are returning back to my dilemma
I expressed in 2009-10-17 (Desymmetrization blog, section 13.9).

\item[2011-11-07 ES] My opinion on how to proceed can now be found
in siminos/ksReduced. Let's continue the discussion in siminos/blog.

\item[2011-11-04 Predrag 2 Ruslan] Something completely different. My
undergraduate Naveen is simulating the \emph{Karma model} of cardiac
activity introduced by Alain Karma (\emph{Electrical alternans and spiral
wave breakup in cardiac tissue}\rf{Karma1994}). It is a 1-dimensional PDE on a
periodic ring, with using state variables $E$, which is the value for the
voltage in cardiac tissue, and $n$, which is the slow current gate
variable.

Can you \rpo\ fishing programs be easily altered from KS to another
1-dimensional PDE?

\item[2011-11-05 Ruslan about Karma model]  How interesting... I know
Alain very well through his work on phase field modelling of solid-liquid
interfaces.  I had no idea that in his previous incarnation he worked in
nonlinear dynamics.  I heard of cardiac Karma model before, but I
honestly thought it was a different Karma, until you mentioned Alain.
Anyway, sure I can have a look at it, just need to be able to integrate
this PDE numerically with under about 100 ODEs.  I don't have access to
Chaos here, so it would be useful if you (or Naveen) spelled out for me
the equations, parameters, dynamics you are interested in, etc.

\item[2011-11-05 Predrag] Karma 1994 paper:
\href{http://chaosbook.org/library/Karma1994.pdf}{library/Karma1994.pdf}
{click here}. You will need to type \texttt{student} and then \texttt{Lautrup} .

\item[2011-11-08 Predrag] If it is any help, here is the code for Karma 1994 that Naveen is using
(can one just replace KS by Karma in your RPO search routines?)

\item[2011-11-08 Ruslan] Yes, equations help, but I also need to know which method you use to integrate them.
Actually, what I need to replace in my search routines is not the definitions of the PDE (or ODEs), but rather the numerical flow map.
So, a sample Matlab code that generates a typical (chaotic?) solution of this model would be helpful.

\item[2011-11-19 Ruslan] Has Naveen been able to integrate the Karma model?

\item[2011-11-15 Predrag] (Less minor:) sooner or later you have to bite
a bullet and start looking at the periodic points and their unstable
manifolds in sets of Poincar\'e sections defined at well chosen template
points. \refFig{fig:ks22shad} quickly becomes a meaningless jumble (that
is what Gibson does with our \pCf\ \po s; nothing can be
understood this way). I'm worried that siminos/ksReduced
approach will not work for high-dimensional flows (it is no different
from using low Fourier modes to capture highly turbulent states), but
I'll shut up - if you make it work for \KS, I'll be impressed.

\begin{figure}[ht]
  \begin{center}
    (a)\includegraphics[width=0.45\textwidth]{ks22ppoT10235shad.png}~
    (b)\includegraphics[width=0.45\textwidth]{ks22ppoT7035shad.png}\\
    (c)\includegraphics[width=0.45\textwidth]{ks22ppoT10235angl_dist.png}~
    (d)\includegraphics[width=0.45\textwidth]{ks22ppoT7035angl_dist.png}
  \end{center}
  \caption{Shadowing of periodic orbits. (a) Hyperbolic pre-periodic orbits
    \PO{32.36} and \PO{40.35} shadow \PO{102.4} which appears to be close
    to non-hyperbolicity. Note that \PO{102.4} traces \PO{32.36} twice.
    (b) \PO{70.35}, is shadowed by \RPO{34.64} and \RPO{39.77}.
    (c) Angle of first two Floquet eigenvectors along \PO{102.4} (red, solid line) and
    closest distance from \PO{102.4} of points on \PO{32.36} (blue triangles) and \PO{40.35}
    (green crosses). (d) Angle of first two Floquet eigenvectors along \PO{70.45} (red, solid line) and
    closest distance from \RPO{70.45} of points on \PO{34.64} (blue triangles) and \RPO{39.77}
    (green crosses).
    }
  \label{fig:ks22shad}
\end{figure}


\item[2011-11-16 Evangelos] The scope of siminos/ksReduced would be to
demonstrate symmetry reduction, not to reduce \KS\ flow to return maps.
The latter would be left to some subsequent paper and indeed someone will have
to bite a bullet and do what you suggest (maybe this will be me anyway).

`` It is no different from using low Fourier modes to capture
highly turbulent states.'' I disagree. \refFig{fig:ks22shad}(a)
and (b) indeed focus on low Fourier modes but they are just a visual aid,
not really needed here. On the other hand distance in
\reffig{fig:ks22shad}\,(c) and (d) is computed in invariant variables using
\emph{all} Fourier modes (\ie\ as many as you need for a well resolved
simulation). For the Lyapunov project \reffig{fig:ks22shad}(c) and (d)
and \reftab{tab:ks22shad} are, I think, good starting points to formulate
a conjecture.

\item[2011-11-16 Evangelos]
Ideally, siminos/ksReduced would include:
\begin{itemize}
 \item some visualizations of unstable manifolds of \eqva\ and \reqva\
	in invariant variables, projected on local coordinate systems
	given by the least stable eigenvectors as in our
	SIADS paper \refref{SCD07},
 \item some visualizations illustrating how (relative) periodic orbits are
	organized by such unstable manifolds (corroborated by measuring distance
	of points on the cycles from points on the unstable manifolds),
 \item some rudimentary organization of short cycles into families using
	their mutual distance as criterion.
\end{itemize}

At this stage I don't see anything wrong with publishing a paper that does
not tell the whole \KS\ story (even achieving 2 out of 3 goals above is a lot
of work and even writing down the symmetry invariant variables required a lot
of thinking).

\item[2011-11-16 Predrag] You are right, a step at a time. Let's go for
it. As for the massaged invariant variables of siminos/ksReduced, all is
fair in war and love.

\item[2011-11-16 Ruslan] I agree with Predrag, but I would like us to
reduce the 'massaging' to a minimum.  In particular, I'd like to be
convinced that i) the removal of the 'singularity' at $r_1 = 0$ is
necessary, and ii) that the introduction of abs on odd/even modes to
reduce reflections is not an overkill.

    Regarding i) Evangelos claims that variables $\bar{b}_k$ and
    $\bar{c}_k$ are singular, but I don't see this from Eqs. (6).  When
    $r_1 \to 0$, both $b_1$ and $c_1 \to 0$ as well, and the limits of
    $b_1/r_1$ and $c_1/r_1$ exist and are well defined.  So, could you
    please clarify why you think $\bar{b}_k$ and $\bar{c}_k$ are
    singular?

    Regarding ii) I'm not absolutely sure, but it appears to me that the
    dynamics in the reduced space might not be unique: two points in the
    full space of KS solutions, which are not related by the O(2)
    symmetry, may be represented by the same values of the reduced
    variables, so it is possible that if we pick a point in the reduced
    space, there could be two different reduced orbits that pass through
    it.  Can you guarantee that this doesn't happen?

\item[2011-11-21 Evangelos] Regarding i) The limits of
  $b_1/r_1$ and $c_1/r_1$ as $r_1$ do not exist as they depend on the
  direction on the $(b_1,c_1)$ plane through which we approach the origin.
  Another way to see this is to observe, for instance, that $b_1/r_1 = cos \phi_1$.
  If we approach $r_1\rightarrow0$ through $c_1=0$, \ie\ on the $b_1$ axis,
  $cos \phi_1$ jumps from $-1$ to $1$. In general, if we approach the origin
  through a ray at $\phi_1=\Phi$, $b_1/r_1$ jumps from $-\cos \Phi$ to $\cos \Phi$.
  Although it might be tempting to try to ensure continuity of trajectories by
  tracking the direction through which they approach the origin, I cannot see how
  to treat equilibria with $b_1=c_1=0$ (2-cell, 3-cell, etc).

  Regarding ii) you are right, I shouldn't have used absolute value since then
  points that are not related by reflections are also identified. Defining
  a transformation to fundamental domain with respect to reflections
  needs more thinking then. Any ideas?

\item[2011-11-21 Ruslan] i) I believe this is a 'chicken and egg' discussion.  For me, the limits $b_1/r_1$ and $c_1/r_1$ {\em define} the direction, while for you they depend on the direction.  And yes, I don't think it is problematic to track the direction: an orbit passing through $r_1 = 0$ always does so along a certain direction, which is well defined by the flow vector at $r_1 = 0$.  The problem appears when both $r_1 = 0$ and $\dot{r}_1 = 0$, since then we indeed have no direction of the flow vector.  But this is not a big problem: see my 'musings' below.

    ii) The only ideas I have you are not going to like, since they will lead to a dynamics with discontinuities.  As far as I can see, this cannot be avoided: to remove reflections, you are allowed only one absolute value, all other coordinates will have to jump from $-b$ to $b$ (or $-c$ to $c$) whenever the one you take the absolute value of passes through zero.

\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.48\textwidth, clip=true]{ks22_E2_manifold_c}
\includegraphics[width=0.48\textwidth, clip=true]{ks22_E2_MSO2_manifold}
\end{center}
\caption{
The left panel shows the two-dimensional unstable manifold of \eqv\
\EQV{2}, from \refref{SCD07}. See reffig~{f:KS22Manifold} of
\refref{SCD07} for a different visualization. The right panel shows {\bf
2011-11-18 Ruslan} two-dimensional unstable manifold of \eqv\ \EQV{2} in
$\pS/\SOn{2}$ slice at $\theta_1 = \pi/2$. The coordinate axes $v_1$,
$v_2$, and $v_3$ are constructed from vectors Re\,$\jEigvec[1]$,
Im\,$\jEigvec[1]$, and {Re\,}$\jEigvec[7]$ by Gram-Schmidt
orthogonalization.
       }
\label{f:KS22E2man1}
\end{figure}

\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.48\textwidth, clip=true]{ks22_E2_orbits_c}
\includegraphics[width=0.48\textwidth, clip=true]{ks22_E2_MSO2_orbits}
\end{center}
\caption{
The left panel shows spatial representation of three orbits of
\reffig{f:KS22E2man}, full state space. The right panel shows spatial
representation of three orbits in the $\pS/\SOn{2}$ slice.
       }
\label{f:ks22_E2_MSO2}
\end{figure}

\item[2011-11-18 Ruslan] \refFigs{f:KS22E2man1}{f:ks22_E2_MSO2} show the
unstable manifold of \EQV{2} in $\pS/\SOn{2}$. The reduced space is a
slice at $\theta_1 = \pi/2$. Since this manifold is antisymmetric,
translations into the slice rotate parts of the manifold with $\theta_1 =
-\pi/2$ by $\pi$, while other parts remain unchanged.  So, the original
manifold (left panel in \reffig{f:KS22E2man1}) is cut in half, with
orbits jumping from one sides of the cut to the other.  Ideally, we would
like to glue those two sides together. I believe this is what Evangelos's
variables would do.  But they would also distort the manifold, and it
might not look as pretty as it does now... Well, "beauty is in the
eyes...", as they say, so maybe it looks ugly to you.

\item[2011-11-19 Predrag] Sorry, I do not get this ``slice at $\theta_1 =
\pi/2$''. This looks like 1/2 of the full state space, which I would expect
for the discrete $D_1$ quotient; flow in the slice always looks different
(and simpler) from the flow in full state space. Maybe you can walk me
through this?

\item[2011-11-20 Ruslan] OK. I work with the Fourier representation (sorry):
\[ a_k = (b_k, c_k) = b_k + ic_k = (r_k, \theta_k) = r_k e^{i\theta_k}\,. \]
I define the slice by points $\bar{a}_k$ with $\bar{\theta}_1 = \pi/2$  (or $\bar{b}_1 = 0$, $\bar{c}_1 > 0$).  Points in the full state space are mapped onto the slice by translation by $\theta(a) = \bar{\theta}_1 - \theta_1 = \pi/2 - \theta_1$:
\[ \bar{a} = g(\theta(a)) a\,. \]
So, $(\bar{r}_k, \bar{\theta}_k) = (r_k, \theta_k + (\pi/2 - \theta_1)k)$.

Yes, the \EQV{2} unstable manifold in the slice indeed looks like reduced by $D_1$, but this is because the manifold is antisymmetric (i.e., lives in $\mathbb{U}^+$, i.e. $b_k = 0$), so points on the manifold have either $\theta_1 = \pi/2$, i.e. $c_1 > 0$, so do not need translation (i.e. $\theta(a) = 0$), or $\theta_1 = -\pi/2$, i.e. $c_1 < 0$, for which $\theta(a) = \pi$.  Does this make sense?

\item[2011-11-18 Ruslan]
    A simple way to glue the two sides would be to double the angle
    around the \EQV{2} - $\tau_{1/4}$ \EQV{2} axis, but I haven't had
    time to figure out what type of coordinate transformation that would
    be and whether it could be made generically to glue other similar
    cuts in my symmetry reduction approach.

    On the other hand, we can simply put a Poincar\'e section through the
    manifold in $\pS/\SOn{2}$ and, as long as the section does not intersect
    the cut, the manifold will be continuous.  Or maybe put the PSS on
    the cut?...  So many choices, so little time...

\item[2011-11-19 Predrag] I believe you cannot put Poincar\'e section on
the \sset, they are defined by different conditions. However, Siminos did
show in \refref{SiCvi10} for complex Lorenz equations that even though
the reduced state space trajectories always encounter the \sset, a natural
Poincar\'e section can be chosen to avoid it. This might be the point of
`global Poincar\'{e} section' of \refref{DuLoMe11} (see {\bf [2011-11-17
ES] } in Lie.tex; we need to study this paper in detail). In my
arguments\rf{ACHKW11} for constructing a reduced dynamics as global atlas
composed from charts local to important classes of turbulent states, I
currently do it in two steps: 1) slice continuous symmetries, 2)
Poincer\'e section the time flow. I believe one has to do both, but write
it up this way because neither plumbers nor flamers (KS crowd) want to do
Poincer\'e sections. So maybe in the end it will all work out nicely,
without any singularities.

\item[2011-11-21 Evangelos] \refFig{f:KS22E2man1} is in my opinion a
a great example of slicing inconvenience. I suppose Ruslan uses
$\bar{b}_1 = 0$, $\bar{c}_1 > 0$ instead of $\bar{c}_1 = 0$, $\bar{b}_1 > 0$
which I use in ksReduced, in order to avoid rotating points in the antisymmetric
subspace (equilibria being the most tricky) by an angle $\neq \pi$.
Other than this, this approach is equivalent to using eqs. (9) in ksReduced.

Apart from tearing the unstable manifold apart (while it seems all we needed
was to rotate some of its points by $\pi$), this approach also fails to identify
$\EQV{2}$ and its translated copy $\tau_{1/4}\EQV{2}$. As both $\EQV{2}$ and
$\tau_{1/4}\EQV{2}$ have $a_1=0$, these point are not rotated at all and they must
have been drawn using their initial coordinates. What I did not expect,
and I do not understand, is that the unstable manifold of \EQV{2}
approaches $\tau_{1/4}\EQV{2}$ and not \EQV{2} in this reduced space. Why?

I can also see a vertical line going through $\tau_{1/4}\EQV{2}$, where did this
come from?

%\item[2011-11-21 Ruslan] Not sure about the vertical line: it is probably one of the trajectories in the manifold that strayed off the antisymmetric subspace (I'm not enforcing antisymmetry, so numerical noise eventually takes the orbits away from it).  Once the orbit is off the subspace, it will be rotated by $\pi/2$ and thus moved back towards \EQV{2}.  But this is just a speculation at this point.

\item[2011-11-21 Ruslan] Indeed, I don't think we can slice without making cuts.  You say ''while it seems all we needed was to rotate some of its points by $\pi$''.  But this is exactly what I've done!  Half of the points on the manifold are rotated by $\pi$ while the other half remain unchanged.  The problem is that you cannot rotate half a pie by $\pi$ (pardon the pun) without cutting it first in half.

    About identifying $\EQV{2}$ and $\tau_{1/4}\EQV{2}$, we had this discussion some time ago, and this was where I experienced my major (aesthetic) difficulties.  The simple truth is that you cannot rotate by $\pi/2$ (i.e. by $\tau_{1/4}$) if you are only allowed to rotate by $\pi$.  So, in my symmetry reduction approach $\EQV{2}$ and $\tau_{1/4}\EQV{2}$ remain distinct.  But this is not a big deal, since they are invariant objects and thus, according to Predrag, never appear within the dynamics (only as limiting states when $t \to \pm \infty$).
    By the way, this also means that in my original proposal for O(2) symmetry reduction we never need anything more than the 1-st Fourier mode.  This is because points cannot be mapped into the $\theta = \pi/2$ slice only when both $r_1 = 0$ and $\dot{r}_1 = 0$.  But these conditions define the $L/2$ periodic solutions, which are invariant under \KS dynamics and thus appear only as limiting states.

    Basically we have a choice here: to slice or not to slice.  To slice means that we select a subset (a slice) of the full state space and map every point from the full state space onto the subset by a group action.  The drawback is that we cannot do it without introducing discontinuities to the dynamics on the slice.  It is already apparent with the SO(2) reduction and will only get worse when we factor in the reflections.

    Not to slice means to choose a set of symmetry invariant coordinates.  The drawback here is that these coordinates are nonlinear functions of the original coordinates of the full state space, so the full state space looks strongly warped up.  Many of the invariant coordinate only take positive values, so the orbits in them often look squeezed into a corner with a lot of things happening around the origin.  Another feature that I don't like here is that the dynamics on the invariant coordinates may not be uniquely defined: there could be points not related by symmetry in the full state space which have the same values of the invariant coordinates (at least this is what happens in Evangelos's coordinates when reflection invariance is introduced).  This means that one can have several different orbits emanating from the same point in the invariant coordinates.

    Since me and Evangelos are in the opposite camps here, I guess it's
    up to Predrag to decide what we do.  Although, I'm afraid Predrag
    will come up with a third option, which to me will then resemble
    (sadly) the heros of this
    \href{http://www.poemhunter.com/poem/swan-pike-and-crawfish/}{poem}.

\item[2011-11-21 Evangelos] Plotting the unstable manifold of \EQV{2} in $\SOn{2}$-invariant
coordinates $\tilde{b}',\tilde{c}'$ of ksReduced. As we only deal with antisymmetric subspace
here, we do not need to worry about reflections.

\begin{figure}[ht]
 \begin{center}
  \includegraphics[width=0.5\textwidth]{ks22_E2_manifold_inv}
 \end{center}
\caption{Unstable manifold of \EQV{2} in coordinates
$\tilde{b}',\tilde{c}'$ of ksReduced. The coordinate axes $v_1$, $v_2$,
and $v_3$ are constructed from vectors Re\,$\jEigvec[1]$,
Im\,$\jEigvec[1]$, and {Re\,}$\jEigvec[7]$ by Gram-Schmidt
orthogonalization (in the full state space) and transformed to reduced space
through transformations (11) of ksReduced.
  }
\label{f:ks22_E2_inv}
\end{figure}

Here we can see that $\EQV{2}$ and $\tau_{1/4} \EQV{2}$ are identified and their
connections become homoclinic. The unstable manifold of $\EQV{2}$ has indeed been distorted
nonlinearly and spiraling is not as clear in \reffig{f:ks22_E2_inv} as in
\reffig{f:ks22_E2_MSO2}. Moreover, identification of $\EQV{2}$ and $\tau_{1/4} \EQV{2}$
makes the figure more busy (unstable and stable manifolds lead to the same point), but this
cannot be avoided.

In general I prefer to have to live with such nonlinear projections until
a good Poincar\'e section can be identified than to have to deal with
artificial discontinuities.

\item[2011-11-22 Krylov's Pike] Guys, I stand weak here, as
there is no substitute for work... I'm bogged down with teaching, looming
deadlines and imminent turkey feast here. I did spend whole night
dreaming about symmetry reduction, though, and I do fear that my dreams
align with Krylov. I hope that the invariant polynomial approach works
for this problem. Perhaps plotting positive coordinates on log scale
would un-crowd the origin.

As to the slices: A single hyperplane slice always
introduces discontinuities - to construct a global slice (defined as one
and only one point per group orbit) one \emph{must} use a set of
templates, a local chart for each, small enough that their \sset s are
excluded. A template which is a single low Fourier mode is
\emph{unphysical}; natural choices for this project might be (close to)
\EQV{2} and \EQV{3}, but I might be wrong. I believe templates with
non-trivial symmetries are no good, as they do not reduce the full
symmetry, so I have not been able to use solutions like these \eqva\ in
the pipe flows, but I am not sure one cannot use them. Maybe use our
\REQV{\pm}{p}?

Perhaps not helpful to Ruslan, but in numerical work using a physical
choice for template is no more work than fixing a Fourier mode, and
testing whether one is on one chart or the other is a linear, $\pm$ test.
It seems to work for pipe flows, where invariant polynomials are not an
option. Maybe give it a try anyway, with two slices?

\item[2011-11-24 Ruslan 2 Predrag] I know you keep saying that Fourier modes are unphysical and we should use 'physical' templates instead.  And believe you me, I completely support your view: I'm not using FM because I'm particularly married to them.  I look at things much more pragmatically and use whatever looks simpler.  But I think you are completely missing the point when you try to decide what templates to use for slicing.

    The way I see it, there are solutions that are easy to slice without discontinuities (either using FM or physical templates) and then there are those that are impossible to slice without discontinuities.  We can spend our time and effort slicing easy solutions (in the pipe flows, KS, whatever) and we can publish nice papers with pretty pictures in them, but this is not really interesting to me.  I know it can be done and there is not much challenge there, just routine and sometimes tedious work.  What I'm really interested in is learning how to deal with the difficult solutions, where slicing involves discontinuities.

    Here's how I see it: I view KS solutions as functions (or waves) on a circle.  Some solutions can be seen as a pattern traveling clockwise or counterclockwise on a circle, i.e. riding a dominant wave around the circle.  I think the name {\em modulated traveling waves} is quite appropriate in this case.  These solutions are easy to slice without discontinuities, either using FM or any other (more 'physical') templates.  In the moving frame picture one simply rides the dominant wave around the circle.

    But there are other types of solutions: they can be viewed as superpositions of two almost equally dominant waves traveling in opposite directions.  In these solutions a pattern on the one side of the circle disappears and reappears on the opposite side.  Such solutions are particularly important in systems with reflection symmetry: solutions in the antisymmetric subspace can be viewed as superpositions of two {\em exactly} equal dominant waves traveling in opposite directions.  To me it is obvious that such solutions cannot be sliced without discontinuities, i.e. without jumping from one side of the circle to the other across the origin, or without traveling infinitely fast around the circle in whichever direction you prefer.  The problem is in the nature of the solution itself, not in the choice of the slice, or the moving frame.

    Hopefully this explains to you why I said earlier that systems without reflection symmetry are 'trivial' to slice.

    So yes, we can take \REQV{\pm}{p} and happily slice KS dynamics in their vicinity.  But, as I said above, I find this a rather trivial exercise, and also rather irrelevant when it comes to reducing solutions of the \KS\ equation with $L = 22$.  In this case \REQV{\pm}{1,2} are too far away from the chaotic attractor to be of much relevance.  It is clear that dynamics on the chaotic attractor is dominated by the unstable manifold of \EQV{2}, which, unfortunately, is antisymmetric.  Slicing it, together with its neighborhood, {\em will} involve discontinuities, and we can either say we don't want to go there (and to me it means to throw away the baby with the bath water), or we can try to learn how to deal with such solutions.

    When I have some spare time, I'll be happy to help Evangelos with his invariant coordinates and I'll be happy to help you with slicing sliceable flows.  But my real interest is in trying to make sense of the not-so-easily-sliceable flows, so I'll be trying to pull in that direction as well.

\end{description}

\renewcommand{\ssp}{a}
