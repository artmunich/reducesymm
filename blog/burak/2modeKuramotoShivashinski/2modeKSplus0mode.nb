(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     97896,       2966]
NotebookOptionsPosition[     93705,       2829]
NotebookOutlinePosition[     94039,       2844]
CellTagsIndexPosition[     93996,       2841]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Kuramoto", " ", "-", " ", 
      RowBox[{"Shivashinsky", " ", "equation"}]}], ")"}], " ", "under", " ", 
    "periodic", " ", "boundary", " ", "conditions", " ", "truncated", " ", 
    "after", " ", "2", " ", "Fourier", " ", 
    RowBox[{"modes", "."}]}], "*)"}], "  "}]], "Input",
 CellChangeTimes->{{3.586699467305988*^9, 3.586699550509967*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Velocity", " ", "function", " ", "for", " ", "two", " ", "mode", " ", 
   "truncated", " ", "KS", " ", 
   RowBox[{"eq", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.586702929678238*^9, 3.586702941134627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"va", " ", "[", 
    RowBox[{"a1_", ",", " ", "a2_"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"mu1", " ", "*", " ", "a1"}], " ", "-", " ", 
      RowBox[{"I", "*", "q1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Conjugate", "[", "a1", "]"}], "*", "a2"}], " ", "+", " ", 
         RowBox[{"a0", "*", "a1"}]}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mu2", " ", "-", " ", 
         RowBox[{"I", "*", "e2"}]}], ")"}], "*", "a2"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"I", "*", 
         RowBox[{"q2", "/", "2"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a1", "^", "2"}], "+", 
         RowBox[{"2", "*", "a0", "*", "a2"}]}], ")"}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.586699552306074*^9, 3.586699615049499*^9}, {
  3.586699672780853*^9, 3.586699801717958*^9}, {3.586899550442323*^9, 
  3.586899614209232*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Real", " ", "part", " ", "of", " ", "the", " ", "velocity", " ", 
   RowBox[{"function", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.586702945691342*^9, 3.586702956540432*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "/", "2"}], ")"}], "*", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x1", "+", 
         RowBox[{"I", "*", "x2"}]}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"y1", "+", 
         RowBox[{"I", "*", "y2"}]}], ")"}]}], "]"}], " ", "+", " ", 
     RowBox[{"Conjugate", "[", 
      RowBox[{"va", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "+", 
          RowBox[{"I", "*", "x2"}]}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{"y1", "+", 
          RowBox[{"I", "*", "y2"}]}], ")"}]}], "]"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1", ",", " ", "x2", ",", " ", "y1", ",", " ", "y2", ",", " ", "mu1", 
       ",", " ", "q1", ",", " ", "mu2", ",", " ", "e2", ",", " ", "q2", ",", 
       " ", "a0"}], "}"}], " ", "\[Element]", " ", "Reals"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.58669980939336*^9, 3.586699810010627*^9}, {
  3.586699859797466*^9, 3.586699928056*^9}, {3.586700341437498*^9, 
  3.586700408047246*^9}, {3.586700501885998*^9, 3.586700524546671*^9}, {
  3.586700598865018*^9, 3.586700614751818*^9}, {3.586700802256406*^9, 
  3.586700851768325*^9}, {3.586700883241071*^9, 3.58670089820304*^9}, {
  3.586700977814704*^9, 3.586701055832473*^9}, {3.586701115590845*^9, 
  3.586701180784661*^9}, {3.586701225437376*^9, 3.586701230439451*^9}, {
  3.586701279111067*^9, 3.586701286703775*^9}, {3.586701376209788*^9, 
  3.586701412037402*^9}, {3.586702014722568*^9, 3.586702093005835*^9}, {
  3.586899632010868*^9, 3.586899634157386*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"q1", " ", "x2", " ", 
     RowBox[{"(", 
      RowBox[{"a0", "-", "y1"}], ")"}]}], "+", 
    RowBox[{"x1", " ", 
     RowBox[{"(", 
      RowBox[{"mu1", "+", 
       RowBox[{"q1", " ", "y2"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"q2", " ", "x1", " ", "x2"}], "+", 
    RowBox[{"mu2", " ", "y1"}], "+", 
    RowBox[{"e2", " ", "y2"}], "+", 
    RowBox[{"a0", " ", "q2", " ", "y2"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.586701992397426*^9, {3.586702025482061*^9, 3.586702094031059*^9}, 
   3.586899642089036*^9, 3.586899720536844*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Complex", " ", "part", " ", "of", " ", "the", " ", "velocity", " ", 
   RowBox[{"function", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.586702961181919*^9, 3.586702969451451*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "\[ImaginaryI]"}], ")"}]}], ")"}], "*", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"va", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x1", "+", 
         RowBox[{"I", "*", "x2"}]}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"y1", "+", 
         RowBox[{"I", "*", "y2"}]}], ")"}]}], "]"}], " ", "-", " ", 
     RowBox[{"Conjugate", "[", 
      RowBox[{"va", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "+", 
          RowBox[{"I", "*", "x2"}]}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{"y1", "+", 
          RowBox[{"I", "*", "y2"}]}], ")"}]}], "]"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1", ",", " ", "x2", ",", " ", "y1", ",", " ", "y2", ",", " ", "mu1", 
       ",", " ", "q1", ",", " ", "mu2", ",", " ", "e2", ",", " ", "q2", ",", 
       " ", "a0"}], "}"}], " ", "\[Element]", " ", "Reals"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.586702103822543*^9, 3.586702137120531*^9}, {
  3.586899649216072*^9, 3.586899649841875*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"mu1", " ", "x2"}], "-", 
    RowBox[{"q1", " ", "x1", " ", 
     RowBox[{"(", 
      RowBox[{"a0", "+", "y1"}], ")"}]}], "-", 
    RowBox[{"q1", " ", "x2", " ", "y2"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "e2", " ", "y1"}], "-", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x1", "2"], "-", 
         SuperscriptBox["x2", "2"], "+", 
         RowBox[{"2", " ", "a0", " ", "y1"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "mu2", " ", "y2"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.586702138623797*^9, 3.586899650613688*^9, 
  3.586899723818244*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Velocity", " ", "function", " ", "in", " ", "full", " ", "state", " ", 
   "space"}], "*)"}]], "Input",
 CellChangeTimes->{{3.586702906756567*^9, 3.586702919257152*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vx", "[", 
   RowBox[{"x1_", ",", " ", "x2_", ",", " ", "y1_", ",", " ", "y2_"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"q1", " ", "x2", " ", 
      RowBox[{"(", 
       RowBox[{"a0", "-", "y1"}], ")"}]}], "+", 
     RowBox[{"x1", " ", 
      RowBox[{"(", 
       RowBox[{"mu1", "+", 
        RowBox[{"q1", " ", "y2"}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"mu1", " ", "x2"}], "-", 
     RowBox[{"q1", " ", "x1", " ", 
      RowBox[{"(", 
       RowBox[{"a0", "+", "y1"}], ")"}]}], "-", 
     RowBox[{"q1", " ", "x2", " ", "y2"}]}], " ", ",", " ", 
    RowBox[{
     RowBox[{"q2", " ", "x1", " ", "x2"}], "+", 
     RowBox[{"mu2", " ", "y1"}], "+", 
     RowBox[{"e2", " ", "y2"}], "+", 
     RowBox[{"a0", " ", "q2", " ", "y2"}]}], " ", ",", " ", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "e2", " ", "y1"}], "-", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x1", "2"], "-", 
          SuperscriptBox["x2", "2"], "+", 
          RowBox[{"2", " ", "a0", " ", "y1"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "mu2", " ", "y2"}]}], ")"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.586702184237158*^9, 3.586702305275412*^9}, 
   3.586702364130866*^9, {3.586899790575313*^9, 3.586899841378185*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Stability", " ", 
   RowBox[{"Matrix", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.586702890243543*^9, 3.586702904077622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "x1"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "x2"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "y1"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", "y2"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "x1"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "x2"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "y1"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", "y2"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", "x1"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", "x2"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", "y1"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", "y2"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", " ", "x1"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", " ", "x2"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", " ", "y1"}], "]"}], ",", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vx", "[", 
           RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", " ", "y2"}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.586702340398523*^9, 3.58670252641482*^9}, {
  3.586702983064114*^9, 3.586702986703154*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"2", "-", 
   RowBox[{"mode", " ", "SO", 
    RowBox[{"(", "2", ")"}], " ", 
    RowBox[{"generator", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.586702989879264*^9, 3.586702998750343*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.586702761216213*^9, 3.586702798423141*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.586702799139544*^9, 3.586702820605072*^9}, 
   3.586899854239551*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Equivariance", " ", "condition", " ", 
    RowBox[{"(", 
     RowBox[{"ChaosBook", " ", "10.24"}], ")"}]}], ":"}], "*)"}]], "Input",
 CellChangeTimes->{{3.586703001984891*^9, 3.586703014422451*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"T", ".", 
    RowBox[{"vx", "[", 
     RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "]"}]}], " ", "-", " ", 
   
   RowBox[{"A", ".", "T", ".", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "y1", ",", "y2"}], "}"}]}]}], " ", "//", 
  " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.58670284081927*^9, 3.586702864238752*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.586702864742695*^9, 3.586899858545331*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Invariant", " ", "polynomial", " ", "basis"}], "*)"}]], "Input",
 CellChangeTimes->{{3.586703017497979*^9, 3.586703025267047*^9}, {
  3.586703191541963*^9, 3.586703195732661*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"x1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"x2", "[", "t", "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"y1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"y2", "[", "t", "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{
      RowBox[{"x1", "[", "t", "]"}], "^", "2"}], "*", 
     RowBox[{"y1", "[", "t", "]"}]}], " ", "+", " ", 
    RowBox[{"4", "*", 
     RowBox[{"x1", "[", "t", "]"}], "*", 
     RowBox[{"x2", "[", "t", "]"}], "*", 
     RowBox[{"y2", "[", "t", "]"}]}], " ", "-", "  ", 
    RowBox[{"2", "*", 
     RowBox[{
      RowBox[{"x2", "[", "t", "]"}], "^", "2"}], "*", 
     RowBox[{"y1", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], "*", 
     RowBox[{
      RowBox[{"x1", "[", "t", "]"}], "^", "2"}], "*", 
     RowBox[{"y2", "[", "t", "]"}]}], " ", "+", " ", 
    RowBox[{"4", "*", 
     RowBox[{"x1", "[", "t", "]"}], "*", 
     RowBox[{"x2", "[", "t", "]"}], "*", 
     RowBox[{"y1", "[", "t", "]"}]}], " ", "+", "  ", 
    RowBox[{"2", "*", 
     RowBox[{
      RowBox[{"x2", "[", "t", "]"}], "^", "2"}], "*", 
     RowBox[{"y2", "[", "t", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.586703223547352*^9, 3.586703259110553*^9}, {
  3.586703301643054*^9, 3.58670333686935*^9}, {3.586703410782892*^9, 
  3.586703489831552*^9}, {3.586703742867928*^9, 3.586703751260609*^9}, {
  3.586704145055831*^9, 3.58670431450068*^9}, {3.586705454069578*^9, 
  3.586705465402334*^9}}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"u", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.586704322132943*^9, 3.586704333655242*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Input",
 CellChangeTimes->{3.586899874705101*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{3.586899874869659*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"x1", "[", "t", "]"}], " ", 
     RowBox[{
      SuperscriptBox["x1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"x2", "[", "t", "]"}], " ", 
     RowBox[{
      SuperscriptBox["x2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["x1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"vx", "[", 
        RowBox[{
         RowBox[{"x1", "[", "t", "]"}], ",", 
         RowBox[{"x2", "[", "t", "]"}], ",", " ", 
         RowBox[{"y1", "[", "t", "]"}], ",", " ", 
         RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"vx", "[", 
        RowBox[{
         RowBox[{"x1", "[", "t", "]"}], ",", 
         RowBox[{"x2", "[", "t", "]"}], ",", " ", 
         RowBox[{"y1", "[", "t", "]"}], ",", " ", 
         RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.586704335825778*^9, 3.58670442696731*^9}, {
  3.586704531275678*^9, 3.586704536797695*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "q1", " ", 
     RowBox[{"x1", "[", "t", "]"}], " ", 
     RowBox[{"x2", "[", "t", "]"}], " ", 
     RowBox[{"y1", "[", "t", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"mu1", "-", 
       RowBox[{"q1", " ", 
        RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"mu1", "+", 
       RowBox[{"q1", " ", 
        RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.586899879093875*^9, {3.586899966566436*^9, 3.586899974932342*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "q1", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"mu1", "-", 
        RowBox[{"q1", " ", 
         RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"mu1", "+", 
        RowBox[{"q1", " ", 
         RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"x2", "[", "t", "]"}], "^", "2"}]}], " ", "\[Rule]", " ", 
     "u"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"y1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"y2", "[", "t", "]"}], "^", "2"}]}], " ", "\[Rule]", " ", 
     "v"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], "^", "2"}], "*", 
       RowBox[{"y1", "[", "t", "]"}]}], " ", "+", " ", 
      RowBox[{"4", "*", 
       RowBox[{"x1", "[", "t", "]"}], "*", 
       RowBox[{"x2", "[", "t", "]"}], "*", 
       RowBox[{"y2", "[", "t", "]"}]}], " ", "-", "  ", 
      RowBox[{"2", "*", 
       RowBox[{
        RowBox[{"x2", "[", "t", "]"}], "^", "2"}], "*", 
       RowBox[{"y1", "[", "t", "]"}]}]}], " ", "\[Rule]", " ", "w"}], ",", 
    " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], "*", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], "^", "2"}], "*", 
       RowBox[{"y2", "[", "t", "]"}]}], " ", "+", " ", 
      RowBox[{"4", "*", 
       RowBox[{"x1", "[", "t", "]"}], "*", 
       RowBox[{"x2", "[", "t", "]"}], "*", 
       RowBox[{"y1", "[", "t", "]"}]}], " ", "+", "  ", 
      RowBox[{"2", "*", 
       RowBox[{
        RowBox[{"x2", "[", "t", "]"}], "^", "2"}], "*", 
       RowBox[{"y2", "[", "t", "]"}]}]}], " ", "\[Rule]", " ", "q"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.58670465245369*^9, 3.586704729719071*^9}, {
  3.58670548560923*^9, 3.586705488405996*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "q1", " ", 
     RowBox[{"x1", "[", "t", "]"}], " ", 
     RowBox[{"x2", "[", "t", "]"}], " ", 
     RowBox[{"y1", "[", "t", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"mu1", "-", 
       RowBox[{"q1", " ", 
        RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"mu1", "+", 
       RowBox[{"q1", " ", 
        RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.586705224271064*^9, 3.586705490348794*^9, 
  3.586899978918404*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"{", 
    RowBox[{"mu1", ",", "q1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.58670523272076*^9, 3.586705251685998*^9}, {
  3.586899924522006*^9, 3.586899926745413*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "mu1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x1", "[", "t", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"x2", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.586899927379746*^9, 3.586899985896584*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "mu1", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x1", "[", "t", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"x2", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.586705295022709*^9, 3.586705321708021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vu", "=", 
   RowBox[{
    RowBox[{"2", " ", "mu1", " ", "*", "u"}], "+", " ", 
    RowBox[{"q1", " ", "*", "q"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.586705500036442*^9, 3.586705538786254*^9}, {
  3.586705849969053*^9, 3.586705858429783*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"v", ",", "t"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.586705558702517*^9, 3.586705567201137*^9}, {
  3.586705617377998*^9, 3.586705617748825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"y1", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["y1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"y2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["y2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{3.586900052009919*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["y1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["y2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["y1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], " ", "}"}]}]], "Input",
 CellChangeTimes->{{3.586705620429799*^9, 3.58670563945006*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "e2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "-", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x1", "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"x2", "[", "t", "]"}], "2"], "+", 
         RowBox[{"2", " ", "a0", " ", 
          RowBox[{"y1", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "mu2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q2", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "+", 
      RowBox[{"mu2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "+", 
      RowBox[{"e2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}], "+", 
      RowBox[{"a0", " ", "q2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], "//", "FullSimplif"}]], \
"Input",
 CellChangeTimes->{{3.58690010198018*^9, 3.586900105848374*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "e2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "-", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x1", "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"x2", "[", "t", "]"}], "2"], "+", 
         RowBox[{"2", " ", "a0", " ", 
          RowBox[{"y1", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "mu2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q2", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "+", 
      RowBox[{"mu2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "+", 
      RowBox[{"e2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}], "+", 
      RowBox[{"a0", " ", "q2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.58690011040471*^9, 3.586900110509965*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"y1", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q2", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}]}], "+", 
     RowBox[{"mu2", " ", 
      RowBox[{"y1", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"q2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"x2", "[", "t", "]"}], "2"]}], ")"}], " ", 
   RowBox[{"y2", "[", "t", "]"}]}], "+", 
  RowBox[{"2", " ", "mu2", " ", 
   SuperscriptBox[
    RowBox[{"y2", "[", "t", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.586900111022228*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"mu2", ",", "q2", ",", "e2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.586705644028039*^9, 3.586705663113221*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"q2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"x1", "[", "t", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"x2", "[", "t", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"mu2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"y1", "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"y2", "[", "t", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.586705665942127*^9, 3.58690006103508*^9, 
  3.586900114131689*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"vv", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", "*", "mu2", "*", "v"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "/", "2"}], ")"}], "*", "q"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.586705674008845*^9, 3.58670567494314*^9}, {
  3.586705710302363*^9, 3.586705726117404*^9}, {3.586705810516363*^9, 
  3.586705840665509*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"w", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.586705541112393*^9, 3.586705556282935*^9}, {
  3.586705869436651*^9, 3.586705871243096*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{"y1", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{"y2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{"y1", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{"y2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["y1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["y1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["y2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{3.586900134356921*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["x1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["x1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "-", 
   RowBox[{"4", " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["x2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["x2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["y1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["y1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["y2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["x1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", "  ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.586705887458804*^9, 3.586705917349258*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "e2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "-", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x1", "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"x2", "[", "t", "]"}], "2"], "+", 
         RowBox[{"2", " ", "a0", " ", 
          RowBox[{"y1", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "mu2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q2", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "+", 
      RowBox[{"mu2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "+", 
      RowBox[{"e2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}], "+", 
      RowBox[{"a0", " ", "q2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q2", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "+", 
      RowBox[{"mu2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "+", 
      RowBox[{"e2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}], "+", 
      RowBox[{"a0", " ", "q2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "-", 
   RowBox[{"4", " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mu1", " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a0", "+", 
         RowBox[{"y1", "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{"q1", " ", 
       RowBox[{"x2", "[", "t", "]"}], " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mu1", " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a0", "+", 
         RowBox[{"y1", "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{"q1", " ", 
       RowBox[{"x2", "[", "t", "]"}], " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q1", " ", 
       RowBox[{"x2", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a0", "-", 
         RowBox[{"y1", "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"mu1", "+", 
         RowBox[{"q1", " ", 
          RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q1", " ", 
       RowBox[{"x2", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a0", "-", 
         RowBox[{"y1", "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"mu1", "+", 
         RowBox[{"q1", " ", 
          RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.586900147043856*^9, 3.586900152961388*^9}, 
   3.586900195219379*^9}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"x1", "[", "t", "]"}], " ", 
     RowBox[{"x2", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"e2", "-", 
           RowBox[{"2", " ", "a0", " ", "q1"}], "+", 
           RowBox[{"a0", " ", "q2"}]}], ")"}]}], " ", 
        RowBox[{"y1", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], " ", 
        RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], " ", 
        RowBox[{"y1", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e2", "-", 
          RowBox[{"2", " ", "a0", " ", "q1"}], "+", 
          RowBox[{"a0", " ", "q2"}]}], ")"}], " ", 
        RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], " ", 
        RowBox[{"y1", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e2", "-", 
          RowBox[{"2", " ", "a0", " ", "q1"}], "+", 
          RowBox[{"a0", " ", "q2"}]}], ")"}], " ", 
        RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.586900204077949*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"{", 
    RowBox[{
    "mu1", ",", "mu2", ",", "q1", ",", "q2", ",", "e2", ",", "a0", ",", " ", 
     RowBox[{"x1", "[", "t", "]"}], ",", 
     RowBox[{"x2", "[", "t", "]"}], ",", " ", 
     RowBox[{"y1", "[", "t", "]"}], ",", 
     RowBox[{"y2", "[", "t", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.586705866743318*^9, 3.586705867558212*^9}, {
  3.586705929340657*^9, 3.58670594844958*^9}, {3.58670619219154*^9, 
  3.586706237139788*^9}, {3.586900221184376*^9, 3.586900222150442*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mu2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"mu1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{"8", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"e2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"a0", " ", "q2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"a0", " ", "q1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.5867059492702*^9, 3.586706203325506*^9, 3.586706237851424*^9, 
   3.586900180365115*^9, {3.586900217269694*^9, 3.586900223760944*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vw", "=", 
    RowBox[{
     RowBox[{"mu2", " ", "*", "w"}], "+", 
     RowBox[{"2", "*", "mu1", "*", "w"}], "-", 
     RowBox[{
      RowBox[{"(", "e2", ")"}], " ", "*", "q"}], "  ", "-", " ", 
     RowBox[{"a0", "*", "q2", "*", "q"}], " ", "+", " ", 
     RowBox[{"2", "*", "a0", "*", "q1", "*", "q"}]}]}], ";"}], " "}]], "Input",\

 CellChangeTimes->{{3.586706114827679*^9, 3.586706125335514*^9}, 
   3.586706224196854*^9, {3.586706255544616*^9, 3.586706292067686*^9}, {
   3.586706328012396*^9, 3.58670634031874*^9}, {3.586900391282513*^9, 
   3.586900401754354*^9}, {3.586900469068057*^9, 3.586900513879708*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"q", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.586706347800716*^9, 3.586706349309414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{"y1", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{"y2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{"y1", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{"y2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["x2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["y1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["y2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["y2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{3.586900518127611*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"4", " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["x1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "-", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["x1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["x2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["x2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["y1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["y2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["y2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["x1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", "  ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], ",", 
        RowBox[{"x2", "[", "t", "]"}], ",", " ", 
        RowBox[{"y1", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2", "[", "t", "]"}]}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.586706366698696*^9, 3.586706367024187*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"x1", "[", "t", "]"}], "2"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "e2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "-", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x1", "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"x2", "[", "t", "]"}], "2"], "+", 
         RowBox[{"2", " ", "a0", " ", 
          RowBox[{"y1", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "mu2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "e2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "-", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x1", "[", "t", "]"}], "2"], "-", 
         SuperscriptBox[
          RowBox[{"x2", "[", "t", "]"}], "2"], "+", 
         RowBox[{"2", " ", "a0", " ", 
          RowBox[{"y1", "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "mu2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q2", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "+", 
      RowBox[{"mu2", " ", 
       RowBox[{"y1", "[", "t", "]"}]}], "+", 
      RowBox[{"e2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}], "+", 
      RowBox[{"a0", " ", "q2", " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mu1", " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a0", "+", 
         RowBox[{"y1", "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{"q1", " ", 
       RowBox[{"x2", "[", "t", "]"}], " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mu1", " ", 
       RowBox[{"x2", "[", "t", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a0", "+", 
         RowBox[{"y1", "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{"q1", " ", 
       RowBox[{"x2", "[", "t", "]"}], " ", 
       RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"x2", "[", "t", "]"}], " ", 
    RowBox[{"y1", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q1", " ", 
       RowBox[{"x2", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a0", "-", 
         RowBox[{"y1", "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"mu1", "+", 
         RowBox[{"q1", " ", 
          RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
   RowBox[{"4", " ", 
    RowBox[{"x1", "[", "t", "]"}], " ", 
    RowBox[{"y2", "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q1", " ", 
       RowBox[{"x2", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"a0", "-", 
         RowBox[{"y1", "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"mu1", "+", 
         RowBox[{"q1", " ", 
          RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.586900529189319*^9, 3.586900537080186*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"q2", " ", 
   SuperscriptBox[
    RowBox[{"x1", "[", "t", "]"}], "4"]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"x1", "[", "t", "]"}], " ", 
   RowBox[{"x2", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e2", "+", 
        RowBox[{"a0", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]}], ")"}], 
      " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q2", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"y1", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"e2", "-", 
        RowBox[{"2", " ", "a0", " ", "q1"}], "+", 
        RowBox[{"a0", " ", "q2"}], "+", 
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"y1", "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], " ", 
      RowBox[{"y2", "[", "t", "]"}]}], "-", 
     RowBox[{"4", " ", "q1", " ", 
      SuperscriptBox[
       RowBox[{"y2", "[", "t", "]"}], "2"]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q2", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e2", "-", 
        RowBox[{"2", " ", "a0", " ", "q1"}], "+", 
        RowBox[{"a0", " ", "q2"}]}], ")"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", "q1", " ", 
      SuperscriptBox[
       RowBox[{"y1", "[", "t", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"y2", "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "mu1"}], "+", "mu2", "+", 
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.58690053293277*^9, 3.586900538456559*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"{", 
    RowBox[{
    "mu1", ",", "mu2", ",", "q1", ",", "q2", ",", "e2", ",", "a0", ",", " ", 
     RowBox[{"x1", "[", "t", "]"}], ",", 
     RowBox[{"x2", "[", "t", "]"}], ",", " ", 
     RowBox[{"y1", "[", "t", "]"}], ",", 
     RowBox[{"y2", "[", "t", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.586900547452127*^9, 3.586900548948928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"e2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"mu2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"mu1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      RowBox[{"x1", "[", "t", "]"}], " ", 
      RowBox[{"x2", "[", "t", "]"}], " ", 
      RowBox[{"y1", "[", "t", "]"}]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"q2", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"x1", "[", "t", "]"}], "4"], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"x2", "[", "t", "]"}], "4"], "+", 
     RowBox[{"a0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
         RowBox[{"y1", "[", "t", "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
         RowBox[{"y1", "[", "t", "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"x1", "[", "t", "]"}], " ", 
         RowBox[{"x2", "[", "t", "]"}], " ", 
         RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{"q1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         SuperscriptBox[
          RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
         RowBox[{"y1", "[", "t", "]"}]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
         RowBox[{"y1", "[", "t", "]"}]}], "-", 
        RowBox[{"8", " ", 
         RowBox[{"x1", "[", "t", "]"}], " ", 
         RowBox[{"x2", "[", "t", "]"}], " ", 
         RowBox[{"y2", "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         SuperscriptBox[
          RowBox[{"y1", "[", "t", "]"}], "2"]}], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"y2", "[", "t", "]"}], "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"x2", "[", "t", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         SuperscriptBox[
          RowBox[{"y1", "[", "t", "]"}], "2"]}], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"y2", "[", "t", "]"}], "2"]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.58670641698931*^9, {3.586900542073892*^9, 3.586900549371174*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"vq", "=", 
   RowBox[{
    RowBox[{"e2", " ", "*", "w"}], "+", 
    RowBox[{"mu2", " ", "*", "q"}], "+", 
    RowBox[{"mu1", " ", "*", "2", "*", "q"}], "+", 
    RowBox[{"q2", " ", "*", 
     RowBox[{"u", "^", "2"}]}], " ", "+", " ", 
    RowBox[{"q2", "*", "a0", "*", "w"}], "-", 
    RowBox[{"q1", "*", "a0", "*", "w"}], " ", "-", 
    RowBox[{"4", "*", "q1", " ", "*", "u", "*", "v"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.586706494622653*^9, 3.586706554894681*^9}, {
   3.586706588866269*^9, 3.586706698647285*^9}, {3.586900589885838*^9, 
   3.58690059588403*^9}, 3.5869006271326*^9, {3.586900662762058*^9, 
   3.586900677654056*^9}, 3.586900726554213*^9, {3.586900792179493*^9, 
   3.586900795176559*^9}, {3.586900854531708*^9, 3.586900858110176*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Velocity", " ", "function", " ", "in", " ", "the", " ", "invariant", " ", 
   "polynomial", " ", 
   RowBox[{"basis", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.58670690608125*^9, 3.586706918288695*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vinvpol", "[", 
   RowBox[{"u_", ",", "v_", ",", "w_", ",", "q_"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "mu1", " ", "*", "u"}], "+", " ", 
     RowBox[{"q1", " ", "*", "q"}]}], ",", "  ", 
    RowBox[{
     RowBox[{"2", "*", "mu2", "*", "v"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q2", "/", "2"}], ")"}], "*", "q"}]}], ",", " ", 
    RowBox[{
     RowBox[{"mu2", " ", "*", "w"}], "+", 
     RowBox[{"2", "*", "mu1", "*", "w"}], "-", 
     RowBox[{
      RowBox[{"(", "e2", ")"}], " ", "*", "q"}], "  ", "-", " ", 
     RowBox[{"a0", "*", "q2", "*", "q"}], " ", "+", " ", 
     RowBox[{"2", "*", "a0", "*", "q1", "*", "q"}]}], ",", " ", 
    RowBox[{
     RowBox[{"e2", " ", "*", "w"}], "+", 
     RowBox[{"mu2", " ", "*", "q"}], "+", 
     RowBox[{"mu1", " ", "*", "2", "*", "q"}], "+", 
     RowBox[{"q2", " ", "*", 
      RowBox[{"u", "^", "2"}]}], " ", "+", " ", 
     RowBox[{"q2", "*", "a0", "*", "w"}], "-", 
     RowBox[{"q1", "*", "a0", "*", "w"}], " ", "-", 
     RowBox[{"4", "*", "q1", " ", "*", "u", "*", "v"}]}]}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.586706701567669*^9, 3.586706807958028*^9}, 
   3.58670684192729*^9, 3.586707769908706*^9, {3.586900899797372*^9, 
   3.586900932528477*^9}, {3.586900966581438*^9, 3.586900987402215*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.586706847867516*^9, 3.586706873921017*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vinvpol", "[", 
  RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}]], "Input",
 CellChangeTimes->{{3.586706877150425*^9, 3.586706881512929*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"q", " ", "q1"}], "+", 
    RowBox[{"2", " ", "mu1", " ", "u"}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"q", " ", "q2"}], "2"], "+", 
    RowBox[{"2", " ", "mu2", " ", "v"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "e2"}], " ", "q"}], "+", 
    RowBox[{"2", " ", "a0", " ", "q", " ", "q1"}], "-", 
    RowBox[{"a0", " ", "q", " ", "q2"}], "+", 
    RowBox[{"2", " ", "mu1", " ", "w"}], "+", 
    RowBox[{"mu2", " ", "w"}]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "mu1", " ", "q"}], "+", 
    RowBox[{"mu2", " ", "q"}], "+", 
    RowBox[{"q2", " ", 
     SuperscriptBox["u", "2"]}], "-", 
    RowBox[{"4", " ", "q1", " ", "u", " ", "v"}], "+", 
    RowBox[{"e2", " ", "w"}], "-", 
    RowBox[{"a0", " ", "q1", " ", "w"}], "+", 
    RowBox[{"a0", " ", "q2", " ", "w"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.586706882122611*^9, 3.58670778057304*^9, 
  3.586900993166153*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Equilibria", " ", "in", " ", "the", " ", "invariant", " ", "polynomial", 
   " ", 
   RowBox[{"basis", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.586707961023175*^9, 3.58670797433646*^9}}],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"vinvpol", "[", 
     RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.586706864364988*^9, 3.586706864891849*^9}, {
  3.586707895550266*^9, 3.586707921087003*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "\[Rule]", "0"}], ",", 
      RowBox[{"v", "\[Rule]", "0"}], ",", 
      RowBox[{"w", "\[Rule]", "0"}], ",", 
      RowBox[{"q", "\[Rule]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "\[Rule]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", 
            SuperscriptBox["a0", "2"], " ", "mu1", " ", "mu2"}], 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["mu1", "2"]}], "-", 
            SuperscriptBox["mu2", "2"]}]], "-", 
          FractionBox[
           RowBox[{"8", " ", "a0", " ", "e2", " ", "mu1", " ", "mu2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1"}]], "+", 
          FractionBox[
           RowBox[{"12", " ", "a0", " ", "e2", " ", "mu1", " ", "mu2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q2"}]], "-", 
          FractionBox[
           RowBox[{"4", " ", 
            SuperscriptBox["e2", "2"], " ", "mu1", " ", "mu2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1", " ", "q2"}]], 
          "-", 
          FractionBox[
           RowBox[{"16", " ", 
            SuperscriptBox["mu1", "3"], " ", "mu2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1", " ", "q2"}]], 
          "-", 
          FractionBox[
           RowBox[{"16", " ", 
            SuperscriptBox["mu1", "2"], " ", 
            SuperscriptBox["mu2", "2"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1", " ", "q2"}]], 
          "-", 
          FractionBox[
           RowBox[{"4", " ", "mu1", " ", 
            SuperscriptBox["mu2", "3"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1", " ", "q2"}]], 
          "-", 
          FractionBox[
           RowBox[{"8", " ", 
            SuperscriptBox["a0", "2"], " ", "mu1", " ", "mu2", " ", "q1"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q2"}]], "-", 
          FractionBox[
           RowBox[{"4", " ", 
            SuperscriptBox["a0", "2"], " ", "mu1", " ", "mu2", " ", "q2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1"}]]}], ")"}]}]}], 
      ",", 
      RowBox[{"v", "\[Rule]", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"8", " ", 
             SuperscriptBox["a0", "2"], " ", 
             SuperscriptBox["mu1", "2"]}], 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["mu1", "2"]}], "-", 
             SuperscriptBox["mu2", "2"]}]]}], "-", 
          FractionBox[
           RowBox[{"4", " ", 
            SuperscriptBox["e2", "2"], " ", 
            SuperscriptBox["mu1", "2"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", 
            SuperscriptBox["q1", "2"]}]], "-", 
          FractionBox[
           RowBox[{"16", " ", 
            SuperscriptBox["mu1", "4"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", 
            SuperscriptBox["q1", "2"]}]], "-", 
          FractionBox[
           RowBox[{"16", " ", 
            SuperscriptBox["mu1", "3"], " ", "mu2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", 
            SuperscriptBox["q1", "2"]}]], "-", 
          FractionBox[
           RowBox[{"4", " ", 
            SuperscriptBox["mu1", "2"], " ", 
            SuperscriptBox["mu2", "2"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", 
            SuperscriptBox["q1", "2"]}]], "+", 
          FractionBox[
           RowBox[{"12", " ", "a0", " ", "e2", " ", 
            SuperscriptBox["mu1", "2"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1"}]], "-", 
          FractionBox[
           RowBox[{"8", " ", "a0", " ", "e2", " ", 
            SuperscriptBox["mu1", "2"], " ", "q2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", 
            SuperscriptBox["q1", "2"]}]], "+", 
          FractionBox[
           RowBox[{"12", " ", 
            SuperscriptBox["a0", "2"], " ", 
            SuperscriptBox["mu1", "2"], " ", "q2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1"}]], "-", 
          FractionBox[
           RowBox[{"4", " ", 
            SuperscriptBox["a0", "2"], " ", 
            SuperscriptBox["mu1", "2"], " ", 
            SuperscriptBox["q2", "2"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["mu1", "2"]}], "-", 
              SuperscriptBox["mu2", "2"]}], ")"}], " ", 
            SuperscriptBox["q1", "2"]}]]}], ")"}]}]}], ",", 
      RowBox[{"w", "\[Rule]", 
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", " ", 
           SuperscriptBox["mu1", "2"], " ", "mu2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "e2"}], "+", 
             RowBox[{"2", " ", "a0", " ", "q1"}], "-", 
             RowBox[{"a0", " ", "q2"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["e2", "2"], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["mu1", "2"]}], "+", 
             RowBox[{"4", " ", "mu1", " ", "mu2"}], "+", 
             SuperscriptBox["mu2", "2"], "-", 
             RowBox[{"3", " ", "a0", " ", "e2", " ", "q1"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["a0", "2"], " ", 
              SuperscriptBox["q1", "2"]}], "+", 
             RowBox[{"2", " ", "a0", " ", "e2", " ", "q2"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["a0", "2"], " ", "q1", " ", "q2"}], "+", 
             RowBox[{
              SuperscriptBox["a0", "2"], " ", 
              SuperscriptBox["q2", "2"]}]}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "mu1"}], "-", "mu2"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], "2"], " ", 
           SuperscriptBox["q1", "2"], " ", "q2"}], ")"}]}]}]}], ",", 
      RowBox[{"q", "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", " ", 
          SuperscriptBox["mu1", "2"], " ", "mu2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["e2", "2"], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["mu1", "2"]}], "+", 
            RowBox[{"4", " ", "mu1", " ", "mu2"}], "+", 
            SuperscriptBox["mu2", "2"], "-", 
            RowBox[{"3", " ", "a0", " ", "e2", " ", "q1"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["a0", "2"], " ", 
             SuperscriptBox["q1", "2"]}], "+", 
            RowBox[{"2", " ", "a0", " ", "e2", " ", "q2"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["a0", "2"], " ", "q1", " ", "q2"}], "+", 
            RowBox[{
             SuperscriptBox["a0", "2"], " ", 
             SuperscriptBox["q2", "2"]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["mu1", "2"]}], "-", 
            SuperscriptBox["mu2", "2"]}], ")"}], " ", 
          SuperscriptBox["q1", "2"], " ", "q2"}], ")"}]}]}]}], "}"}]}], "}"}],
   "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.586901030401216*^9, 3.586901030461715*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "\[Rule]", "0"}], ",", 
     RowBox[{"v", "\[Rule]", "0"}], ",", 
     RowBox[{"w", "\[Rule]", "0"}], ",", 
     RowBox[{"q", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", "mu1", " ", "mu2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"e2", "+", 
               RowBox[{"a0", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"e2", "+", 
               RowBox[{"a0", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["mu1", "2"]}], "-", 
            SuperscriptBox["mu2", "2"]}], ")"}], " ", "q1", " ", "q2"}], 
         ")"}]}]}]}], ",", 
     RowBox[{"v", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["mu1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"e2", "+", 
               RowBox[{"a0", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"e2", "+", 
               RowBox[{"a0", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["mu1", "2"]}], "-", 
            SuperscriptBox["mu2", "2"]}], ")"}], " ", 
          SuperscriptBox["q1", "2"]}], ")"}]}]}]}], ",", 
     RowBox[{"w", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", " ", 
         SuperscriptBox["mu1", "2"], " ", "mu2", " ", 
         RowBox[{"(", 
          RowBox[{"e2", "+", 
           RowBox[{"a0", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]}], ")"}],
          " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"e2", "+", 
              RowBox[{"a0", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]}], 
             ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"e2", "+", 
              RowBox[{"a0", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "mu1"}], "-", "mu2"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], "2"], " ", 
         SuperscriptBox["q1", "2"], " ", "q2"}], ")"}]}]}], ",", 
     RowBox[{"q", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", " ", 
         SuperscriptBox["mu1", "2"], " ", "mu2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ")"}], "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"e2", "+", 
              RowBox[{"a0", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]}], 
             ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"e2", "+", 
              RowBox[{"a0", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["mu1", "2"]}], "-", 
           SuperscriptBox["mu2", "2"]}], ")"}], " ", 
         SuperscriptBox["q1", "2"], " ", "q2"}], ")"}]}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.586901032155399*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ainvpol", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "u"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "v"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "w"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", "q"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "u"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "v"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "w"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "q"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", "u"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", "v"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", "w"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", "q"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", " ", "u"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", " ", "v"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", " ", "w"}], "]"}], ",", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vinvpol", "[", 
          RowBox[{"u", ",", "v", ",", "w", ",", "q"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", " ", "q"}], "]"}]}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.586709238461682*^9, 3.586709471132393*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", "mu1"}], ",", "0", ",", "0", ",", "q1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"2", " ", "mu2"}], ",", "0", ",", 
     FractionBox["q2", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ",", 
     RowBox[{
      RowBox[{"-", "e2"}], "+", 
      RowBox[{"2", " ", "a0", " ", "q1"}], "-", 
      RowBox[{"a0", " ", "q2"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", "q2", " ", "u"}], "-", 
      RowBox[{"4", " ", "q1", " ", "v"}]}], ",", 
     RowBox[{
      RowBox[{"-", "4"}], " ", "q1", " ", "u"}], ",", 
     RowBox[{"e2", "-", 
      RowBox[{"a0", " ", "q1"}], "+", 
      RowBox[{"a0", " ", "q2"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "mu1"}], "+", "mu2"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.586709471913424*^9, 3.586901036562899*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", " ", "mu1"}], ",", "0", ",", "0", ",", "q1"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"2", " ", "mu2"}], ",", "0", ",", 
      FractionBox["q2", "2"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ",", 
      RowBox[{
       RowBox[{"-", "e2"}], "+", 
       RowBox[{"2", " ", "a0", " ", "q1"}], "-", 
       RowBox[{"a0", " ", "q2"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", "q2", " ", "u"}], "-", 
       RowBox[{"4", " ", "q1", " ", "v"}]}], ",", 
      RowBox[{
       RowBox[{"-", "4"}], " ", "q1", " ", "u"}], ",", 
      RowBox[{"e2", "-", 
       RowBox[{"a0", " ", "q1"}], "+", 
       RowBox[{"a0", " ", "q2"}]}], ",", 
      RowBox[{
       RowBox[{"2", " ", "mu1"}], "+", "mu2"}]}], "}"}]}], "}"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"u", "\[Rule]", "0"}], ",", 
    RowBox[{"v", "\[Rule]", "0"}], ",", 
    RowBox[{"w", "\[Rule]", "0"}], ",", 
    RowBox[{"q", "\[Rule]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.586711375345029*^9, 3.586711393790345*^9}, 
   3.586901054323767*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", " ", "mu1"}], ",", "0", ",", "0", ",", "q1"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"2", " ", "mu2"}], ",", "0", ",", 
      FractionBox["q2", "2"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{
       RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ",", 
      RowBox[{
       RowBox[{"-", "e2"}], "+", 
       RowBox[{"2", " ", "a0", " ", "q1"}], "-", 
       RowBox[{"a0", " ", "q2"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"e2", "-", 
       RowBox[{"a0", " ", "q1"}], "+", 
       RowBox[{"a0", " ", "q2"}]}], ",", 
      RowBox[{
       RowBox[{"2", " ", "mu1"}], "+", "mu2"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.586901070296665*^9, 3.586901070375198*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", "mu1"}], ",", "0", ",", "0", ",", "q1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"2", " ", "mu2"}], ",", "0", ",", 
     FractionBox["q2", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"2", " ", "mu1"}], "+", "mu2"}], ",", 
     RowBox[{
      RowBox[{"-", "e2"}], "+", 
      RowBox[{"2", " ", "a0", " ", "q1"}], "-", 
      RowBox[{"a0", " ", "q2"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"e2", "-", 
      RowBox[{"a0", " ", "q1"}], "+", 
      RowBox[{"a0", " ", "q2"}]}], ",", 
     RowBox[{
      RowBox[{"2", " ", "mu1"}], "+", "mu2"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.586901071380901*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "A0", "]"}]], "Input",
 CellChangeTimes->{{3.586711420560266*^9, 3.586711430692382*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"2", " ", "mu1"}], ",", 
    RowBox[{"2", " ", "mu2"}], ",", 
    RowBox[{
     RowBox[{"2", " ", "mu1"}], "+", "mu2", "-", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["e2", "2"]}], "+", 
       RowBox[{"3", " ", "a0", " ", "e2", " ", "q1"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["a0", "2"], " ", 
        SuperscriptBox["q1", "2"]}], "-", 
       RowBox[{"2", " ", "a0", " ", "e2", " ", "q2"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["a0", "2"], " ", "q1", " ", "q2"}], "-", 
       RowBox[{
        SuperscriptBox["a0", "2"], " ", 
        SuperscriptBox["q2", "2"]}]}]]}], ",", 
    RowBox[{
     RowBox[{"2", " ", "mu1"}], "+", "mu2", "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["e2", "2"]}], "+", 
       RowBox[{"3", " ", "a0", " ", "e2", " ", "q1"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["a0", "2"], " ", 
        SuperscriptBox["q1", "2"]}], "-", 
       RowBox[{"2", " ", "a0", " ", "e2", " ", "q2"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["a0", "2"], " ", "q1", " ", "q2"}], "-", 
       RowBox[{
        SuperscriptBox["a0", "2"], " ", 
        SuperscriptBox["q2", "2"]}]}]]}]}], "}"}], "//", "FullSimplify"}]], \
"Input",
 CellChangeTimes->{{3.586901088032654*^9, 3.586901088099881*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", "mu1"}], ",", 
   RowBox[{"2", " ", "mu2"}], ",", 
   RowBox[{
    RowBox[{"2", " ", "mu1"}], "+", "mu2", "-", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"e2", "-", 
         RowBox[{"2", " ", "a0", " ", "q1"}], "+", 
         RowBox[{"a0", " ", "q2"}]}], ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{"e2", "-", 
        RowBox[{"a0", " ", "q1"}], "+", 
        RowBox[{"a0", " ", "q2"}]}], ")"}]}]]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "mu1"}], "+", "mu2", "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"e2", "-", 
         RowBox[{"2", " ", "a0", " ", "q1"}], "+", 
         RowBox[{"a0", " ", "q2"}]}], ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{"e2", "-", 
        RowBox[{"a0", " ", "q1"}], "+", 
        RowBox[{"a0", " ", "q2"}]}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.586901089340942*^9}]
}, Open  ]]
},
WindowSize->{693, 915},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"9.0 for Linux x86 (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 427, 10, 55, "Input"],
Cell[830, 25, 257, 6, 32, "Input"],
Cell[1090, 33, 1066, 31, 77, "Input"],
Cell[2159, 66, 222, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[2406, 74, 1671, 40, 99, "Input"],
Cell[4080, 116, 614, 18, 55, "Output"]
}, Open  ]],
Cell[4709, 137, 225, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[4959, 145, 1158, 34, 99, "Input"],
Cell[6120, 181, 765, 23, 82, "Output"]
}, Open  ]],
Cell[6900, 207, 213, 5, 32, "Input"],
Cell[7116, 214, 1421, 40, 155, "Input"],
Cell[8540, 256, 172, 4, 32, "Input"],
Cell[8715, 262, 4267, 114, 363, "Input"],
Cell[12985, 378, 236, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[13246, 388, 510, 14, 32, "Input"],
Cell[13759, 404, 503, 14, 32, "Output"]
}, Open  ]],
Cell[14277, 421, 251, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[14553, 431, 390, 11, 32, "Input"],
Cell[14946, 444, 157, 3, 32, "Output"]
}, Open  ]],
Cell[15118, 450, 220, 4, 32, "Input"],
Cell[15341, 456, 1838, 52, 143, "Input"],
Cell[17182, 510, 143, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[17350, 517, 403, 12, 32, InheritFromParent],
Cell[17756, 531, 404, 12, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18197, 548, 1510, 41, 83, "Input"],
Cell[19710, 591, 779, 24, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20526, 620, 2445, 72, 172, "Input"],
Cell[22974, 694, 777, 24, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23788, 723, 254, 6, 32, "Input"],
Cell[24045, 731, 820, 25, 62, "Output"]
}, Open  ]],
Cell[24880, 759, 821, 25, 62, "Input"],
Cell[25704, 786, 285, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[26014, 797, 211, 5, 32, "Input"],
Cell[26228, 804, 404, 12, 32, "Output"]
}, Open  ]],
Cell[26647, 819, 1375, 39, 81, "Input"],
Cell[28025, 860, 1183, 35, 81, InheritFromParent],
Cell[CellGroupData[{
Cell[29233, 899, 1186, 34, 108, InheritFromParent],
Cell[30422, 935, 725, 23, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31184, 963, 212, 5, 32, "Input"],
Cell[31399, 970, 878, 28, 62, "Output"]
}, Open  ]],
Cell[32292, 1001, 391, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[32708, 1015, 192, 4, 32, "Input"],
Cell[32903, 1021, 1486, 44, 78, "Output"]
}, Open  ]],
Cell[34404, 1068, 3379, 95, 170, "Input"],
Cell[CellGroupData[{
Cell[37808, 1167, 3833, 114, 258, InheritFromParent],
Cell[41644, 1283, 1713, 53, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43394, 1341, 576, 12, 55, "Input"],
Cell[43973, 1355, 2757, 81, 137, "Output"]
}, Open  ]],
Cell[46745, 1439, 664, 15, 32, "Input"],
Cell[CellGroupData[{
Cell[47434, 1458, 143, 3, 32, "Input"],
Cell[47580, 1463, 1486, 44, 78, "Output"]
}, Open  ]],
Cell[49081, 1510, 3379, 95, 171, "Input"],
Cell[CellGroupData[{
Cell[52485, 1609, 3972, 119, 308, InheritFromParent],
Cell[56460, 1730, 2351, 73, 157, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58848, 1808, 434, 10, 55, "Input"],
Cell[59285, 1820, 3922, 119, 187, "Output"]
}, Open  ]],
Cell[63222, 1942, 797, 16, 55, "Input"],
Cell[64022, 1960, 253, 6, 32, "Input"],
Cell[64278, 1968, 1373, 33, 121, "Input"],
Cell[65654, 2003, 167, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[65846, 2010, 169, 3, 32, "Input"],
Cell[66018, 2015, 965, 27, 104, "Output"]
}, Open  ]],
Cell[66998, 2045, 238, 6, 32, "Input"],
Cell[67239, 2053, 449, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[67713, 2068, 9884, 266, 822, InheritFromParent],
Cell[77600, 2336, 5353, 163, 317, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82990, 2504, 4072, 109, 385, "Input"],
Cell[87065, 2615, 1012, 30, 104, "Output"]
}, Open  ]],
Cell[88092, 2648, 1287, 39, 135, "Input"],
Cell[CellGroupData[{
Cell[89404, 2691, 904, 27, 112, InheritFromParent],
Cell[90311, 2720, 829, 25, 104, "Output"]
}, Open  ]],
Cell[91155, 2748, 131, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[91311, 2754, 1398, 39, 212, InheritFromParent],
Cell[92712, 2795, 977, 31, 108, "Output"]
}, Open  ]]
}
]
*)

