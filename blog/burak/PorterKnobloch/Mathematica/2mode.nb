(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    107697,       3078]
NotebookOptionsPosition[    100407,       2888]
NotebookOutlinePosition[    100744,       2903]
CellTagsIndexPosition[    100701,       2900]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"2", "-", 
   RowBox[{"mode", " ", "velocity", " ", 
    RowBox[{"function", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602289109125456*^9, 3.60228911767342*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", " ", "y1_", " ", ",", "x2_", ",", " ", "y2_"}], 
     "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Mu]", "1"], "+", 
         RowBox[{
          SubscriptBox["a", "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], " ", "+", " ", 
            RowBox[{"y1", "^", "2"}]}], ")"}]}], " ", "+", " ", 
         RowBox[{
          SubscriptBox["b", "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x2", "^", "2"}], " ", "+", " ", 
            RowBox[{"y2", "^", "2"}]}], ")"}]}]}], ")"}], "x1"}], " ", "+", 
      " ", 
      RowBox[{
       SubscriptBox["c", "1"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", " ", "x2"}], " ", "+", " ", 
         RowBox[{"y1", " ", "y2"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Mu]", "1"], "+", 
         RowBox[{
          SubscriptBox["a", "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], " ", "+", " ", 
            RowBox[{"y1", "^", "2"}]}], ")"}]}], " ", "+", " ", 
         RowBox[{
          SubscriptBox["b", "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x2", "^", "2"}], " ", "+", " ", 
            RowBox[{"y2", "^", "2"}]}], ")"}]}]}], ")"}], "y1"}], " ", "+", 
      " ", 
      RowBox[{
       SubscriptBox["c", "1"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", " ", "y2"}], " ", "-", " ", 
         RowBox[{"x2", " ", "y1"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Mu]", "2"], "+", 
         RowBox[{
          SubscriptBox["a", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], " ", "+", " ", 
            RowBox[{"y1", "^", "2"}]}], ")"}]}], " ", "+", " ", 
         RowBox[{
          SubscriptBox["b", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x2", "^", "2"}], " ", "+", " ", 
            RowBox[{"y2", "^", "2"}]}], ")"}]}]}], ")"}], "x2"}], " ", "+", 
      " ", 
      RowBox[{
       SubscriptBox["c", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", "^", "2"}], " ", "-", " ", 
         RowBox[{"y1", "^", "2"}]}], ")"}]}], " ", "+", " ", 
      RowBox[{
       SubscriptBox["e", "2"], "y2"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Mu]", "2"], "+", 
         RowBox[{
          SubscriptBox["a", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], " ", "+", " ", 
            RowBox[{"y1", "^", "2"}]}], ")"}]}], " ", "+", " ", 
         RowBox[{
          SubscriptBox["b", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x2", "^", "2"}], " ", "+", " ", 
            RowBox[{"y2", "^", "2"}]}], ")"}]}]}], ")"}], "y2"}], " ", "+", 
      " ", 
      RowBox[{"2", 
       SubscriptBox["c", "2"], "x1", " ", "y1"}], " ", "-", " ", 
      RowBox[{
       SubscriptBox["e", "2"], "x2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6022883183739243`*^9, 3.602288368274455*^9}, {
  3.6022884915669203`*^9, 3.602288623043892*^9}, {3.602288685454487*^9, 
  3.602288740769343*^9}, {3.602289260300633*^9, 3.602289263990617*^9}, {
  3.602289600423999*^9, 3.602289639629921*^9}, {3.602373271904031*^9, 
  3.6023733321545753`*^9}, {3.602373362921417*^9, 3.602373456537291*^9}, {
  3.602373491643374*^9, 3.602373704592166*^9}, {3.6023737637082367`*^9, 
  3.602373816472234*^9}, {3.602375777195381*^9, 3.602375777316711*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Paremeters", " ", "that", " ", "are", " ", "0", " ", "or", " ", "1"}], 
   "*)"}], 
  RowBox[{
   RowBox[{"par01", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "2"], "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{
       SubscriptBox["e", "2"], "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{
       SubscriptBox["a", "1"], "\[Rule]", " ", 
       RowBox[{"-", "1"}]}], ",", " ", 
      RowBox[{
       SubscriptBox["b", "1"], "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{
       SubscriptBox["b", "2"], "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{
       SubscriptBox["c", "2"], "\[Rule]", " ", "1"}]}], "}"}]}], " ", ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.602373979332883*^9, 3.602374089448127*^9}, 
   3.602374272655097*^9, {3.602376679149911*^9, 3.602376694918766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pars", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "\[Rule]", " ", 
       RowBox[{"-", "2.8"}]}], ",", " ", 
      RowBox[{
       SubscriptBox["a", "2"], "\[Rule]", " ", 
       RowBox[{"-", "2.66"}]}], ",", " ", 
      RowBox[{
       SubscriptBox["c", "1"], "\[Rule]", " ", 
       RowBox[{"-", "7.75"}]}]}], "}"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.602373964267107*^9, 3.602373999327221*^9}, {
  3.6023742432118597`*^9, 3.602374269803762*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vpars", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "y1_", ",", "x2_", ",", "y2_"}], "}"}], "]"}], " ", ":=",
   " ", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "y1", ",", " ", "x2", ",", " ", "y2"}], "}"}], 
     "]"}], " ", "/.", " ", "par01"}], " ", "/.", " ", "pars"}]}]], "Input",
 CellChangeTimes->{{3.602374568155683*^9, 3.602374586052074*^9}, {
   3.60237462145328*^9, 3.602374949943984*^9}, 3.602375341108374*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"{", 
    RowBox[{"0.439966", ",", "0", ",", 
     RowBox[{"-", "0.386267"}], ",", "0.070204"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6023763562134132`*^9, 3.6023763610382338`*^9}, {
  3.6023767374003277`*^9, 3.602376769362794*^9}, {3.6023768083805*^9, 
  3.602376819569818*^9}, {3.602378052776935*^9, 3.602378061438949*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"10.7", " ", "-", " ", 
   RowBox[{"Integrating", " ", "the", " ", "two"}], "-", 
   RowBox[{"mode", " ", 
    RowBox[{"system", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023782619005203`*^9, 3.602378275925891*^9}, {
  3.6023800443875732`*^9, 3.602380053773481*^9}, {3.602380212907579*^9, 
  3.6023802325620317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x1sol", "'"}], "[", "t", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"y1sol", "'"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{"x2sol", "'"}], "[", "t", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"y2sol", "'"}], "[", "t", "]"}]}], " ", " ", "}"}], " ", 
        "\[Equal]", " ", 
        RowBox[{"vpars", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1sol", "[", "t", "]"}], ",", " ", 
           RowBox[{"y1sol", "[", "t", "]"}], ",", " ", 
           RowBox[{"x2sol", "[", "t", "]"}], ",", " ", 
           RowBox[{"y2sol", "[", "t", "]"}]}], "}"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1sol", "[", "0", "]"}], ",", " ", 
          RowBox[{"y1sol", "[", "0", "]"}], ",", 
          RowBox[{"x2sol", "[", "0", "]"}], ",", " ", 
          RowBox[{"y2sol", "[", "0", "]"}]}], " ", "}"}], "==", " ", "x0"}]}],
       "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x1sol", ",", "y1sol", ",", "x2sol", ",", "y2sol"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "400"}], "}"}], ",", " ", 
     RowBox[{"MaxSteps", "\[Rule]", " ", "\[Infinity]"}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<ExplicitRungeKutta\>\"", ",", " ", 
        RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", " ", "8"}]}], "}"}]}], 
     ",", " ", 
     RowBox[{"InterpolationOrder", "\[Rule]", " ", "All"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.602375569068218*^9, 3.602375743295599*^9}, {
   3.602376067429967*^9, 3.602376083419792*^9}, {3.6023764391489983`*^9, 
   3.602376458739222*^9}, {3.602376719733315*^9, 3.6023767290742188`*^9}, 
   3.60237677486347*^9, {3.602376839003395*^9, 3.602376861084032*^9}, {
   3.602376934202798*^9, 3.602376934958788*^9}, {3.602376994665213*^9, 
   3.602376995027017*^9}, {3.602377208302931*^9, 3.602377251819335*^9}, {
   3.6023773890133038`*^9, 3.602377389360962*^9}, {3.602377467536146*^9, 
   3.602377487607871*^9}, {3.602377768307022*^9, 3.602377887706354*^9}, {
   3.6023779454159307`*^9, 3.602377990730667*^9}, 3.602378024378107*^9, {
   3.6023780673428793`*^9, 3.602378067587859*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Plot", ":"}], "*)"}]], "Input",
 CellChangeTimes->{{3.602378279386895*^9, 3.602378284342739*^9}}],

Cell[BoxData[
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1sol", "[", "t", "]"}], ",", " ", 
       RowBox[{"y1sol", "[", "t", "]"}], ",", " ", 
       RowBox[{"x2sol", "[", "t", "]"}]}], "}"}], "/.", "sol"}], " ", "]"}], 
   ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "400"}], "}"}], ",", " ", 
   RowBox[{"PlotPoints", "\[Rule]", " ", "4000"}], ",", " ", 
   RowBox[{"Boxed", "\[Rule]", " ", "False"}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["y", "1"], ",", 
      SubscriptBox["x", "2"]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6023778995539017`*^9, 3.602377922611302*^9}, {
  3.60237799748151*^9, 3.602378005628083*^9}, {3.6023780897801027`*^9, 
  3.602378113873769*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"10", "A", ".6"}], " ", "-", " ", 
    RowBox[{"Invariant", " ", "subspace", " ", "of", " ", "the", " ", "two"}],
     "-", 
    RowBox[{"mode", " ", 
     RowBox[{"system", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"v", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", " ", "x2", ",", " ", "y2"}], "}"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602378307469172*^9, 3.6023783342370777`*^9}, {
  3.6023799956202497`*^9, 3.602380017665907*^9}, {3.6023800580649652`*^9, 
  3.6023800599757843`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"SO", 
   RowBox[{"(", "2", ")"}], " ", "Lie", " ", "algebra", " ", 
   RowBox[{"generator", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6022891208966913`*^9, 3.602289130723175*^9}, {
  3.602373295363654*^9, 3.602373296201315*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602289060392935*^9, 3.602289104971964*^9}, {
   3.602289270006153*^9, 3.602289273657261*^9}, {3.602289326903109*^9, 
   3.6022893277014313`*^9}, 3.602289649292474*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Phase", " ", 
    RowBox[{"velocity", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"v\[Phi]", " ", "[", "xRed_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "[", "xRed", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"T", ".", "xp"}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"T", ".", "xRed"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"T", ".", "xp"}], ")"}]}], ")"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.602378538931941*^9, 3.602378688681425*^9}, 
   3.602378963697246*^9, {3.602388256412681*^9, 3.602388257241909*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Velocity", " ", "within", " ", "the", " ", 
    RowBox[{"slice", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vred", "[", "xRed_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"v", "[", "xRed", "]"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"v\[Phi]", "[", "xRed", "]"}], 
     RowBox[{"(", 
      RowBox[{"T", ".", "xRed"}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.602378418576666*^9, 3.6023785376952353`*^9}, {
   3.602378698854261*^9, 3.6023786999201717`*^9}, {3.602378731222864*^9, 
   3.6023787904949903`*^9}, 3.602379828318365*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"10", "A", ".7", "a"}], " ", "-", " ", 
   RowBox[{
   "Phase", " ", "velocity", " ", "for", " ", "the", " ", "1", "st", " ", 
    "mode", " ", 
    RowBox[{"slice", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023788322786293`*^9, 3.602378857787888*^9}, {
   3.602379967143619*^9, 3.602379975163453*^9}, {3.602380021936184*^9, 
   3.6023800223212633`*^9}, 3.602380063196188*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"slicep", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602378805595993*^9, 3.602378814414839*^9}}],

Cell[BoxData[
 RowBox[{"v\[Phi]1stmode", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"v\[Phi]", "[", 
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "y1", ",", " ", "x2", ",", " ", "y2"}], "}"}], 
     "]"}], " ", "/.", " ", 
    RowBox[{"xp", " ", "->", " ", "slicep"}]}], " ", "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.602378829611517*^9, 3.602378830193447*^9}, {
   3.602378863029531*^9, 3.6023789048049393`*^9}, 3.602379076177697*^9, {
   3.602379439397353*^9, 3.6023794420308247`*^9}, {3.602379627690853*^9, 
   3.602379643710849*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Note", " ", "that", " ", "numerator"}], " ", "=", " ", 
   RowBox[{"v", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{3.6023798513410788`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"10", "A", ".7", "b"}], ",", " ", "c", ",", " ", 
   RowBox[{
    RowBox[{"d", ":", " ", 
     RowBox[{"Slice", " ", "hyperplane", " ", "border"}], ":", " ", "x1"}], 
    "=", "0"}], ",", " ", 
   RowBox[{
    RowBox[{"d", " ", "-", " ", "2"}], " ", "=", " ", 
    RowBox[{"2", " ", "dimensional"}]}], ",", " ", 
   RowBox[{
   "it", " ", "is", " ", "the", " ", "invariant", " ", "subspace", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x1", "=", "0"}], ",", " ", 
      RowBox[{"y1", "=", "0"}]}], ")"}]}], ",", " ", 
   RowBox[{
   "symmetry", " ", "reduced", " ", "trajectory", " ", "cannot", " ", "cross",
     " ", "the", " ", "slice", " ", "hpyerplane", " ", "border"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.602379941018127*^9, 3.602379963947145*^9}, {
  3.602380068034153*^9, 3.6023801754137497`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Reduced", " ", "velocity", " ", 
   RowBox[{"function", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6022898437243633`*^9, 3.602289851485322*^9}}],

Cell[BoxData[
 RowBox[{"vred1stmode", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"vred", "[", 
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "y1", ",", " ", "x2", ",", " ", "y2"}], "}"}], 
     "]"}], " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xp", "\[Rule]", " ", "slicep"}], ",", " ", 
      RowBox[{"y1", " ", "\[Rule]", " ", "0"}]}], "}"}]}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6022889513209257`*^9, 3.602288983009194*^9}, {
   3.602289017586494*^9, 3.602289051589563*^9}, {3.602289177105431*^9, 
   3.6022891881123743`*^9}, {3.60228928263901*^9, 3.6022893046021967`*^9}, {
   3.602289398336329*^9, 3.602289423978106*^9}, {3.602289522442176*^9, 
   3.6022895289558287`*^9}, {3.602289767140381*^9, 3.602289809768064*^9}, 
   3.6022899574658947`*^9, {3.602379491072571*^9, 3.602379520262792*^9}, {
   3.602379565885529*^9, 3.6023795666400537`*^9}, 3.602379603440617*^9, {
   3.602379723849682*^9, 3.6023797667765207`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"10", "A", ".10"}], " ", "-", " ", 
   RowBox[{"Relative", " ", 
    RowBox[{"equilibria", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602380381064828*^9, 3.602380391086191*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Search", " ", "for", " ", "relative", " ", "equilibria", " ", "in", " ", 
   "the", " ", "invariant", " ", 
   RowBox[{"subspace", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023803927662573`*^9, 3.6023804199415913`*^9}}],

Cell[BoxData[
 RowBox[{"vRedInvssp", " ", "=", " ", 
  RowBox[{"vred1stmode", " ", "/.", " ", 
   RowBox[{"x1", " ", "\[Rule]", " ", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.602380422688972*^9, 3.6023804497286654`*^9}, {
  3.6023804982573*^9, 3.6023804997123623`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"vRedInvssp", "\[Equal]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x2", ",", "y2"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.602380521423779*^9, 3.602380624111775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "are", " ", "only", " ", "interested", " ", "in", " ", "the", 
     " ", "real", " ", "roots"}], ",", " ", 
    RowBox[{"so", " ", "the", " ", "last", " ", "two", " ", "are", " ", 
     RowBox[{"unimportant", "."}]}]}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"First", " ", "two", " ", "non"}], "-", 
    RowBox[{
    "zero", " ", "roots", " ", "correspond", " ", "to", " ", "the", " ", 
     "relative", " ", "equilibrium", " ", "that", " ", "we", " ", 
     "previously", " ", "found", " ", "using", " ", "Hilbert", " ", 
     RowBox[{"basis", ".", " ", "Slice"}], " ", "does", " ", "the", " ", 
     RowBox[{"job", ":"}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.602380725483144*^9, 3.602380829726467*^9}, {
  3.602382544701442*^9, 3.602382548226878*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x2", "^", "2"}], " ", "+", " ", 
    RowBox[{"y2", "^", "2"}]}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["b", "2"]}], " ", 
           SubsuperscriptBox["e", "2", "2"]}], "-", 
          RowBox[{"4", " ", 
           SubsuperscriptBox["c", "1", "2"], " ", 
           SubscriptBox["\[Mu]", "2"]}]}]], 
        RowBox[{"2", " ", 
         SqrtBox[
          SubscriptBox["b", "2"]], " ", 
         SubscriptBox["c", "1"]}]]}]}], ",", 
     RowBox[{"y2", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SubscriptBox["e", "2"], 
        RowBox[{"2", " ", 
         SubscriptBox["c", "1"]}]]}]}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.602380682434764*^9, 3.6023807058477287`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Search", " ", "for", " ", "relative", " ", "equilibria", " ", "within", 
   " ", "the", " ", 
   RowBox[{"slice", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602380846327599*^9, 3.602380857904376*^9}}],

Cell[BoxData[
 RowBox[{"vred1stmode", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60238086217054*^9, 3.602380880323584*^9}, {
  3.602381227285282*^9, 3.6023812291746693`*^9}, {3.602381960215642*^9, 
  3.6023819652527323`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "We", " ", "divide", " ", "out", " ", "the", " ", "root", " ", "x1"}], " ",
    "=", " ", 
   RowBox[{
   "0", " ", "as", " ", "we", " ", "know", " ", "that", " ", "it", " ", 
    "corresponds", " ", "to", " ", "the", " ", "invariant", " ", 
    RowBox[{"subspace", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023820001673937`*^9, 3.602382038975655*^9}}],

Cell[BoxData[
 RowBox[{"f1", " ", "=", " ", 
  RowBox[{"vred1stmode", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602382047030949*^9, 3.602382052808021*^9}, {
   3.602382684234611*^9, 3.602382691887899*^9}, {3.6023833345289*^9, 
   3.602383336693224*^9}, 3.602385088553473*^9}],

Cell[BoxData[
 RowBox[{"solx1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"f1", " ", "\[Equal]", " ", "0"}], ",", " ", "x1"}], "]"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.602382057748467*^9, 3.602382173541086*^9}, {
  3.60238270907264*^9, 3.602382709724627*^9}, {3.602383343780076*^9, 
  3.602383361251965*^9}, {3.6023851051651573`*^9, 3.6023851052946053`*^9}, {
  3.602385145134482*^9, 3.602385145292363*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "We", " ", "now", " ", "got", " ", "a", " ", "condition", " ", "on", " ", 
    RowBox[{"x1", "^", "2"}], " ", "for", " ", "relative", " ", "equilibria", 
    " ", "within", " ", "the", " ", "slice"}], ",", " ", 
   RowBox[{
   "we", " ", "continue", " ", "by", " ", "substituting", " ", "this", " ", 
    "into", " ", "the", " ", "3", "rd", " ", "and", " ", "4", "th", " ", 
    "velocity", " ", 
    RowBox[{"components", ":", "."}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023822080072937`*^9, 3.6023822499093533`*^9}}],

Cell[BoxData[
 RowBox[{"f3", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"vred1stmode", "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", "/.", " ", 
    RowBox[{"solx1", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6023812164114017`*^9, 3.6023812168143673`*^9}, {
  3.602382187984837*^9, 3.6023821998689013`*^9}, {3.6023822726304007`*^9, 
  3.602382293571354*^9}, {3.602382960894771*^9, 3.6023830104692183`*^9}, {
  3.602383371929756*^9, 3.6023833757438*^9}, {3.6023851414588423`*^9, 
  3.602385150484569*^9}}],

Cell[BoxData[
 RowBox[{"soly2", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"f3", "\[Equal]", "0"}], ",", " ", "y2"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.602383017116829*^9, 3.602383031306714*^9}, {
  3.602383072444667*^9, 3.6023830739261*^9}, {3.602383199018709*^9, 
  3.602383201907415*^9}}],

Cell[BoxData[
 RowBox[{"f4", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"vred1stmode", "[", 
     RowBox[{"[", "4", "]"}], "]"}], " ", "/.", " ", 
    RowBox[{"solx1", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{
  3.6023830620510893`*^9, {3.602383100231292*^9, 3.602383161274197*^9}, {
   3.602383208893729*^9, 3.602383220373275*^9}, 3.602383387661463*^9, {
   3.6023851847711687`*^9, 3.60238518857449*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Try", " ", "to", " ", "f3", " ", "and", " ", "f4", " ", "for", " ", 
    "r2sq"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"x2", "^", "2"}], " ", "+", " ", 
    RowBox[{"y2", "^", "2"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023834498419533`*^9, 3.602383474055575*^9}}],

Cell[BoxData[
 RowBox[{"f3r2", " ", "=", " ", 
  RowBox[{
   RowBox[{"f3", " ", "/.", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x2", "^", "2"}], " ", "+", " ", 
       RowBox[{"y2", "^", "2"}]}], ")"}], " ", "\[Rule]", " ", "r2sq"}]}], 
   " ", "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.602383476209168*^9, 3.602383500262981*^9}, {
  3.6023852058524103`*^9, 3.602385208559177*^9}}],

Cell[BoxData[
 RowBox[{"f4r2", " ", "=", " ", 
  RowBox[{
   RowBox[{"f4", " ", "/.", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x2", "^", "2"}], " ", "+", " ", 
       RowBox[{"y2", "^", "2"}]}], ")"}], " ", "\[Rule]", " ", "r2sq"}]}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6023835103110237`*^9, 3.602383515460732*^9}, 
   3.602385213788313*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"f3r2", " ", "\[Equal]", " ", "0"}], ",", " ", "r2sq"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6023835210989122`*^9, 3.602383535218483*^9}, {
  3.602383634404676*^9, 3.602383636723707*^9}, {3.602383704671632*^9, 
  3.6023837082645607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"f4r2", " ", "\[Equal]", " ", "0"}], ",", " ", "r2sq"}], "]"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.602383537527287*^9, 3.602383546744956*^9}, {
  3.6023836170283422`*^9, 3.60238364201735*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9, 
   3.602437886077486*^9, 3.6024420422407923`*^9, 3.602442091704061*^9, 
   3.602442135675951*^9, 3.60244461657539*^9, 3.602444896938652*^9, 
   3.602446709469099*^9, 3.602447080527981*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9, 
   3.602437886077486*^9, 3.6024420422407923`*^9, 3.602442091704061*^9, 
   3.602442135675951*^9, 3.60244461657539*^9, 3.602444896938652*^9, 
   3.602446709469099*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9, 
   3.602437886077486*^9, 3.6024420422407923`*^9, 3.602442091704061*^9, 
   3.602442135675951*^9, 3.60244461657539*^9, 3.602444896938652*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9, 
   3.602437886077486*^9, 3.6024420422407923`*^9, 3.602442091704061*^9, 
   3.602442135675951*^9, 3.60244461657539*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9, 
   3.602437886077486*^9, 3.6024420422407923`*^9, 3.602442091704061*^9, 
   3.602442135675951*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9, 
   3.602437886077486*^9, 3.6024420422407923`*^9, 3.602442091704061*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9, 
   3.602437886077486*^9, 3.6024420422407923`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9, 
   3.602437886077486*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9, 3.602429690696683*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9, 3.602429618517239*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9, 
   3.6024287206951227`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9, 3.602392343940392*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9, 3.6023883212893677`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2sq", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "y2"}], " ", 
       SubscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          SubscriptBox["c", "1"]}], "+", 
         SubscriptBox["\[Mu]", "1"]}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["a", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "y2", " ", 
             SubscriptBox["c", "1"]}], "+", 
            SubscriptBox["e", "2"]}], ")"}]}], "+", 
         RowBox[{"y2", " ", 
          SubscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "2"], " ", 
         SubscriptBox["b", "1"]}], "-", 
        RowBox[{
         SubscriptBox["a", "1"], " ", 
         SubscriptBox["b", "2"]}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.602383547167356*^9, {3.602383617030712*^9, 3.602383650877343*^9}, 
   3.6023852222002277`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Cannot", " ", "see", " ", "any", " ", "other", " ", "helpful", " ", 
   "simplification"}], "*)"}]], "Input",
 CellChangeTimes->{{3.602383620668406*^9, 3.602383630054556*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", " ", 
   RowBox[{"parameters", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023837200338793`*^9, 3.60238373857486*^9}}],

Cell[BoxData[
 RowBox[{"f3simple", "=", " ", 
  RowBox[{
   RowBox[{"f3", " ", "/.", " ", "par01"}], " ", "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6023837415704737`*^9, 3.6023837882758417`*^9}}],

Cell[BoxData[
 RowBox[{"f4simple", " ", "=", " ", 
  RowBox[{
   RowBox[{"f4", " ", "/.", " ", "par01"}], " ", "//", " ", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.602383795628832*^9, 3.60238380354735*^9}}],

Cell[BoxData[
 RowBox[{"solx2simple", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"f4simple", " ", "\[Equal]", " ", "0"}], ",", " ", "x2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6023838089962397`*^9, 3.602383852008191*^9}, 
   3.602384134819618*^9}],

Cell[BoxData[
 RowBox[{"fy2", " ", "=", " ", 
  RowBox[{
   RowBox[{"f3simple", " ", "/.", " ", 
    RowBox[{"solx2simple", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.602383830160488*^9, 3.602383889886705*^9}, {
  3.6023841384732037`*^9, 3.6023841388894444`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"fy2", " ", "\[Equal]", " ", 
    RowBox[{
    "0", " ", "corresponds", " ", "to", " ", "the", " ", "solution", " ", 
     "of", " ", "a", " ", "4", "th", " ", "order", " ", "polynomial"}]}], ",",
    " ", 
   RowBox[{"hence", " ", "the", " ", "solution", " ", "is", " ", 
    RowBox[{"exact", "."}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602383926754239*^9, 3.602383992537299*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"However", ",", " ", 
   RowBox[{
    RowBox[{"it", "'"}], "s", " ", "long"}], ",", " ", 
   RowBox[{"so", " ", "at", " ", "this", " ", "point"}], ",", " ", 
   RowBox[{
   "we", " ", "plug", " ", "the", " ", "numbers", " ", "in", " ", "and", " ", 
    "see", " ", "what", " ", "we", " ", 
    RowBox[{"have", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602383993663666*^9, 3.602384011927143*^9}}],

Cell[BoxData[
 RowBox[{"soly2Num", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fy2", " ", "\[Equal]", " ", "0"}], "/.", " ", "pars"}], ",", 
    " ", "y2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602383900453402*^9, 3.6023839237836514`*^9}, {
  3.602384016305419*^9, 3.602384057188284*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Meaningful", " ", "solutions", " ", "are", " ", "real", " ", 
   RowBox[{"ones", "."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602384073369443*^9, 3.602384116081664*^9}}],

Cell[BoxData[
 RowBox[{"solx2Num", " ", "=", " ", 
  RowBox[{
   RowBox[{"solx2simple", " ", "/.", " ", "pars"}], " ", "/.", " ", 
   "soly2Num"}]}]], "Input",
 CellChangeTimes->{{3.602384123101059*^9, 3.6023842488098392`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Finally", ",", " ", 
   RowBox[{"we", " ", "should", " ", "check", " ", 
    RowBox[{"x1", "^", "2"}], " ", "for", " ", "these", " ", "numbers", " ", 
    "and", " ", "find", " ", "relative", " ", 
    RowBox[{"equilibria", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602384049250383*^9, 3.602384051740122*^9}, {
  3.602384269871665*^9, 3.602384307918242*^9}}],

Cell[BoxData[
 RowBox[{"solx1simple", " ", "=", " ", 
  RowBox[{"solx1", "/.", "par01"}]}]], "Input",
 CellChangeTimes->{{3.602384653689332*^9, 3.6023846595453253`*^9}, {
  3.6023848123221703`*^9, 3.602384816337782*^9}, {3.6023852955491858`*^9, 
  3.602385312805521*^9}}],

Cell[BoxData[
 RowBox[{"solx1SimpleNum", " ", "=", " ", 
  RowBox[{"solx1simple", " ", "/.", " ", "pars"}]}]], "Input",
 CellChangeTimes->{{3.602385319174918*^9, 3.602385340901856*^9}, 
   3.6023853728469257`*^9, {3.6023855689958973`*^9, 3.602385569910532*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Note", ",", " ", 
   RowBox[{"in", " ", "this", " ", "case"}], ",", " ", 
   RowBox[{"x1", " ", "depends", " ", "only", " ", "on", " ", "x2"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.602385419844692*^9, 3.602385433233325*^9}}],

Cell[BoxData[
 RowBox[{"solx1Num", " ", "=", 
  RowBox[{"solx1SimpleNum", " ", "/.", " ", "solx2Num", " "}]}]], "Input",
 CellChangeTimes->{{3.6023853561465816`*^9, 3.602385377057007*^9}, {
  3.602385556086375*^9, 3.602385574856551*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "We", " ", "have", " ", "two", " ", "physical", " ", "relative", " ", 
    "equilibrium", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Satisfying", " ", "x1"}], ">", 
       RowBox[{"0", " ", "and", " ", "x1"}]}], " ", "\[Element]", " ", 
      "Reals"}], ")"}]}], ":"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023854155726767`*^9, 3.602385529753848*^9}}],

Cell[BoxData[
 RowBox[{"xreqv", " ", "=", " ", 
  RowBox[{"Re", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", " ", "0", ",", " ", "x2", ",", " ", "y2"}], "}"}],
         " ", "/.", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"solx1Num", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], " ", "/.", " ", 
       RowBox[{"solx2Num", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], " ", "/.", " ", 
      RowBox[{"soly2Num", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602385470474118*^9, 3.6023854885543137`*^9}, {
  3.6023855362259398`*^9, 3.602385546620449*^9}, {3.602385580120079*^9, 
  3.602385610137694*^9}, {3.6023856502299*^9, 3.602385727221456*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Let", " ", "us", " ", "verify", " ", "that", " ", "this", " ", "is", " ", 
   "a", " ", "relative", " ", "equilibrium", " ", "by", " ", "plugging", " ", 
   "this", " ", "into", " ", "the", " ", "reduced", " ", 
   RowBox[{"velocity", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602385803193672*^9, 3.602385835104124*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"vred1stmode", " ", "/.", " ", "par01"}], " ", "/.", " ", 
   "pars"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vRedNum", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "y1_", ",", "x2_", ",", "y2_"}], "}"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2.8`"}], "-", 
       SuperscriptBox["x1", "2"], "-", 
       RowBox[{"7.75`", " ", "x2"}]}], ")"}]}], ",", "0", ",", 
    RowBox[{
     SuperscriptBox["x1", "2"], "+", "x2", "-", 
     RowBox[{"2.66`", " ", 
      SuperscriptBox["x1", "2"], " ", "x2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"15.5`", " ", "y2"}]}], ")"}], " ", "y2"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "x2"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"15.5`", " ", "y2"}]}], ")"}]}], "+", "y2", "-", 
     RowBox[{"2.66`", " ", 
      SuperscriptBox["x1", "2"], " ", "y2"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6023861235958548`*^9, 3.6023861674218903`*^9}, {
  3.602386211968581*^9, 3.602386239392455*^9}, {3.602386274326701*^9, 
  3.602386284028119*^9}}],

Cell[BoxData[
 RowBox[{"vRedNum", "[", "xreqv", "]"}]], "Input",
 CellChangeTimes->{{3.602386221323269*^9, 3.602386226745633*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Seems", " ", 
   RowBox[{"correct", "!"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602386308800643*^9, 3.602386316370064*^9}, {
  3.602387702145926*^9, 3.60238770303728*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Solve", " ", "the", " ", "symmetry", " ", "reduced", " ", 
   RowBox[{"equations", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602387705204892*^9, 3.602387712511321*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solred", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x1redsol", "'"}], "[", "t", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"y1redsol", "'"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{"x2redsol", "'"}], "[", "t", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"y2redsol", "'"}], "[", "t", "]"}]}], "}"}], " ", 
        "\[Equal]", " ", 
        RowBox[{"vRedNum", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1redsol", "[", "t", "]"}], ",", " ", 
           RowBox[{"y1redsol", "[", "t", "]"}], ",", " ", 
           RowBox[{"x2redsol", "[", "t", "]"}], ",", " ", 
           RowBox[{"y2redsol", "[", "t", "]"}]}], "}"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1redsol", "[", "0", "]"}], ",", " ", 
          RowBox[{"y1redsol", "[", "0", "]"}], ",", 
          RowBox[{"x2redsol", "[", "0", "]"}], ",", " ", 
          RowBox[{"y2redsol", "[", "0", "]"}]}], " ", "}"}], "==", " ", 
        "x0"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x1redsol", ",", "y1redsol", ",", "x2redsol", ",", "y2redsol"}],
       "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1000"}], "}"}], ",", " ", 
     RowBox[{"MaxSteps", "\[Rule]", " ", "\[Infinity]"}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<ExplicitRungeKutta\>\"", ",", " ", 
        RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", " ", "8"}], ",", " ", 
        RowBox[{"\"\<StiffnessTest\>\"", "\[Rule]", "False"}]}], "}"}]}], ",",
      " ", 
     RowBox[{"InterpolationOrder", "\[Rule]", " ", "All"}]}], " ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6023863342594967`*^9, 3.602386382415989*^9}, {
   3.602386431330208*^9, 3.602386434527266*^9}, {3.602386522389812*^9, 
   3.602386539464957*^9}, 3.602386988064344*^9, {3.602387046540121*^9, 
   3.602387057574844*^9}, {3.60238773558644*^9, 3.602387735758101*^9}, {
   3.602388540791872*^9, 3.602388586063828*^9}, 3.602388660747991*^9, {
   3.602388693067998*^9, 3.602388730544088*^9}, {3.602442871872488*^9, 
   3.6024428730626717`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Plot", " ", "reduced", " ", "trajectory"}], "*)"}]], "Input",
 CellChangeTimes->{{3.602387693455942*^9, 3.602387718523156*^9}}],

Cell[BoxData[
 RowBox[{"redPlot", " ", "=", " ", 
  RowBox[{"ParametricPlot3D", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1redsol", "[", "t", "]"}], ",", " ", 
        RowBox[{"x2redsol", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2redsol", "[", "t", "]"}]}], "}"}], "/.", "solred"}], " ", 
     "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "1000"}], "}"}], ",", " ", 
    RowBox[{"PlotPoints", "\[Rule]", " ", "1000"}], ",", " ", 
    RowBox[{"Boxed", "\[Rule]", " ", "False"}], ",", " ", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", 
       SubscriptBox["x", "2"], ",", 
       SubscriptBox["y", "2"]}], "}"}]}], ",", " ", 
    RowBox[{"BoxRatios", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], " ", ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "2.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.5"}], ",", "0.6"}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602386991840684*^9, 3.602387004230425*^9}, {
   3.602387077979784*^9, 3.6023870798758802`*^9}, {3.602387183086282*^9, 
   3.602387222544471*^9}, {3.6023873157777348`*^9, 3.6023873316595182`*^9}, {
   3.6023874882553997`*^9, 3.602387553792264*^9}, {3.602387588356751*^9, 
   3.602387685542878*^9}, 3.602387982581894*^9, 3.602388016916067*^9, 
   3.602388742213812*^9, {3.60239039588797*^9, 3.602390403490872*^9}, {
   3.602390963802928*^9, 3.6023909649551983`*^9}, {3.602391002057562*^9, 
   3.602391004421981*^9}, {3.6023958709059057`*^9, 3.602395872057329*^9}, {
   3.6024428767590227`*^9, 3.6024428817667027`*^9}, {3.602442919261784*^9, 
   3.602443004565003*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"10", "A", ".9"}], " ", "-", " ", 
   RowBox[{"Visualizing", " ", "the", " ", "relative", " ", 
    RowBox[{"equilibrium", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602387937074699*^9, 3.6023879750137672`*^9}}],

Cell[BoxData[
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1redsol", "[", "t", "]"}], ",", " ", 
         RowBox[{"x2redsol", "[", "t", "]"}], ",", " ", 
         RowBox[{"y2redsol", "[", "t", "]"}]}], "}"}], "/.", "solred"}], " ", 
      "]"}], ",", " ", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1sol", "[", "t", "]"}], ",", " ", 
         RowBox[{"x2sol", "[", "t", "]"}], ",", " ", 
         RowBox[{"y2sol", "[", "t", "]"}]}], "}"}], "/.", "sol"}], " ", 
      "]"}]}], "}"}], " ", ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "250"}], "}"}], ",", " ", 
   RowBox[{"PlotPoints", "\[Rule]", " ", "500"}], ",", " ", 
   RowBox[{"Boxed", "\[Rule]", " ", "False"}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      SubscriptBox["x", "2"], ",", 
      SubscriptBox["y", "2"]}], "}"}]}], ",", " ", 
   RowBox[{"BoxRatios", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], " ", ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", " ", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602387993212728*^9, 3.6023880715786123`*^9}, {
  3.602388754704218*^9, 3.6023887960644608`*^9}, {3.602388829748982*^9, 
  3.6023888443297873`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Red", " ", "\[Rule]", " ", 
    RowBox[{"Symmetry", " ", "equivariant", " ", "state", " ", "space"}]}], 
   ",", " ", 
   RowBox[{"Blue", " ", "\[Rule]", " ", 
    RowBox[{"Reduced", " ", "state", " ", "space", " ", "trajectory"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.602388941838634*^9, 3.6023889909548407`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"10", "A", ".10"}], " ", "-", " ", 
   RowBox[{"Stability", " ", "of", " ", "Relative", " ", 
    RowBox[{"Equilibrium", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602388992135131*^9, 3.602388992466605*^9}, {
  3.602389055652322*^9, 3.602389084257704*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Let", " ", "us", " ", "start", " ", "by", " ", "computing", " ", "the", 
    " ", "stability", " ", "matrix", " ", "of", " ", "the", " ", "2"}], "-", 
   RowBox[{
   "mode", " ", "system", " ", "in", " ", "the", " ", "reduced", " ", 
    RowBox[{"statespace", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602389086487166*^9, 3.602389104511813*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ared", " ", "=", " ", 
   RowBox[{"IdentityMatrix", "[", "4", "]"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"Dummy", " ", "assignment"}], "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.602389105846776*^9, 3.6023891275622272`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xdummy", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "y1", ",", "x2", ",", "y2"}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.602389218692789*^9, 3.602389232363768*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", " ", "4"}], ",", " ", 
    RowBox[{"i", "++"}], ",", " ", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
      RowBox[{"j", "\[LessEqual]", " ", "4"}], ",", " ", 
      RowBox[{"j", "++"}], ",", " ", 
      RowBox[{
       RowBox[{"Ared", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
       RowBox[{"D", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vred", "[", "xdummy", "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
         RowBox[{"xdummy", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.602389129642494*^9, 3.6023893039768887`*^9}, 
   3.602389353646353*^9}],

Cell[BoxData[
 RowBox[{"Ared", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Ared", " ", "/.", " ", 
     RowBox[{"xp", " ", "\[Rule]", " ", "slicep"}]}], " ", "/.", " ", 
    "par01"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.602389355538237*^9, 3.602389408082535*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Note", ":"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Ared", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602389467063655*^9, 3.602389481028627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fAredNum", "[", 
   RowBox[{"{", 
    RowBox[{"xx1_", ",", "yy1_", ",", "xx2_", ",", "yy2_"}], "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Ared", "/.", "pars"}], " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", " ", "xx1"}], ",", " ", 
     RowBox[{"y1", "\[Rule]", " ", "yy1"}], ",", " ", 
     RowBox[{"x2", "\[Rule]", " ", "xx2"}], ",", " ", 
     RowBox[{"y2", "\[Rule]", " ", "yy2"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.602389494026321*^9, 3.602389528707549*^9}, {
  3.602389587227255*^9, 3.602389612461*^9}}],

Cell[BoxData["xreqv"], "Input",
 CellChangeTimes->{{3.602389549441284*^9, 3.6023895502708397`*^9}}],

Cell[BoxData[
 RowBox[{"\[Lambda]", " ", "=", " ", 
  RowBox[{"Eigenvalues", "[", 
   RowBox[{"fAredNum", "[", "xreqv", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602389531013074*^9, 3.602389570473652*^9}, {
  3.6023896199986773`*^9, 3.602389653245809*^9}, {3.602389686438724*^9, 
  3.602389687526848*^9}}],

Cell[BoxData[
 RowBox[{"e", " ", "=", " ", 
  RowBox[{"Eigenvectors", "[", 
   RowBox[{"fAredNum", "[", "xreqv", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6023896548100843`*^9, 3.6023896939732533`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Note", ",", " ", 
   RowBox[{
    RowBox[{"Re", "[", 
     SubscriptBox["\[Lambda]", 
      RowBox[{"3", ",", "4"}]], "]"}], " ", ">", " ", "0"}], ",", " ", 
   RowBox[{"hence", " ", "the", " ", "unstable", " ", 
    RowBox[{"direction", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602389516714217*^9, 3.602389520515752*^9}, {
   3.602389706575405*^9, 3.6023897435978518`*^9}, 3.6023897829530373`*^9}],

Cell[BoxData[
 RowBox[{"unstable", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "*", 
    RowBox[{"e", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"\[Lambda]", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "*", 
    RowBox[{"e", "[", 
     RowBox[{"[", "3", "]"}], "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.602389787095332*^9, 3.602389818488077*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "is", " ", "a", " ", "real", " ", 
   RowBox[{"vector", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602389827439577*^9, 3.602389858399199*^9}}],

Cell[BoxData[
 RowBox[{"unstable", " ", "=", " ", 
  RowBox[{
   RowBox[{"Re", "[", "unstable", "]"}], "/", 
   RowBox[{"Norm", "[", "unstable", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.60238986031538*^9, 3.6023898770945587`*^9}, {
  3.602395615032998*^9, 3.6023956614661837`*^9}}],

Cell[BoxData[
 RowBox[{"xreqv3D", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xreqv", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
    RowBox[{"xreqv", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", 
    RowBox[{"xreqv", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.602390629425231*^9, 3.602390633498681*^9}, {
  3.602390686135562*^9, 3.6023906938498373`*^9}, {3.602390749675991*^9, 
  3.6023907901525517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unstable3D", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"unstable", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
     RowBox[{"unstable", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
     RowBox[{"unstable", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602395301307027*^9, 3.6023953185210447`*^9}, {
  3.602395674737266*^9, 3.6023956895618763`*^9}, {3.6024465630031357`*^9, 
  3.602446595034526*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sum3D", " ", "=", " ", 
   RowBox[{"xreqv3D", " ", "+", " ", 
    RowBox[{"unstable3D", "/", "1.5"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6023906375391703`*^9, 3.602390641621479*^9}, {
  3.602390795818853*^9, 3.602390822183775*^9}, {3.602395323986158*^9, 
  3.6023953436688223`*^9}, {3.602446727489217*^9, 3.602446728361973*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"redPlot2", " ", "=", " ", 
   RowBox[{"ParametricPlot3D", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1redsol", "[", "t", "]"}], ",", " ", 
         RowBox[{"x2redsol", "[", "t", "]"}], ",", " ", 
         RowBox[{"y2redsol", "[", "t", "]"}]}], "}"}], "/.", "solred"}], " ", 
      "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1000"}], "}"}], ",", " ", 
     RowBox[{"PlotPoints", "\[Rule]", " ", "400"}], ",", " ", 
     RowBox[{"Boxed", "\[Rule]", " ", "False"}], ",", " ", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "1"], ",", 
        SubscriptBox["x", "2"], ",", 
        SubscriptBox["y", "2"]}], "}"}]}], ",", " ", 
     RowBox[{"BoxRatios", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], " ", ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0.80"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "0.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "0.4"}], "}"}]}], "}"}]}]}], " ", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602395885153459*^9, 3.6023958949579363`*^9}, {
  3.602395925835802*^9, 3.602396030427462*^9}, {3.602438522297065*^9, 
  3.6024385809598637`*^9}, {3.602438654161456*^9, 3.602438745325943*^9}, {
  3.602443021685911*^9, 3.602443043787304*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"redPlot2", ",", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{"xreqv3D", ",", "sum3D"}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6023904094044313`*^9, 3.6023905513622026`*^9}, {
   3.602390827671156*^9, 3.602390829737133*^9}, {3.6023908817008533`*^9, 
   3.602390895794421*^9}, {3.6023953467163467`*^9, 3.6023953477931757`*^9}, 
   3.602396016549445*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Reduced", " ", "flow"}], ",", " ", 
   RowBox[{
   "and", " ", "the", " ", "unstable", " ", "direction", " ", "of", " ", 
    "the", " ", "relative", " ", 
    RowBox[{"equilibrium", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{3.602391446615641*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Now", " ", "let", " ", "us", " ", "try", " ", "to", " ", "construct", " ", 
   "a", " ", "Poincare", " ", "section", " ", "that", " ", "includes", " ", 
   "this", " ", "unstable", " ", "direction", " ", 
   RowBox[{"vector", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.60239118841756*^9, 3.602391188904663*^9}, {
  3.602391276932727*^9, 3.60239131498202*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "We", " ", "still", " ", "have", " ", "the", " ", "freedom", " ", "in", " ",
    "the", " ", "orientation", " ", "of", " ", "the", " ", "Poincare", " ", 
   RowBox[{"section", "."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6023913203157043`*^9, 3.602391367620606*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "We", " ", "can", " ", "choose", " ", "a", " ", "normal", " ", "vector", 
   " ", "by", " ", "needing", " ", "the", " ", "Poincare", " ", "section", 
   " ", "include", " ", "also", " ", "the", " ", "basis", " ", "in", " ", 
   SubscriptBox["y", "2"], " ", 
   RowBox[{"direction", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602391376206819*^9, 3.602391422659306*^9}}],

Cell[BoxData[
 RowBox[{"n3D", " ", "=", " ", 
  RowBox[{"Cross", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", " ", "unstable3D"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602391426488783*^9, 3.602391531528036*^9}}],

Cell[BoxData[
 RowBox[{"n", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"n3D", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", "0", ",", " ", 
    RowBox[{"n3D", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
    RowBox[{"n3D", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "}"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Note", ":", " ", 
    RowBox[{"this", " ", "is", " ", "a", " ", "particular", " ", 
     RowBox[{"choice", "."}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.602391534989046*^9, 3.602391575719363*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Now", ",", " ", 
   RowBox[{
   "the", " ", "condition", " ", "for", " ", "being", " ", "on", " ", "a", 
    " ", "Poincare", " ", 
    RowBox[{"section", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602391584664188*^9, 3.602391597522572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Poincare", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x", " ", "-", " ", "xreqv"}], ")"}], ".", "n", " "}]}]], "Input",\

 CellChangeTimes->{{3.6023916053462267`*^9, 3.6023916302460823`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Interpolated", " ", "function", " ", "corresponding", " ", "to", " ", 
   "the", " ", "solution", " ", "in", " ", "the", " ", "reduced", " ", 
   "state", " ", 
   RowBox[{"space", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602394380848015*^9, 3.6023943935440273`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fSolred", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1redsol", "[", "t", "]"}], ",", 
       RowBox[{"y1redsol", "[", "t", "]"}], ",", " ", 
       RowBox[{"x2redsol", "[", "t", "]"}], ",", " ", 
       RowBox[{"y2redsol", "[", "t", "]"}]}], "}"}], "/.", "solred"}], " ", 
    "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602393349856429*^9, 3.6023933502949944`*^9}, {
  3.602394316643353*^9, 3.602394341842255*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Find", " ", "time", " ", "points", " ", "of", " ", "Poincare", " ", 
   "section", " ", 
   RowBox[{"intersections", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.60239385410432*^9, 3.602393874310882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t00", " ", "=", " ", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.602393395712368*^9, 3.602393398916683*^9}, 
   3.602393641113143*^9, {3.602393788165935*^9, 3.602393827037693*^9}, {
   3.602395400618361*^9, 3.602395437021673*^9}, 3.602443940310855*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tf", " ", "=", " ", "1000"}], ";"}]], "Input",
 CellChangeTimes->{{3.6023934044353848`*^9, 3.602393409069195*^9}, {
   3.602443091921653*^9, 3.602443092193584*^9}, 3.602443936750197*^9, {
   3.602444589885975*^9, 3.6024445906370583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.602444047444992*^9, 3.602444048332713*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dt", " ", "=", " ", "0.1"}], ";"}]], "Input",
 CellChangeTimes->{{3.6024441114066563`*^9, 3.6024441166438932`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pt", " ", "=", " ", 
    RowBox[{"{", "}"}]}], " ", 
   RowBox[{"(*", 
    RowBox[{"Empty", " ", "array"}], "*)"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.602444349643299*^9, 3.602444360056419*^9}, 
   3.602444603493739*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Compute", " ", "Poincare", " ", "section", " ", "condition", " ", "for", 
    " ", "each", " ", "time", " ", "point", " ", "of", " ", "the", " ", 
    "solution"}], ",", " ", 
   RowBox[{"if", " ", "there", " ", "is", " ", "an", " ", "intersection"}], 
   ",", " ", 
   RowBox[{
   "then", " ", "look", " ", "for", " ", "a", " ", "numerically", " ", 
    "precise", " ", 
    RowBox[{"root", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6024446928834248`*^9, 3.60244472811607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"t0", "=", "t00"}], ",", " ", 
   RowBox[{"t0", "<", 
    RowBox[{"tf", "-", "dt"}]}], ",", " ", 
   RowBox[{"t0", "=", 
    RowBox[{"t0", "+", "dt"}]}], ",", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Poincare", "[", 
        RowBox[{"fSolred", "[", "t0", "]"}], "]"}], "*", 
       RowBox[{"Poincare", "[", 
        RowBox[{"fSolred", "[", 
         RowBox[{"t0", "+", "dt"}], "]"}], "]"}]}], "<", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Pt", " ", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"Pt", ",", " ", 
         RowBox[{"t", "/.", " ", 
          RowBox[{"Quiet", "[", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{"Poincare", "[", 
              RowBox[{"fSolred", "[", "t", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "t0"}], "}"}]}], "]"}], "]"}]}]}], "]"}]}], 
      ";"}]}], " ", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602443814158399*^9, 3.602443854125627*^9}, {
  3.602443922782588*^9, 3.6024441438370647`*^9}, {3.602444266419805*^9, 
  3.602444268603449*^9}, {3.602444374218048*^9, 3.6024444314494867`*^9}, {
  3.602444474096711*^9, 3.6024444828887987`*^9}, {3.6024447337411118`*^9, 
  3.602444746293478*^9}, {3.602444813340231*^9, 3.602444843691312*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Set :: \
write\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.602444269290227*^9, 3.6024443127774067`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Discard", " ", "what", " ", "seems", " ", "to", " ", "correspond", " ", 
   "to", " ", "the", " ", "same", " ", 
   RowBox[{"intersection", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.60243671590346*^9, 3.6024367315361156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pt", " ", "=", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"Pt", ",", " ", 
     RowBox[{"SameTest", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"#1", " ", "-", " ", "#2"}], "]"}], "<", " ", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}]}], " ", "&"}], ")"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.602436617678535*^9, 3.6024367385692673`*^9}, 
   3.602437283336694*^9, 3.6024383194431963`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"len", " ", "=", " ", 
   RowBox[{"Length", "[", "Pt", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602437613176283*^9, 3.602437617724286*^9}, 
   3.602437721994725*^9, 3.602438309266625*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Discard", " ", "the", " ", "intersections", " ", "where", " ", "the", " ", 
   "flow", " ", "velocity", " ", "and", " ", "the", " ", "Poincare", " ", 
   "section", " ", "normal", " ", "points", " ", "at", " ", "the", " ", 
   "opposite", " ", 
   RowBox[{"directions", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.60243837765009*^9, 3.602438442424734*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "len"}], ",", " ", 
   RowBox[{"i", "++"}], ",", " ", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sign", "[", 
       RowBox[{"n", ".", 
        RowBox[{"vRedNum", "[", 
         RowBox[{"fSolred", "[", 
          RowBox[{"Pt", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], "\[Equal]", 
      
      RowBox[{"-", "1"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Pt", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"Pt", ",", "i"}], "]"}]}], ";", " ", 
       RowBox[{"len", "=", 
        RowBox[{"len", "-", "1"}]}], ";", " ", 
       RowBox[{"i", "--"}]}], "}"}]}], " ", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602437145139827*^9, 3.6024372642892723`*^9}, {
   3.60243749846236*^9, 3.602437499398754*^9}, {3.602437621349078*^9, 
   3.602437640733097*^9}, {3.602437766186665*^9, 3.602437790298196*^9}, 
   3.6024420761449633`*^9, 3.602442122904468*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psect", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "Pt", "]"}], ",", " ", "4"}], "}"}]}], "]"}]}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "Dummy", " ", "matrix", " ", "to", " ", "hold", " ", "the", " ", 
    "poincare", " ", "section", " ", "intersections"}], "*)"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.602394643676601*^9, 3.60239471451935*^9}, {
  3.602394796985216*^9, 3.602394799234597*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psect3D", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "Pt", "]"}], ",", " ", "3"}], "}"}]}], "]"}]}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "Dummy", " ", "matrix", " ", "to", " ", "hold", " ", "the", " ", 
    "poincare", " ", "section", " ", "intersections", " ", 
    RowBox[{"(", 
     RowBox[{"3", "D"}], ")"}]}], "*)"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PsectRel", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "Pt", "]"}], ",", " ", "3"}], "}"}]}], "]"}]}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "Dummy", " ", "matrix", " ", "to", " ", "hold", " ", "the", " ", 
    "relative", " ", "poincare", " ", "section", " ", "coordinates", " ", 
    RowBox[{"(", 
     RowBox[{"3", "D"}], ")"}]}], "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.602397735925694*^9, 3.602397758103606*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "<=", " ", 
     RowBox[{"Length", "[", "Pt", "]"}]}], ",", " ", 
    RowBox[{"i", "++"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Psect", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{"fSolred", "[", 
        RowBox[{"Pt", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Psect3D", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"fSolred", "[", 
           RowBox[{"Pt", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"fSolred", "[", 
           RowBox[{"Pt", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"fSolred", "[", 
           RowBox[{"Pt", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ",", " ", 
      RowBox[{
       RowBox[{"PsectRel", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"Psect3D", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", "xreqv3D"}]}]}], 
     "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.602394722693714*^9, 3.602394767619643*^9}, {
   3.602394925693192*^9, 3.602394970630868*^9}, {3.6023963639145527`*^9, 
   3.602396408427903*^9}, {3.602396447301202*^9, 3.6023964562109823`*^9}, {
   3.602396779531057*^9, 3.602396784428125*^9}, {3.6023969078483133`*^9, 
   3.602396968335732*^9}, {3.602397747032769*^9, 3.602397785192205*^9}, 
   3.6024379708651133`*^9}],

Cell[BoxData[
 RowBox[{"PsectPlot", "=", 
  RowBox[{"ListPointPlot3D", "[", 
   RowBox[{"Psect3D", ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"PointSize", "[", "Medium", "]"}], ",", " ", "Pink"}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602396815050804*^9, 3.602396881647421*^9}, {
  3.602438024775062*^9, 3.6024380384632187`*^9}, {3.602438079558042*^9, 
  3.602438103881521*^9}, {3.602438153044969*^9, 3.602438180058488*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"redPlot2", ",", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{"xreqv3D", ",", "sum3D"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
   " ", "PsectPlot"}], "]"}]], "Input",
 CellChangeTimes->{{3.6023948516786423`*^9, 3.602394914744885*^9}, {
   3.602395052980991*^9, 3.602395064261533*^9}, {3.602395710080097*^9, 
   3.6023957119231863`*^9}, 3.602396044133339*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Now", " ", 
   RowBox[{"let", "'"}], "s", " ", "project", " ", "to", " ", "the", " ", 
   "basis", " ", "on", " ", "the", " ", "Poincare", " ", 
   RowBox[{"section", ".", " ", 
    RowBox[{"It", "'"}]}], "s", " ", "done", " ", "by", " ", "the", " ", 
   "following", " ", "transformation", " ", 
   RowBox[{"matrix", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602397204831634*^9, 3.6023972345846167`*^9}}],

Cell[BoxData[
 RowBox[{"U", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"unstable3D", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], " ", ",", " ", "n3D"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.602397176254182*^9, 3.602397201800414*^9}, {
  3.602397239009287*^9, 3.602397261967133*^9}, {3.60239743698107*^9, 
  3.602397437747856*^9}, {3.6023983898169823`*^9, 3.602398397444051*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Relative", " ", "coordinates", " ", "of", " ", "the", " ", "Poincare", " ", 
   RowBox[{"section", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602397449308506*^9, 3.602397531054162*^9}, {
  3.602397618810484*^9, 3.602397652726325*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PsectProj", " ", "=", " ", 
   RowBox[{"U", ".", 
    RowBox[{"Transpose", "[", "PsectRel", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602397640299341*^9, 3.602397686927807*^9}, {
   3.602397797204596*^9, 3.602397862772581*^9}, 3.602397917504377*^9, {
   3.6023979560715523`*^9, 3.6023979869865294`*^9}, {3.6023980873666773`*^9, 
   3.602398161474166*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psect2D", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"PsectProj", "[", 
     RowBox[{"[", 
      RowBox[{"Range", "[", "2", "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.602398446988514*^9, 3.602398489188469*^9}, {
   3.602398659480513*^9, 3.6023986729401217`*^9}, {3.60243886771597*^9, 
   3.602438884931471*^9}, 3.6024405606761847`*^9, 3.6024406004440527`*^9}],

Cell[BoxData[
 RowBox[{"plotPoincare2D", " ", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"Psect2D", ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"(", "Pink", ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602398273702373*^9, 3.60239829813008*^9}, {
  3.602398362558045*^9, 3.602398372840292*^9}, {3.602398599500578*^9, 
  3.602398599659815*^9}, {3.602398634991724*^9, 3.60239865250922*^9}, {
  3.6024389571219807`*^9, 3.60243896052218*^9}, {3.602439105928741*^9, 
  3.60243910937355*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Now", " ", "let", " ", "us", " ", "interpolate", " ", "to", " ", "this", 
   " ", 
   RowBox[{"data", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602438888269656*^9, 3.602438932841889*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fPoincare", " ", "=", " ", 
   RowBox[{"Interpolation", "[", "Psect2D", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602438912995759*^9, 3.602438937338594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotfPoincare", " ", "=", " ", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"fPoincare", "[", "x", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "0", ",", " ", "0.6"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.60243895006446*^9, 3.602438984529584*^9}, {
  3.602439023498445*^9, 3.602439043073391*^9}, {3.602439073920637*^9, 
  3.6024391358560266`*^9}, {3.602441510575663*^9, 3.602441517415326*^9}, {
  3.602446777072647*^9, 3.6024467831682034`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"plotPoincare2D", ",", " ", "plotfPoincare"}], "]"}]], "Input",
 CellChangeTimes->{{3.602439060072098*^9, 3.60243906834638*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Function", " ", "to", " ", "compute", " ", "arclengths", " ", "along", " ",
    "the", " ", 
   RowBox[{"curve", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602439473255692*^9, 3.6024394850425797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArcLength", "[", "xP_", "]"}], ":=", " ", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"fPoincare", "'"}], "[", "x", "]"}], "^", "2"}]}], "]"}], " ",
     ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "0", ",", "xP"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6024394451923637`*^9, 3.6024394548749638`*^9}, {
   3.602439490362484*^9, 3.602439544162264*^9}, 3.602439683376452*^9, {
   3.602439747423521*^9, 3.6024398643819437`*^9}, {3.602441051390512*^9, 
   3.6024410543498297`*^9}, {3.6024411079096403`*^9, 3.602441131477289*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "Pt", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.6024399192044086`*^9, {3.6024399580911903`*^9, 3.6024399637474747`*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "Pt", "]"}]}], ",", " ", 
   RowBox[{"i", "++"}], " ", ",", " ", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
    RowBox[{"ArcLength", "[", 
     RowBox[{
      RowBox[{"Psect2D", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6024399650879297`*^9, 3.602439980410653*^9}, {
  3.6024405404528522`*^9, 3.602440550908641*^9}, {3.602440608075684*^9, 
  3.602440616499758*^9}, {3.602440844785089*^9, 3.60244084794541*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Produce", " ", "the", " ", "return", " ", "map", " ", 
   RowBox[{"data", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6024413920363283`*^9, 3.602441402592222*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RetMap", " ", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{
          RowBox[{"Length", "[", "S", "]"}], "-", "1"}]}], "]"}], "]"}], ",", 
      
      RowBox[{"S", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", 
         RowBox[{"Length", "[", "S", "]"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.602440838232308*^9, {3.6024411563322*^9, 3.602441307609784*^9}, {
   3.602441350841661*^9, 3.6024414511210413`*^9}, 3.602441825475281*^9, 
   3.602442061400579*^9}],

Cell[BoxData[
 RowBox[{"plotRetMap", " ", "=", " ", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"RetMap", ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"(", "Pink", ")"}]}], ",", " ", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["s", "\[GothicN]"], ",", " ", 
       SubscriptBox["s", 
        RowBox[{"\[GothicN]", "+", "1"}]]}], "}"}]}], ",", " ", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602441463135749*^9, 3.602441471237824*^9}, {
  3.6024450480237627`*^9, 3.602445090295463*^9}, {3.602445136135281*^9, 
  3.602445139598925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fRetMap", " ", "=", " ", 
   RowBox[{"Interpolation", "[", "RetMap", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6024432294563847`*^9, 3.602443236973506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotfRetMap", " ", "=", " ", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"fRetMap", "[", "x", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "0", ",", " ", "0.6"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.602443246864315*^9, 3.602443254678874*^9}, 
   3.602446828479702*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fFixed", "[", "x_", "]"}], ":=", "x"}], ";"}]], "Input",
 CellChangeTimes->{{3.602444960829879*^9, 3.6024449764084187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotfFixed", " ", "=", " ", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"fFixed", "[", "x", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "0.6"}], "}"}], ",", " ", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", "Black", "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602444978849271*^9, 3.6024450182532997`*^9}, 
   3.602446835511392*^9}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"plotRetMap", ",", " ", "plotfRetMap", ",", "plotfFixed"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602443284902808*^9, 3.602443292106331*^9}, {
  3.602444999328576*^9, 3.602445002341641*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
    "There", " ", "seems", " ", "to", " ", "be", " ", "an", " ", 
     "intersection", " ", "around", " ", 
     SubscriptBox["s", "n"]}], " ", "=", " ", "0.42"}], ",", " ", 
   RowBox[{
    RowBox[{"let", "'"}], "s", " ", "find", " ", "it", " ", 
    RowBox[{"precisely", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602445172927497*^9, 3.602445200597142*^9}, 
   3.602445299220314*^9, {3.602446854223199*^9, 3.6024468544546328`*^9}}],

Cell[BoxData[
 RowBox[{"sFixed", " ", "=", " ", 
  RowBox[{"s", " ", "/.", " ", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fRetMap", "[", "s", "]"}], "\[Equal]", 
      RowBox[{"fFixed", "[", "s", "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0.42"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.602445204574101*^9, 3.602445255252636*^9}, {
  3.6024453506761017`*^9, 3.6024453602517033`*^9}, {3.6024468488563747`*^9, 
  3.602446849064105*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Now", " ", 
   RowBox[{"let", "'"}], "s", " ", "find", " ", "the", " ", "corresponding", 
   " ", "Poincare", " ", "section", " ", 
   RowBox[{"coordinate", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6024452821405153`*^9, 3.602445333178544*^9}, {
  3.6024453662030582`*^9, 3.602445368523134*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "We", " ", "pick", " ", "initial", " ", "guess", " ", "as", " ", "the", 
    " ", "arclength", " ", "since", " ", "the", " ", "vertical", " ", 
    "components", " ", "on", " ", "the", " ", "2", "D", " ", "Poincare", " ", 
    "section", " ", "have", " ", "quiet", " ", "small", " ", "values"}], ",", 
   " ", 
   RowBox[{"the", " ", "guess", " ", "is", " ", "good", " ", "enough"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6024455293671837`*^9, 3.602445576480324*^9}}],

Cell[BoxData[
 RowBox[{"xPS2DFixed", " ", "=", " ", 
  RowBox[{"x0", " ", "/.", " ", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ArcLength", "[", "x0", "]"}], " ", "\[Equal]", " ", "sFixed"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{"x0", ",", " ", "sFixed"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.602445410786334*^9, 3.6024454814822397`*^9}}],

Cell[BoxData[
 RowBox[{"yPS2DFixed", " ", "=", " ", 
  RowBox[{"fPoincare", "[", "xPS2DFixed", "]"}]}]], "Input",
 CellChangeTimes->{{3.602445593153674*^9, 3.602445603334783*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"We", " ", "now"}], ",", " ", 
   RowBox[{
   "have", " ", "our", " ", "relative", " ", "periodic", " ", "orbit", " ", 
    "candidate", " ", "in", " ", "the", " ", "Poincare", " ", "section"}], 
   ",", " ", 
   RowBox[{
   "final", " ", "step", " ", "is", " ", "transforming", " ", "back", " ", 
    "to", " ", "the", " ", "4", "D", " ", 
    RowBox[{"statespace", ":"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.602445613347207*^9, 3.602445653990683*^9}}],

Cell[BoxData["U"], "Input",
 CellChangeTimes->{{3.602446938935668*^9, 3.602446939597865*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.60244695198307*^9, 3.602446959845087*^9}}],

Cell[BoxData[
 RowBox[{"FixedPoint3D", "  ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "U", "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"xPS2DFixed", ",", " ", "yPS2DFixed", ",", " ", "0"}], "}"}]}], 
   "+", "xreqv3D"}]}]], "Input",
 CellChangeTimes->{{3.602445655767467*^9, 3.602445723334559*^9}, {
   3.602446417357614*^9, 3.602446445996772*^9}, 3.60244690980674*^9, {
   3.602446971693795*^9, 3.6024469868214417`*^9}}],

Cell[BoxData[
 RowBox[{"FixedPointssp", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"FixedPoint3D", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", " ", 
    RowBox[{"FixedPoint3D", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
    RowBox[{"FixedPoint3D", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.602445729385819*^9, 3.602445781446007*^9}}],

Cell[BoxData[
 RowBox[{"Poincare", "[", "FixedPointssp", "]"}]], "Input",
 CellChangeTimes->{{3.602446331148535*^9, 3.602446342462579*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Now", " ", "let", " ", "us", " ", "integrate", " ", "this", " ", 
   RowBox[{"point", ":"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6024458290382442`*^9, 3.602445839748171*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solCycle", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x1cyclesol", "'"}], "[", "t", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"y1cyclesol", "'"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{"x2cyclesol", "'"}], "[", "t", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"y2cyclesol", "'"}], "[", "t", "]"}]}], "}"}], " ", 
        "\[Equal]", " ", 
        RowBox[{"vRedNum", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1cyclesol", "[", "t", "]"}], ",", " ", 
           RowBox[{"y1cyclesol", "[", "t", "]"}], ",", " ", 
           RowBox[{"x2cyclesol", "[", "t", "]"}], ",", " ", 
           RowBox[{"y2cyclesol", "[", "t", "]"}]}], "}"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1cyclesol", "[", "0", "]"}], ",", " ", 
          RowBox[{"y1cyclesol", "[", "0", "]"}], ",", 
          RowBox[{"x2cyclesol", "[", "0", "]"}], ",", " ", 
          RowBox[{"y2cyclesol", "[", "0", "]"}]}], " ", "}"}], "==", " ", 
        "FixedPointssp"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "x1cyclesol", ",", "y1cyclesol", ",", "x2cyclesol", ",", "y2cyclesol"}],
       "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "4"}], "}"}], ",", " ", 
     RowBox[{"MaxSteps", "\[Rule]", " ", "\[Infinity]"}], ",", " ", 
     RowBox[{"Method", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<ExplicitRungeKutta\>\"", ",", " ", 
        RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", " ", "8"}], ",", " ", 
        RowBox[{"\"\<StiffnessTest\>\"", "\[Rule]", "False"}]}], "}"}]}], ",",
      " ", 
     RowBox[{"InterpolationOrder", "\[Rule]", " ", "All"}]}], " ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6024458491738663`*^9, 3.602445880526497*^9}, 
   3.602446249360813*^9, {3.602446615341494*^9, 3.602446667726613*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fSolcycle", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1cyclesol", "[", "t", "]"}], ",", 
       RowBox[{"y1cyclesol", "[", "t", "]"}], ",", " ", 
       RowBox[{"x2cyclesol", "[", "t", "]"}], ",", " ", 
       RowBox[{"y2cyclesol", "[", "t", "]"}]}], "}"}], "/.", "solCycle"}], 
    " ", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6024459073561974`*^9, 3.602445908969487*^9}, {
  3.602446606035449*^9, 3.60244660997724*^9}, {3.602446672636339*^9, 
  3.602446677348798*^9}}],

Cell[BoxData[
 RowBox[{"cyclePlot", " ", "=", " ", 
  RowBox[{"ParametricPlot3D", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1cyclesol", "[", "t", "]"}], ",", " ", 
        RowBox[{"x2cyclesol", "[", "t", "]"}], ",", " ", 
        RowBox[{"y2cyclesol", "[", "t", "]"}]}], "}"}], "/.", "solCycle"}], 
     " ", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "3.7"}], "}"}], ",", " ", 
    RowBox[{"PlotPoints", "\[Rule]", " ", "100"}], ",", " ", 
    RowBox[{"Boxed", "\[Rule]", " ", "False"}], ",", " ", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "1"], ",", 
       SubscriptBox["x", "2"], ",", 
       SubscriptBox["y", "2"]}], "}"}]}], ",", " ", 
    RowBox[{"BoxRatios", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], " ", ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "2.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.5"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.5"}], ",", "0.6"}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602446220840887*^9, 3.6024462765521517`*^9}, {
  3.602446311024736*^9, 3.602446314455462*^9}, {3.602446684204837*^9, 
  3.6024466892523212`*^9}, {3.602447010446546*^9, 3.602447024774275*^9}}]
},
WindowSize->{1063, 973},
WindowMargins->{{Automatic, 163}, {2, Automatic}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 210, 5, 32, "Input"],
Cell[770, 27, 3803, 111, 99, "Input"],
Cell[4576, 140, 896, 25, 32, "Input"],
Cell[5475, 167, 563, 16, 32, "Input"],
Cell[6041, 185, 513, 13, 32, "Input"],
Cell[6557, 200, 393, 8, 32, "Input"],
Cell[6953, 210, 367, 8, 32, "Input"],
Cell[7323, 220, 2447, 56, 121, "Input"],
Cell[9773, 278, 138, 3, 32, "Input"],
Cell[9914, 283, 894, 23, 55, "Input"],
Cell[10811, 308, 629, 16, 55, "Input"],
Cell[11443, 326, 276, 6, 32, "Input"],
Cell[11722, 334, 674, 17, 32, "Input"],
Cell[12399, 353, 699, 20, 55, "Input"],
Cell[13101, 375, 621, 15, 55, "Input"],
Cell[13725, 392, 438, 10, 32, "Input"],
Cell[14166, 404, 217, 5, 32, "Input"],
Cell[14386, 411, 569, 13, 32, "Input"],
Cell[14958, 426, 230, 6, 32, "Input"],
Cell[15191, 434, 876, 22, 77, "Input"],
Cell[16070, 458, 191, 4, 32, "Input"],
Cell[16264, 464, 993, 20, 32, "Input"],
Cell[17260, 486, 237, 6, 32, "Input"],
Cell[17500, 494, 271, 6, 32, "Input"],
Cell[17774, 502, 270, 5, 32, "Input"],
Cell[18047, 509, 358, 10, 32, "Input"],
Cell[18408, 521, 859, 19, 77, "Input"],
Cell[19270, 542, 958, 31, 83, "Input"],
Cell[20231, 575, 250, 6, 32, "Input"],
Cell[20484, 583, 254, 5, 32, "Input"],
Cell[20741, 590, 418, 10, 32, "Input"],
Cell[21162, 602, 308, 6, 32, "Input"],
Cell[21473, 610, 472, 10, 32, "Input"],
Cell[21948, 622, 582, 12, 55, "Input"],
Cell[22533, 636, 574, 12, 32, "Input"],
Cell[23110, 650, 362, 9, 32, "Input"],
Cell[23475, 661, 472, 11, 32, "Input"],
Cell[23950, 674, 333, 9, 32, "Input"],
Cell[24286, 685, 424, 11, 32, "Input"],
Cell[24713, 698, 396, 11, 32, "Input"],
Cell[25112, 711, 341, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[25478, 723, 289, 7, 32, "Input"],
Cell[25770, 732, 1531, 44, 52, "Output"],
Cell[27304, 778, 1509, 44, 52, "Output"],
Cell[28816, 824, 1483, 43, 52, "Output"],
Cell[30302, 869, 1461, 43, 52, "Output"],
Cell[31766, 914, 1440, 43, 52, "Output"],
Cell[33209, 959, 1414, 42, 52, "Output"],
Cell[34626, 1003, 1392, 42, 52, "Output"],
Cell[36021, 1047, 1368, 42, 52, "Output"],
Cell[37392, 1091, 1342, 41, 52, "Output"],
Cell[38737, 1134, 1320, 41, 52, "Output"],
Cell[40060, 1177, 1298, 41, 52, "Output"],
Cell[41361, 1220, 1270, 40, 52, "Output"],
Cell[42634, 1262, 1248, 40, 52, "Output"],
Cell[43885, 1304, 1224, 40, 52, "Output"]
}, Open  ]],
Cell[45124, 1347, 219, 5, 32, "Input"],
Cell[45346, 1354, 176, 4, 32, "Input"],
Cell[45525, 1360, 215, 5, 32, "Input"],
Cell[45743, 1367, 220, 5, 32, "Input"],
Cell[45966, 1374, 268, 7, 32, "Input"],
Cell[46237, 1383, 323, 7, 32, "Input"],
Cell[46563, 1392, 440, 10, 55, "Input"],
Cell[47006, 1404, 444, 10, 32, "Input"],
Cell[47453, 1416, 329, 8, 32, "Input"],
Cell[47785, 1426, 214, 4, 32, "Input"],
Cell[48002, 1432, 227, 5, 32, "Input"],
Cell[48232, 1439, 408, 8, 32, "Input"],
Cell[48643, 1449, 271, 5, 32, "Input"],
Cell[48917, 1456, 261, 4, 32, "Input"],
Cell[49181, 1462, 273, 6, 32, "Input"],
Cell[49457, 1470, 237, 4, 32, "Input"],
Cell[49697, 1476, 437, 12, 32, "Input"],
Cell[50137, 1490, 944, 24, 32, "Input"],
Cell[51084, 1516, 371, 7, 55, "Input"],
Cell[51458, 1525, 134, 4, 32, "Input"],
Cell[51595, 1531, 1091, 32, 58, "Input"],
Cell[52689, 1565, 130, 2, 32, "Input"],
Cell[52822, 1569, 217, 5, 32, "Input"],
Cell[53042, 1576, 216, 4, 32, "Input"],
Cell[53261, 1582, 2325, 54, 165, "Input"],
Cell[55589, 1638, 168, 3, 32, "Input"],
Cell[55760, 1643, 1965, 46, 77, "Input"],
Cell[57728, 1691, 271, 6, 32, "Input"],
Cell[58002, 1699, 1443, 37, 77, "Input"],
Cell[59448, 1738, 377, 9, 32, "Input"],
Cell[59828, 1749, 316, 7, 32, "Input"],
Cell[60147, 1758, 411, 9, 32, "Input"],
Cell[60561, 1769, 262, 6, 32, "Input"],
Cell[60826, 1777, 223, 6, 32, "Input"],
Cell[61052, 1785, 898, 25, 32, "Input"],
Cell[61953, 1812, 294, 7, 32, "Input"],
Cell[62250, 1821, 235, 6, 55, "Input"],
Cell[62488, 1829, 582, 14, 32, "Input"],
Cell[63073, 1845, 99, 1, 32, "Input"],
Cell[63175, 1848, 311, 6, 32, "Input"],
Cell[63489, 1856, 208, 4, 32, "Input"],
Cell[63700, 1862, 449, 10, 32, "Input"],
Cell[64152, 1874, 458, 13, 32, "Input"],
Cell[64613, 1889, 201, 4, 32, "Input"],
Cell[64817, 1895, 283, 6, 32, "Input"],
Cell[65103, 1903, 475, 12, 32, "Input"],
Cell[65581, 1917, 520, 13, 32, "Input"],
Cell[66104, 1932, 371, 7, 32, "Input"],
Cell[66478, 1941, 1598, 41, 77, "Input"],
Cell[68079, 1984, 537, 13, 32, "Input"],
Cell[68619, 1999, 306, 8, 32, "Input"],
Cell[68928, 2009, 409, 8, 55, "Input"],
Cell[69340, 2019, 313, 6, 32, "Input"],
Cell[69656, 2027, 417, 8, 55, "Input"],
Cell[70076, 2037, 262, 7, 32, "Input"],
Cell[70341, 2046, 542, 14, 32, "Input"],
Cell[70886, 2062, 290, 7, 32, "Input"],
Cell[71179, 2071, 259, 7, 32, "Input"],
Cell[71441, 2080, 319, 7, 32, "Input"],
Cell[71763, 2089, 584, 15, 32, "Input"],
Cell[72350, 2106, 252, 6, 32, "Input"],
Cell[72605, 2114, 289, 5, 32, "Input"],
Cell[72897, 2121, 273, 5, 32, "Input"],
Cell[73173, 2128, 133, 3, 32, "Input"],
Cell[73309, 2133, 150, 3, 32, "Input"],
Cell[73462, 2138, 278, 8, 32, "Input"],
Cell[73743, 2148, 544, 13, 55, "Input"],
Cell[CellGroupData[{
Cell[74312, 2165, 1367, 34, 77, "Input"],
Cell[75682, 2201, 603, 13, 23, "Message"]
}, Open  ]],
Cell[76300, 2217, 277, 6, 32, "Input"],
Cell[76580, 2225, 528, 15, 32, "Input"],
Cell[77111, 2242, 228, 5, 32, "Input"],
Cell[77342, 2249, 405, 8, 55, "Input"],
Cell[77750, 2259, 1055, 28, 32, "Input"],
Cell[78808, 2289, 537, 15, 32, "Input"],
Cell[79348, 2306, 478, 14, 55, "Input"],
Cell[79829, 2322, 560, 15, 55, "Input"],
Cell[80392, 2339, 1867, 48, 99, "Input"],
Cell[82262, 2389, 512, 11, 32, "Input"],
Cell[82777, 2402, 505, 12, 32, "Input"],
Cell[83285, 2416, 453, 9, 55, "Input"],
Cell[83741, 2427, 413, 9, 32, "Input"],
Cell[84157, 2438, 284, 6, 32, "Input"],
Cell[84444, 2446, 398, 8, 32, "Input"],
Cell[84845, 2456, 437, 10, 32, "Input"],
Cell[85285, 2468, 516, 10, 32, "Input"],
Cell[85804, 2480, 238, 6, 32, "Input"],
Cell[86045, 2488, 198, 4, 32, "Input"],
Cell[86246, 2494, 530, 12, 32, "Input"],
Cell[86779, 2508, 175, 3, 32, "Input"],
Cell[86957, 2513, 251, 6, 32, "Input"],
Cell[87211, 2521, 676, 16, 32, "Input"],
Cell[87890, 2539, 277, 7, 32, "Input"],
Cell[88170, 2548, 699, 17, 32, "Input"],
Cell[88872, 2567, 209, 4, 32, "Input"],
Cell[89084, 2573, 655, 20, 32, "Input"],
Cell[89742, 2595, 640, 15, 32, "Input"],
Cell[90385, 2612, 197, 4, 32, "Input"],
Cell[90585, 2618, 356, 10, 32, "Input"],
Cell[90944, 2630, 171, 4, 32, "Input"],
Cell[91118, 2636, 429, 11, 32, "Input"],
Cell[91550, 2649, 241, 5, 32, "Input"],
Cell[91794, 2656, 507, 12, 32, "Input"],
Cell[92304, 2670, 498, 12, 32, "Input"],
Cell[92805, 2684, 343, 7, 32, "Input"],
Cell[93151, 2693, 530, 11, 77, "Input"],
Cell[93684, 2706, 396, 10, 32, "Input"],
Cell[94083, 2718, 179, 3, 32, "Input"],
Cell[94265, 2723, 513, 12, 55, "Input"],
Cell[94781, 2737, 93, 1, 32, "Input"],
Cell[94877, 2740, 91, 1, 32, "Input"],
Cell[94971, 2743, 442, 10, 32, "Input"],
Cell[95416, 2755, 415, 10, 32, "Input"],
Cell[95834, 2767, 139, 2, 32, "Input"],
Cell[95976, 2771, 221, 4, 32, "Input"],
Cell[96200, 2777, 2055, 50, 165, "Input"],
Cell[98258, 2829, 644, 16, 32, "Input"],
Cell[98905, 2847, 1498, 39, 77, "Input"]
}
]
*)

(* End of internal cache information *)
