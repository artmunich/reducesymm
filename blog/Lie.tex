% siminos/blog/Lie.tex
% $Author$ $Date$

\chapter{Lie police}
\label{sect:LiePolice}

\renewcommand{\LieEl}{\ensuremath{g}}  % Predrag Lie group element
\renewcommand{\ssp}{x}

\begin{description}
\item[2011-03-15
\HREF{http://amath.colorado.edu/faculty/jdm}
{Master of Simplecticity}]
%{James Meiss}]
Never did I think I'd read the sentence ``It's a mess'' in a
\emph{Physica D} paper! But cool, nevertheless.

\item[2011-03-25 PC] keep reading:
``looking for periodic orbits in systems with only continuous symmetries
is a fool's errand.'' If you read to the end of Sect. 8 it gets worse:
``a serious nuisance.'' Another first for \emph{Physica D}.

\item[2011-03-17 JM]
In Eq.~(4) of \refref{SiCvi10} you say that every element of a Lie group
that is connected can be written as an exponential. This is false, I
believe. Some Lie groups are connected and some are not. $\SOn{n}$ is
connected, as is $Sp(n)$. But, just like for manifolds (indeed a Lie
group is just a manifold with a group structure), some groups can't be
covered by a single coordinate patch, or in this case by the exponential.
This is also related to the fact that the series for the  Log is not
globally convergent\rf{Hall03}.

\item[2011-03-17 PC]
Of course not {\em every} Lie group element needs to be continuously
connected to identity - that why the finely tuned statement in our humble
paper.
I need a lawyer.

\item[2011-03-17 JM] or a mathematician!

\item[2011-03-17 PC]
no, no, in your case I need a lawyer. We carefully
write above Eq.~(4):

``An element of a compact Lie group
continuously connected to identity can be written as''

We \emph{do not say}
``\emph{\color{red} every} element of a compact Lie group
\emph{\color{red} is} continuously connected to identity...''

% How can it be wrong? Goes back to Peter-Weyl, etc.
We write here
``continuously connected to identity'' so we do not need to point out
that $\On{n}$ has also elements of form (discrete operation $\times$
exponential rep of $\SOn{n}$ group element, where discrete group $Z_2$ is
$\{e,$inversion $\}$ (inversion$)^2=1$, and avoid talking about double
covers, \etc. The paper (as does the discussion of
\HREF{http://chaosbook.org/chapters/continuous.pdf}
{Chapter 10 - Relativity for cyclists}) tries its utmost to minimize the
\HREF{http://chaosbook.org/chapters/appendHist.pdf}{Gruppenpest jargon}
damage, which is a total turnoff to our intended audience of working
plumbers and electricians. If I may be so bold as to cite my foreman
plumber Fabian Waleffe, faculty member of a reputable mathematics
department in a union-busting state, upon my attempt to get him to read
\HREF{http://chaosbook.org/chapters/discrete.pdf}
{Chapter 9 - World in a mirror}, chicken feed in comparison to the
continuous symmetry reduction nightmare:
	\PC{remember to include Barkley's \On{n} as an example of
		semi-direct product.}

``How many Tylenols should I take with this?... (never took group theory,
still need to be convinced that there is any use to this beyond
mind-numbing formalizations.)''

But it is obviously too subtle, will rewrite in the ChaosBook.org.

Now, more seriously - we do not need the explicit exponential form, we
only need to say that for a continuous group (compact or not) we can
linearize the flow in a neighborhood of any group element, and that
the tangent space is spanned by the Lie algebra. How to say it without
too much jargon?

\item[2011-03-17 JM]
Yes, every Lie group has a tangent space (since it is a manifold), and
the tangent space always has a Lie algebra structure. Technically, I
believe that one says that the Lie algebra is the tangent space "at the
identity". So $\SOn{n}$ and $\On{n}$ have the same Lie algebra, the
antisymmetric matrices. The Lie algebra of $Sp(n)$ is the set of
``Hamiltonian matrices.'' More fancily, people talk about the Lie algebra
as the set of left-invariant vector fields... but that always confuses
me.

\item[2011-03-17 PC]
``set of left-invariant vector fields?'' Probably not needed
for compact Lie groups (subgroups of the unitary group). There left
and right vectors are the same thing...

\item[2011-03-17 JM]
For example the symplectic group has elements that are not exponentials.
An example is the Jordan block $B=[[-I, I],[0,I]]$, which I learned from
Alex Dragt. A great reference on Lie groups is Hall\rf{Hall03}.

\item[2011-03-17 PC]
Thanks for introducing me to Dragt; I have now read and like his
\refref{Dragt05} (for CNSers - uploaded to zotero). I prefer the much
deeper \refref{PCgr} to Hall\rf{Hall03}, which I always found rather
pedestrian. \HREF{http://birdtracks.eu}{The Much Deeper} you can have for
a click (by contrast to The Much Cooler and very wonderful
\refref{Meisso7} for which I doled out cool cash). But maybe I should
have a second look... For PDE applications of symmetries
Hoyle\rf{hoyll06} is pretty gentle.


\item[2011-03-17 JM]
$Sp(n) = {\LieEl :  \LieEl^T {\bf \omega} \LieEl = {\bf \omega}}$
where $\LieEl$ is $[2n\!\times\!2n]$.

\item[2011-03-25 PC]
See \refrem{rem:symplectic} concerning notation for $Sp(n)$.

\item[2011-03-17 JM]
So matrix $B \in Sp(n)$, but it is not the exponential of a
``Hamiltonian matrix'' (a matrix of the form ${\bf \omega}S$, where $S$
is symmetric).

\item[2011-03-25 PC]
This is exercise 3.7.12 in in Dragt\rf{Dragt11}
It has not worked for me as yet:
By explicit calculation, $B^T {\bf \omega} B \neq {\bf \omega}$.
I am probably missing something, but it is a worthwhile exercise
to do... (Evangelos? Chao?)

\item[2011-03-25 PC]
Thanks for pointing out that this is called `Hamiltonian matrices.'
Curious: who named this `Hamiltonian matrices'? So far I've tracked it to 1971
(see \refrem{rem:symplectic}).
As a physicist, I hate
this misuse of a term well established in Quantum Mechanics since the
time of Heisenberg (See \refrem{rem:symplectic}). The recovered Irish
alcoholic did quaternions, but I believe that it was the Germans who
formalized the classification of semi-simple Lie algebras towards the end
of 19th century, with Cartan driving in the final stake.

Can you perhaps have a glance at
\HREF{http://chaosbook.org/chapters/continuous.pdf} {Chapter 7 -
Hamiltonian dynamics}, see whether your hair raises? Spurred by you I'm
starting to incorporate more symplectic material, the first draft is
below, \refsect{sect:toCB}.

I care about splitting hairs because I'm trying to collect all possible
names for every single thing in ChaosBook.org commentary, together with
attributions.

\item[2011-03-17 JM]
But it seems you have the group $\SOn{n}$ or perhaps
$\Un{n}$ in mind. Because in the next paragraph
you say that the Lie algebra of your group is the set
of anti-hermitian matrices, and then you say it can be
brought into the anti-symmetric form. I thought this was
true only for the orthogonal group.

\item[2011-03-25 PC]
You are correct, from then on we use only  $\SOn{n}$, as Evangelos
explains here:

\item[2011-03-17 ES]
As we only have applications in mind where $(x_1,x_2,...,x_d)$ are real
coordinates and since any compact Lie group acting on $\reals^n$ can be
identified with a subgroup of $\On{n}$, we only consider $\On{n}$. Then, as
explained above, we only need elements connected to the identity and
therefore restrict attention to $\SOn{n}$.

\item[2011-03-17 JM]
I wasn't aware of this (subgroup) business. I'll have to read about that.

I take it you submitted your most recent paper to the Morrison
festschrift volume? I wrote a paper for that too.

\item[2011-03-17 PC]
Would you mind having a look at it,
\HREF{http://www.cns.gatech.edu/~predrag/papers/preprints.html\#FrCv11}
{\emph{Reduction of continuous}} \emph{symmetries of chaotic flows by the
method of slices}? It is on the same theme, and I'm afraid that until we
reduce KS, pipe flow and plane Couette flow symmetries there will be more
papers like this...

\item[2011-03-17 JM]
Sure, that was how I started, but then I decided I better read
your \emph{Physica D} paper first!

\item[2011-04-23 PC]
Michael Loss says we should look at Fefferman\rf{Feffer83} ``Uncertainty
principle,'' which he thinks attempts to define symplectic distances.
Fefferman's conjectures were proved by Hofer. I have looked at the paper,
and see no connection to what we do; it's about relations between
phase-space volumes and spectra of the Schr\"odinger operator.

\end{description}

    \newpage
\section{Text to return to ChaosBook.org}
\label{sect:toCB}

\subsection{Hamiltonian flows}
\label{sect:HamFlows}


An important class of flows are Hamiltonian flows,
given by a
% time-indepen\-dent
Hamiltonian $H(q,p)$ together with the Hamilton's
equations of motion
\index{flow!Hamiltonian}
%\toRem{rem:statespace}
\beq
\dot { q_i} = {\partial H \over \partial p_i}
    \,, \quad\quad  % \continue %\label{(1)} \\
\dot {p_i} = - {\partial H \over \partial q_i}
\,,
\ee{Ham_eQ}
with the $d= 2\DOF$ \emph{phase space} coordinates $\pSpace$ split into
the configuration space coordinates and the conjugate momenta of a
Hamiltonian system with $\DOF$ degrees of freedom (dof):
\index{degree of freedom}
	   \ifdasbuch
    \PublicPrivate{
    }{% switch \PublicPrivate{
\toSect{s-HamEqs}
    }% end \PublicPrivate{
		\else
		\fi
\beq
\pSpace=({\bf q},{\bf p})
\,,\qquad
{\bf q} = (q_1,q_2,\dots,q_\DOF)
\,,\qquad
{\bf p} = (p_1,p_2,\dots,p_\DOF)
\,.
\ee{2.7a}
The equations of motion for a time-independent, $\DOF$-dof Hamiltonian
\refeq{Ham_eQ} can be written compactly as
\index{symplectic!invariance}
\index{invariance!symplectic}
\beq
\dot{x}_i={\omega}_{ij} H_{,j}(\pSpace)
    \,, \quad
    H_{,j}(\pSpace) =
    \frac{\partial~}{\partial\pSpace_j} H(\pSpace)
        \,,
\ee{symplec}
\PC{use O. de Almeida book\rf{almeida88} argument here?}
where $\pSpace = ({\bf q},{\bf p}) \in \pS$ is a phase space point,
% $H{,{k} = \partial_k H$ is the column vector of partial derivatives of $H$,
a derivative of $(\cdot)$ with respect to $\pSpace_j$ is denoted by
comma-index notation $(\cdot)_{,j}$,
\beq
{\omega} = \MatrixII{0}{\bf I}{\bf -I}{~0}
	\,,
\ee{symplNormConv}
is an antisymmetric  [$d\!\times\!d$] matrix,
and ${\bf I}$ is the [$\DOF\!\times\!\DOF$] unit matrix.

Throughout ChaosBook we reserve the term `phase space' to Hamiltonian
flows. A `\statesp' is the stage on which any flow takes place.
'Phase space' is a special, but physically important case,
a \statesp\ with symplectic structure, preserved by the flow.

\example{Who ordered `symplectic?'}{
                    \label{exmp:SymplNewton}
												\toCB
Where does this skew-symmetric ${\omega}$ come from? Newton $f=ma$
law for a motion in a potential is
\(
m \ddot{q} = - \partial V
\,.
\)
Rewrite this as a pair of first order ODEs,
\(
\dot{q} = p/m
\,,
\dot{p} =  - \partial V
\,,
\)
define the total energy
\(
H(q,p) = p^2/2m + V(q)
\,,
\)
and voila, the equation of motion take on the symplectic form
\refeq{symplec}. What makes this important is the fact that the evolution
in time (and more generally any canonical transformation) preserves this
symplectic structure, as we shall show in \refsect{sect:CanonTransf}.
Another way to put it: a gradient flow $ \dot{x} =  - \partial V(x) $
contracts a \statesp\ volume into a fixed point. In contrast,
the `$-$' sign
in the symplectic action on
$(q,p)$ coordinates induces a rotation, and preserves phase space
areas.

	} %end \example{Who ordered `symplectic?'}{

\subsection{Symplectic group}
\label{sect:SymplctGroup}

A matrix transformation $\LieEl$ is called \emph{symplectic} if it
preserves the \emph{symplectic bilinear form} $\braket{\sspRed}{\pSpace}
= \sspRed^T {\bf \omega} \pSpace$,
\beq
\LieEl^T {\bf \omega} \LieEl = {\bf \omega}
	\,,
\ee{symlectNorm}
where
$\LieEl^T$ denotes the transpose of $\LieEl$,  and ${\omega}$ is a non-singular
[$2\DOF\!\times\!2\DOF$] antisymmetric matrix which satisfies
\index{symplectic!form}
%\ifOUP
%\notes{
%The term `symplectic' --Greek for twining or plaiting
%together-- was introduced
%into mathematics by Hermann Weyl.
%`Canonical' lineage is church-doctrinal:
%Greek `kanon,' referring to a reed
%used for measurement, came to mean
%in Latin a rule or a standard.
%      }
%\else
%\fi
\beq
{\bf \omega}^T=-{\bf \omega}\,,
\qquad {\bf \omega}^2 =- \matId
\,.
\ee{sympForm}
While these are defining requirements for any {symplectic bilinear form},
${\bf \omega}$ is often conventionally taken to be of form
\refeq{symplNormConv}.


\example{Symplectic form for $\DOF=2$:}{
                    \label{exmp:SymplTwoDof}
												\toCB
For two degrees of freedom the phase space is 4\dmn,
\(
\pSpace=(q_1,q_2,p_1,p_2)
\,,
\)
and the symplectic 2-form is
\beq
{\omega} = \left(
\begin{array}{cccc}
0  &  0 & 1 & 0\\
0  &  0 & 0 & 1\\
-1  &  0 & 0 & 0\\
0  &  -1 & 0 & 0
\end{array} \right)
	\,,
\ee{symlectNorm2D}
The symplectic bilinear form  $\braket{\pSpace^{(1)}}{\pSpace^{(2)}}$
is the sum over the areas of the
parallelepipeds spanned pairwise by components of the two vectors,
\beq
\braket{\pSpace^{(1)}}{\pSpace^{(2)}} =
(\pSpace^{(1)})^T {\bf \omega}\,\pSpace^{(2)} =
(q_1^{(1)}p_1^{(2)} -q_1^{(2)}p_1^{(1)})
	+
(q_2^{(1)}p_2^{(2)} -q_2^{(2)}p_2^{(1)})
\,.
\ee{twoFormD2}
It is this sum over oriented areas (not the Euclidean distance between the
two vectors, $|\pSpace^{(2)}-\pSpace^{(1)}|$) that is preserved by the
symplectic transformations.
    } %end \example{Symplectic form for 2 \dof

If $\LieEl$ is symplectic, so is its inverse $\LieEl^{-1}$, and if
$\LieEl_1$ and $\LieEl_2$ are symplectic, so is their product $\LieEl_2
\LieEl_1$. Symplectic matrices form a Lie group called the \emph{symplectic
group} $Sp(d)$.



\PC{Motivation:
We only need to say that for a continuous group (compact or not) we can
linearize the flow , and that
the tangent space is spanned by the Lie algebra, without
too much jargon aout duble covers and what-not.
	}
%
%\item[2011-03-17 JM]
% + Banks "Modern Quantum Field Theory" 2008 textbook, Appendix E
Use of the symplectic group necessitates a few remarks about
Lie groups in general, a topic that we study in more depth in
	   \ifdasbuch
\refchap{c-continuous}.
		\else
Chapter continuous.tex.
		\fi
A \emph{Lie group} is a group whose elements $\LieEl(\gSpace)$ depend smoothly
on a finite number $N$ of parameters $\gSpace_a$. In a linearized neighborhood
of a given group element,
\[
\LieEl(\gSpace+\delta\gSpace) \simeq \LieEl(\gSpace)
+  \sum_{a=1}^N  \delta\gSpace_a
	\frac{\partial \LieEl(\gSpace)}{\partial_a \gSpace}
\,,
\]
the $[d\!\times\!d]$ matrices
\(
{\partial \LieEl(\gSpace)}/{\partial_a \gSpace}
\)
span the \emph{tangent space} at $\LieEl(\gSpace)$. With an application
of the inverse of a group element $\LieEl^{-1}$, this neighborhood can be
mapped into a neighborhood $\LieEl(\delta\gSpace)$ of the identity
$\LieEl(0)=1$, so the local structure of Lie groups can be understood by
studying the tangent space near the identity element, generated by
\[
\LieEl(\delta\gSpace) \simeq 1
+ \sum_{a=1}^N \delta\gSpace_a \left.
	\LieEl(\gSpace)^{-1}
	\frac{\partial \LieEl(\gSpace)}{\partial_a \gSpace}
		\right|_{\gSpace=0}
\,.
\]
We find it convenient to write this in a specific basis
(repeated indices are summed throughout this
chapter, and the dot product refers to a sum over
Lie algebra generators):
\index{Lie!algebra}\index{generator!Lie algebra}
\beq
\LieEl(\delta\gSpace) \simeq 1 + \delta \gSpace \cdot \Lg
% \LieEl{}_i{}^j \simeq \delta_i^j +  \delta \gSpace_a \, (\Lg_a)_i^j
    \,,\quad
\delta\gSpace \in \reals^N
    \,,\quad
|\delta \gSpace| \ll 1
    \, ,
\ee{InftsmLieTransf}
where $\{\Lg_1,\Lg_2\cdots,\Lg_N\}$, the {\em generators} of
infinitesimal transformations, are a set of $N$ linearly independent
$[d\!\times\!d]$ matrices which span the tangent space and act linearly
on the $d$-dim\-ens\-ion\-al phase space $\pS$. As we shall see
	   \ifdasbuch
in \refsect{??}.
		\else
later,
		\fi
they endow the tangent space with a Lie algebra structure. Globally
different Lie groups may have the same local structure: for example, near
the identity $\SOn{n}$ and $\On{n}$ have the same Lie algebra $so(n)$.

The infinitesimal statement of symplectic invariance follows by
substituting \refeq{InftsmLieTransf} into \refeq{symlectNorm} and keeping
the linear terms in $|\delta \gSpace|$,
\index{symplectic!transformation}
\index{canonical transformation}
\beq
 \Lg_a^T {\bf \omega} + {\bf \omega} \Lg_a = 0
\,.
\ee{symFunny_L}
This is the defining property for infinitesimal generators of {\em
symplectic} transformations. Matrices that satisfy \refeq{symFunny_L} are
sometimes called \emph{Hamiltonian matrices}. A linear combination  of
Hamiltonian matrices is a Hamiltonian matrix, so Hamiltonian matrices
form a linear vector space, the \emph{symplectic
Lie algebra} $sp(d)$, or, in the Cartan-Killing classification of
simple Lie algebras, Lie algebra $C_\DOF$. Here the subscript $\DOF$
refers to the the number of mutually commuting generators,
or the \emph{rank} of the algebra
By the antisymmetry of $\omega$,
\index{Hamiltonian!matrix}
\beq
({\bf \omega} \Lg_a)^T = {\bf \omega} \Lg_a
\,.
\ee{HamMatr2}
is a symmetric matrix. Its number of independent elements gives the
dimension of the symplectic group $Sp(d)$,
\beq
N= {d(d+1)}/{2} = \DOF (2 \DOF+1)
\,.
\ee{symplDim}
The lowest-dimensional symplectic group $Sp(2)$, of dimension $N=3$,
is isomorphic to $SU(2)$ and $\SOn{3}$. The first interesting case is
$Sp(3)$ whose dimension is $N=10$.

It is easily checked that the exponential of a Hamiltonian matrix
\beq
\LieEl = e^{\gSpace \cdot {\Lg}}
\ee{SymplExcp}
is a symplectic matrix; Lie \emph{group} elements are related to the Lie
\emph{algebra} elements by exponentiation.


\example{
    \ifboyscout
So near, and yet so far
    \else
How far are two points from each other in a symplectic vector space?
    \fi
}{
                    \label{exmp:SymplDistance}
												\toCB
The notion of distance has no meaning for $Sp(d)$.
Under symplectic action areas are mapped into equal                                             areas of different shapes, so the Euclidean distance
between two points has no invariant meaning, it can be
mapped into any other separation under a symplectic
transformation.
Consider the sum of oriented areas (a sophisticate
would say the `action'), as in \refeq{twoFormD2}
\[
S(\pSpace,\slicep) =
\braket{\pSpace}{\slicep} =
%		\pSpace^T {\bf \omega} \, \slicep
\sum_{j=1}^\DOF (q_j^{(1)}p_j^{(2)} -q_j^{(2)}p_j^{(1)})
\]
spanned by a pair of vectors joined by the symplectic 2-form.

Think of one of the patterns
(represented by a point {\slicep} in the phase space  \pS) as a
`template'
%\rf{rowley_reconstruction_2000,%
%rowley_reduction_2003,%
%ahuja_template-based_2007}
or a `reference state' and act with elements of the symplectic group
$Sp(d)$ on it, $\slicep \to \LieEl(\gSpace)\,\slicep$, until
its `distance' to the second pattern (a point $\ssp$ in the phase space),
\beq
S(\ssp,\LieEl(\gSpace)\,\slicep)
    = S(\sspRed,\slicep)
\label{minDistanceSp}
\eeq
is extremized.
Here $\sspRed$ is the point on the group orbit of $\ssp$
(the set of all points that $\ssp$ is mapped to under the group
actions),
\beq
\ssp=\LieEl(\gSpace)\,\sspRed
	\,,\qquad
\LieEl \in \Group
\,.
\ee{sspOrbit}

Unlike the Euclidean length, the symplectic bilinear form is not positive
definite (see \refeq{twoFormD2}), and this `distance' is emphatically not
a Euclidean distance, but it is -by the definition- invariant under symplectic
transformations, $S(\LieEl\pSpace,\LieEl\slicep)=S(\pSpace,\slicep)$. If
\slicep\ is on the group orbit of $\ssp$, the form can be made to exactly
vanish by its antisymmetry, $\braket{\slicep}{\slicep} = 0$, so nearby
group orbits do have a small minimal `distance' $|S(\sspRed,\slicep)|$
which satisfies the extremum conditions
\beq
\frac{\partial ~~}{\partial \gSpace_a} \braket{\ssp}{\LieEl(\gSpace)\,\slicep}
   =
\braket{\sspRed}{\sliceTan{a}}
   = 0
    \,,\qquad
\LieEl(\gSpace)\,\sspRed = \ssp
    \,,\qquad
\sliceTan{a} = \Lg_a \slicep
\,.
\ee{SpSlice}
The closest group orbit points thus lie in a $(d\!-\!N)$\dmn\ hyperplane
$\pSRed = \pS/\Group$, the set of vectors $\sspRed \in  \pSRed$
orthogonal to the {\template} tangent space in the
\emph{symmetric} $({\bf \omega} \Lg_a)$ norm
\beq
\sspRed_i({\bf \omega} \Lg_a)_{ij}\slicep_{j} = 0
\,.
\ee{hyperplSp}
In what follows we shall refer to this hyperplane as a \emph{slice,} and
to  \refeq{SpSlice} as the \emph{slice conditions}. The slice
reduces the symplectic symmetry, with the reduced \statesp\ of
(negative !) dimension
$d-N  =  d - {d(d+1)}/{2} = - d(d-1)/2$.

Something is amiss here... The group orbit of $\ssp \in \pS$ is embedded
into $\pS$, so it cannot be of a higher dimension than $d$, but the dimension of
the tangent space of the most general
action of the group is $N \propto d^2$ (I'm thinking of $U(d)$, $\SOn{d}$ and
$Sp(d)$ now), so I cannot fit all of it in a $d$-dimensional phase space.
What gives?
    } %end \example{Symplectic form for 2 \dof


\subsection{Canonical transformations}
\label{sect:CanonTransf}

The
evolution of $\jMps^t$
    \ifdasbuch
\refeq{hOdes}
    \else
    \fi
is again determined by
    \ifdasbuch
the {\stabmat} $\Mvar$, \refeq{Bew_Miaw}:
    \else
the {\stabmat} $\Mvar$:
    \fi
%%RA e
\index{Hessian matrix}
\beq
{d\over dt}\jMps^t(\pSpace) = \Mvar(\pSpace)
\jMps^t(\pSpace)
\,, \qquad
\Mvar_{ij}(\pSpace)={\omega}_{ik}\,H_{,kj}(\pSpace)
\,,
\ee{Bew_Mon}
where the symmetric matrix of second derivatives
$H_{,kn} = \partial_k \partial_n H$
%index%$H_{,kn}=\partial_k \partial_n H$
is called the {\em Hessian matrix}.
From
% \refeq{Bew_Mon} and
the symmetry of $H_{,kn}$
%index% $H_{kn}$
it follows that for Hamiltonian flows \refeq{symplec}
\index{symplectic!transformation}
\index{canonical transformation}
\beq
 \Mvar^T {\bf \omega} + {\bf \omega} \Mvar = 0
\,.
\ee{Funny_L}
%\label{Sp_L}
This is the defining property \refeq{symFunny_L} for infinitesimal
generators of {\em symplectic} (or canonical) transformations.
\PC{make sure nothing refers to eq. \texttt{sympQ}}

Consider now a smooth nonlinear change of variables of form $y_i=h_i(x)$,
and define a `Kamiltonian' function $K(x)=H(h(x))$. Under which conditions does
$K$ generate a Hamiltonian flow? In what follows we will use the notation
$\partial_{\tilde{j}}=\partial/\partial y_j$,
$s_{i,j} =
% (\partial h)_{ji}= \frac
{\partial h_i}/{\partial x_j}$
.
By employing the chain rule we
have that
%\GT{It would be nicer, conceptually, to define trafo(?) $x \to y= h(x)$
%and transform $H(x)$  into $K(y) = H(g(y)$ with $g = h^{-1}$. PC: as you
%wish - just make sure that it is consistent with $h$ as defined in conjug.tex}
\beq
%\omega_{ij}
K_{,j} \,=\,
% \omega_{ij}
H_{,\tilde{l}}
s_{\tilde{l},j}
% \frac{\partial h_l}{\partial x_j}
\eeq
(Here, as elsewhere in this book, a repeated index implies summation.)
By virtue of \refeq{Ham_eQ} $\tilde{\partial}_l H=-\omega_{lm}\dot{y}_m$, so
that, again by employing the chain rule, we obtain
\beq
\omega_{ij} \partial_j K \,=\, -\omega_{ij} s_{j,l}
% \frac{\partial h_l}{\partial x_j}
\omega_{lm}
s_{m,n}
% \frac{\partial h_m}{\partial x_n}
\dot{x}_n
\eeq
The right hand side simplifies to $\dot{x}_i$ (yielding Hamiltonian
structure) only if
\beq
-\omega_{ij} s_{l,j}
% \frac{\partial h_l}{\partial x_j}
\omega_{lm}
s_{m,n}
%\frac{\partial h_m}{\partial x_n}
\, =\, \delta_{in}
\eeq
or, in compact notation,
\beq
-\omega (\partial h)^T \omega (\partial h) \,=\, \matId
\eeq
which is equivalent to the requirement \refeq{symlectNorm} that $\partial
h$ is symplectic. h is then called a {\em canonical transformation}.
\index{canonical transformation}
\index{symplectic!map}
We care about canonical transformations for two reasons.
%\toExam{exmp:UnderstFlows}
First (and this is a dark art), if the canonical transformation $h$ is
very cleverly chosen, the flow in new coordinates might be considerably
simpler than the original flow. Second,  Hamiltonian flows themselves are
a prime example of canonical transformations.


\section{Poincar\'e invariants}
% Predrag                             20sep2003
% moved here from \Chapter{appendStability}{11sep2001}

Let $C$ be a region in phase space and $V(0)$ its volume.
Denoting the flow of the Hamiltonian system by $f^t(x)$,
the volume of $C$ after a time $t$ is $V(t)=f^t(C)$,
	   \ifdasbuch
and using \refeq{detJ-Ham}
		\else
		\fi
we derive the {\em Liouville theorem}:
\index{conservation!phase space volume}
\index{Liouville!theorem}
\bea
V(t)&=&\int_{f^t(C)}dx=\int_C\left|
        \det \frac{\partial f^t(x')}{\partial x~~}
                   \right| dx'
    \ceq
    \int_C\det(\jMps)dx'=\int_C dx'=V(0)
\,,
\label{LiuvVolCons}
\eea
Hamiltonian flows preserve phase space volumes.

\index{Poincar\'e invariants}
The symplectic structure of Hamilton's equations buys us much more
than the `incompressibility,'
or the phase space volume conservation.
%
%%% comment NW: The punch line here is lost. It is not clear if you
%%% are using the identity J^TwJ=w to prove that symplectic areas are
%%% conserved or vice-versa (they are equivalent statements so the
%%% sense of the proof could be in either direction.) Assuming it is
%%% the former, I have reworded it a bit to make the point clearer.
%%% (I saved the previous version of the paragraph in case it is
%%% preferred.)
%
%
%%% fixed NW: added `the'
Consider the symplectic product of two infinitesimal vectors
\bea
(\delta\pSpace,\delta\hat{\pSpace})
   &=& \delta\pSpace^T \omega \delta\hat{\pSpace}
           =  \delta p_i \delta \hat{q}_i
            - \delta q_i \delta \hat{p}_i
        \continue
    &=& \sum_{i=1}^{\DOF} \left\{
           \mbox{oriented area in the } (q_i,p_i)  \mbox{ plane}
                       \right\}
\,.
\eea
Time $t$ later we have
\[
(\delta\pSpace',\delta\hat{\pSpace}')
    = \delta\pSpace^T \jMps^T \omega \jMps \delta\hat{\pSpace}
    = \delta\pSpace^T \omega \delta\hat{\pSpace}
\,.
\]
%%% begin NW: I added a statement here since without it, the punchline
%%% of the above statement is a little lost, I think.
%
This has the following geometrical meaning. We imagine there is a
reference phase space point. We then define two other points
infinitesimally close so that the vectors $\delta\pSpace$ and
$\delta\hat{\pSpace}$ describe their displacements relative to the
reference point. Under the dynamics, the three points are mapped to
three new points which are still infinitesimally close to one
another. The meaning of the above expression is that the area of the
parallelopiped
 spanned by the three final points is the same as that spanned by
the initial points.
%%% end NW
%
The integral (Stokes theorem) version of this infinitesimal area
invariance states that for Hamiltonian flows the $\DOF$ oriented areas
${\cal V}_i$ bounded by $\DOF$ loops $\Omega {\cal V}_i$, one per each
$(q_i,p_i)$ plane, are separately conserved:
\index{Stokes theorem}
\beq
\int_{\cal V} dp \wedge dq = \oint_{\Omega \cal V} p \cdot dq
  = \mbox{invariant}
\,.
\ee{sympAreaCons}
Morally a Hamiltonian flow is really $\DOF$-dimensional, even
though its phase space is $2\DOF$-dimensional. Hence for Hamiltonian flows
one emphasizes $\DOF$, the number of the degrees of freedom.
\index{phase space}



\Resume

Hamiltonian flow
$
\dot{x}_i={\omega}_{ij} H_j(\pSpace)
$%
% \ee{symplec}
,
$
\omega_{mn} = - \omega_{nm}
$
is canonical in the sense that
$x' = \flow{t}{x}$ is a transformation
whose \jacobianM\ $\jMps = \pde x' / \pde x$
preserves the symplectic invariant
$\monodromy^T {\bf \omega} \monodromy = {\bf \omega}$
.
Infinitesimal symplectic transformations are generated by
$
\Mvar_{ij}={\omega}_{ik}\,H_{kj}
$
satisfying
$
 \Mvar^T {\bf \omega} + {\bf \omega} \Mvar = 0
$
.
This implies that $\Mvar$
 are elements of the symplectic algebra $sp(2 \DOF)$,
and that the $2\DOF$-dimensional flow preserves
$\DOF$ oriented infinitesimal areas
$
   \delta\pSpace^T \omega \delta\hat{\pSpace}
           =  \delta p_i \delta \hat{q}_i
            - \delta q_i \delta \hat{p}_i
$
.
The Liouville phase space volume
conservation is a consequences of this general
invariance.

  \ResumeEnd



  \Remarks

													\toCB
\remark{Hamiltonian dynamics literature.}{
\index{symplectic!invariance}
\index{invariance!symplectic}
If you are reading this book, in theory you already know everything
that is in this chapter. In practice you do not. Try this: Put your right hand
on your heart and say: ``I understand why nature prefers symplectic geometry.''
Honest?
    \PublicPrivate{
    }{% switch \PublicPrivate{
We make an attempt in \refsect{s:HamJac}.
    }% end \PublicPrivate{
Out there there are
about 2 centuries of accumulated literature on Hamilton, Lagrange, Jacobi etc.
formulation of mechanics, some of it excellent. In context of what we will need
here, we make a very subjective recommendation--we
enjoyed reading Percival and Richards\rf{PerRich82N} and
Ozorio de Almeida\rf{almeida88}.
\label{r:HamJacLit}
    } %end \remark{Rectification of maps.}{

\ifOUP
\else
\remark{Symplectic.}{
The term symplectic --Greek for twining or plaiting
together-- was introduced
into mathematics by Hermann Weyl.
`Canonical' lineage is church-doctrinal:
Greek `kanon,' referring to a reed
used for measurement, came to mean
in Latin a rule or a standard.
        } %end \remark{Symplectic.}{
\fi

%%% comment NW: retitled the remark to conform to new remark.
\remark{The sign convention of $\omega$.}{
The overall sign of $\omega$, the symplectic invariant in \refeq{symplec},
is set by the convention that the Hamilton's principal function
(for energy conserving flows) is given by
$R(q,q',t) =  \int_q^{q'} p_i dq_i - Et$. With this sign
convention the action along a classical path is minimal, and
the kinetic energy of a free particle is positive.

%\hfill (M.J. Feigenbaum)
} %end \remark{History of the sign convention.}{

\remark{Symmetries of the \topp.}{
For a more detailed discussion of symmetry lines see
\refrefs{gree79,Mira87,RSW90N,shka,GrMaViFe81}. It is an open question (see
\refrem{r:symmOther}) as to how time reversal symmetry can be
exploited for reductions of cycle expansions. For example, the
fundamental domain symbolic dynamics for reflection symmetric
systems is discussed in some detail in \refsect{s-C-2-fact},
but how does one recode from time-reversal symmetric symbol
sequences to desymmetrized 1/2 {\statesp} symbols?

\PublicPrivate{
      }{ % switch \PublicPrivate{
In discussion of \refexam{exmp:RevHenonMap}, we have followed
\refrefs{HamSteDuMei99,HamSteDuMei04,HamGomez02}.
      }% end \PublicPrivate

\PC{improve references}
} %end \remark{Symmetries of the \topp.}{

\remark{Standard map.}{ \label{rem:GreenResid}
\index{standard map}
Standard maps model free rotators under the influence of short
periodic pulses, as can be physically implemented, for
instance, by pulsed optical lattices in cold atoms physics. On
the theoretical side, standard maps exhibit a number of
important features: small $k$ values provide an example of
$KAM$ perturbative regime (see \refref{JoSa}), while for larger
$k$ chaotic deterministic transport is
observed\rf{Chirikov79,meis92}; the transition to global chaos
also presents remarkable universality
features\rf{gree79,gree98,shka}. Also the quantum counterpart
of this model has been widely investigated, being the first
example where phenomena like quantum dynamical localization
have been observed\rf{GiBo}.
Stability residue was introduced by Greene~\rf{gree98}.
For some hands-on experience of
the standard map, download Meiss simulation code\rf{Mei08}.
\index{residue!stability}
\index{stability!residue}
} %end \remark{Standard map.}

\remark{Loxodromic  quartets.}{ \label{rem:loxodromic}
\index{loxodromic!quartet}
For symplectic flows, real eigenvalues always come paired as
$\ExpaEig$, $1/\ExpaEig$, and complex eigenvalues come either
in $\ExpaEig$, $\ExpaEig^*$ pairs, $|\ExpaEig| = 1$, or
$\ExpaEig$, $1/\ExpaEig$, $\ExpaEig^*$, $1/\ExpaEig^*$
loxodromic quartets. As most maps studied in introductory
nonlinear dynamics are $2d$, you have perhaps never seen a
loxodromic quartet. How likely are we to run into such things
in higher dimensions? According to a very extensive study of
periodic orbits of a driven billiard with a four dimensional
phase space, carried in \refref{LPKDS09}, the three kinds of
eigenvalues occur with about the same likelihood.
} %end \remark{Loxodromic quartets.}

%\item[2011-03-25 PC]
Exposition of \refsect{sect:SymplctGroup} follows Dragt\rf{Dragt05}.
There are two conventions in literature for what the integer argument of
$Sp(\cdots)$ stands for: either $Sp(D)$ or $Sp(d)$ (used, for example, in
\refrefs{Dragt05,PCgr}), where $\DOF$ = \dof, and $d=2\DOF$. As explained
in Chapter 13 of \refref{PCgr}, symplectic groups are the `negative
dimensional,' $d \to -d$ sisters of the orthogonal groups, so only the
second notation makes sense in the grander scheme of things.
Mathematicians can even make sense of the $d= $odd-dimensional case,
see ``Odd symplectic groups'' by Proctor\rf{Proctor88,GeZe84}, by dropping
the requirement that $\omega$ is non-degenerate, and defining
a symplectic group $Sp(\pS,\omega)$ acting on a vector space $\pS$
as a subgroup of $Gl(\pS)$ which preserves a skew-symmetric bilinear form
$\omega$ of \emph{maximal possible rank.} The odd symplectic groups
$Sp(2\DOF+1)$ are not semisimple.
If
you care about group theory for its own sake (our dynamical systems
symmetry reduction techniques are still too primitive to be applicable to
Quantum Field Theory), Chapter 14  of \refref{PCgr} is fun, too.

Any finite-dimensional symplectic vector space has a \emph{Darboux basis}
such that $\omega$ takes form \refeq{symlectNorm}.

Referring to the $Sp(d)$ Lie algebra elements as  `Hamiltonian matrices'
as one sometimes does\rf{Dragt05,wikiHamMat} conflicts with
what is meant by a `Hamiltonian matrix' in quantum mechanics: the quantum
Hamiltonian sandwiched between vectors taken from any complete set of
quantum states. Not sure where this name comes from; Dragt cites
\refrefs{Fulton91,Georgi99}, and  Chapter 17 of his own book in
progress. %\rf{Dragt11}.
Fulton and Harris\rf{Fulton91} seem to use it. Certainly Van
Loan\rf{PaiL81} uses in 1981. Taussky in 1972. Might go all the way back
to Sylvester?

Dragt\rf{Dragt05} convention for phase space variables is as in
\refeq{2.7a}. He calls the dynamical trajectory $\xInit \to
\pSpace(\xInit,t)$ the `transfer map.' That conflict with the well
established use of `transfer matrices' in statistical mechanics.

In the mathematics literature the Lie operator $:f:$ is sometimes
referred to as $ad(f)$ where $ad$ is shorthand for adjoint. Dragt uses the
$:f:$ notation instead of $ad(f)$ because `it facilitates the writing of
complicated expressions.'

I call the matrix of second derivatives of the Hamiltonian, $H_{,kn}=
\partial_k \partial_n H$, the `Hessian matrix.'
${\omega}_{ik}\,H_{,kj}(\pSpace)$ in \refeq{Bew_Mon} is the (instantaneous)
{\stabmat} of the flow - it is a Hamiltonian matrix. Its integral along
the trajectory, the linearization of the flow ${\jMps}$ that ChaosBook (as well
as Dragt\rf{Dragt05}) call the `\JacobianM,' is symplectic.
Coordinate transformations whose gradient is symplectic are called
`canonical transformations'. Hamiltonian flow $\flow{t}{\pSpace}$ is a
canonical transformation, with the linearization $\jMps_{kn} = \partial_n
\flow{t}{\pSpace}_k$  a symplectic transformation.

        } %end \remark{Symplectic.}{

\remark{Sources.}{\label{rem:sources}
													\toCB
Dragt and Habib\rf{DraHab08,Dragt05} offer a concise discussion of
symplectic Lie operators and their relation to Poisson brackets:
incorporate this into the Liouville operator discussion in ChaosBook.org.

													\toCB
\PC{put into period doubling}
Curiosity: in \refref{Dragt11} Dragt says ``Sometimes Feigenbaum
diagrams are called bifurcation diagrams. However. strictly speaking,
bifurcation diagrams should also display the unstable fixed points, and
Feigenbaum diagrams generally do not.
[news to Predrag].''
And he does not credit the other guy for the fixed-point equation.
The book is more extreme than even ChaosBook.org: 1872 pages. But
considerably more repetitive.

\toCB
\PC{put into introduction}
Dragt: ``The use of the term bifurcation in
the context of dynamics is due to Poincar\'e.''

        } %end \remark{Sources.}

\remark{Killing fields.}{\label{rem:Killing}
													\toCB
The symmetry tangent vector fields discussed here are a special
case of Killing vector fields of Riemannian geometry and special relativity.
From \HREF{http://en.wikipedia.org/wiki/Killing_vector}{wikipedia}
(\HREF{http://en.wikipedia.org/wiki/Spacetime_symmetries}{this wikipedia}
might also be useful):
A Killing vector field is a set of infinitesimal generators of isometries
on a Riemannian manifold that preserve the metric. Flows generated by
Killing fields are continuous isometries of the manifold. The flow
generates a symmetry, in the sense that moving each point on an object
the same distance in the direction of the Killing vector field will not
distort distances on the object.

A vector field $X$ is a Killing field if the Lie derivative with respect to
 $X$ of the metric $g$ vanishes:
\beq
    \mathcal{L}_{X} g = 0 \,.
\ee{LieKilling}
\PC{some clip \& paste math gibberish}
Killing vector fields can also be defined on any (possibly nonmetric)
manifold $\pS$ if we take any Lie group $\Group$ acting on it instead of
the group of isometries. In this broader sense, a Killing vector field is
the pushforward of a left invariant vector field on $\Group$ by the group
action.
%If the group action is effective, then
The space of the Killing vector fields is isomorphic to the Lie algebra
$\mathfrak{g}$ of $\Group$.

If the equations of motion can be cast in Lagrangian form, with the
Lagrangian exhibiting variational symmetries\rf{Bluman07,BlumanAnco02},
Noether theorem associates a conserved quantity with each Killing vector.
	\PC{combine this with the ChaosBook Noether remark}
        } %end \remark{Killing fields.}

  \RemarksEnd

\renewcommand{\LieEl}{\ensuremath{\gamma}}  % also a Siminos Lie group element
\renewcommand{\ssp}{a}
