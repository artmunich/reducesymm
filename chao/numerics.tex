\ifsvnmulti
\svnkwsave{$RepoFile: siminos/chao/numerics.tex $}
\svnidlong {$HeadURL$}
{$LastChangedDate$}
{$LastChangedRevision$} {$LastChangedBy$}
\svnid{$Id$}
\fi


\chapter{Numerics}
\label{chap:numerics}


\section{Numerical simulations of KS}
\label{s:KSnumerical}

\begin{description}

\item[2011-08-24 PC to Chao]
Please describe here your progress with numerical simulations.

\item[2011-09-09 PC to ES]
Please do not to repeat the mistakes of your graduate student years, Chao
is under strict orders to enter into the blog everything he learns as he
learns it, so do not share secrets by email, enter them - I would also
like to learn how to run your KS codes.

\item[2011-03-16 PC to Ruslan and Evangelos]
   Chao Shi, shichao116@gmail.com is starting (rather late) to work on
   slicing and dicing \KS\ as a 1st year graduate student
   project. Hopefully we can get him to speed with your and Stefan's help
   within the next six months. At the moment he is reading parts of
   ChaosBook and our articles, but it might be wise that you teach him
   immediately how to use your KS programs and data, so we do not waste
   time on that. Chao can compute. He says.

\item[2011-03-29 Ruslan]
Hi Chao.  If you want to use Matlab for your explorations of the \KS,
then all my Matlab files can be found in /siminos/chao/matlab/ruslan.
File ksdupo.m is the primary file.  I'm using the cells feature of
Matlab, so this file contains many sections that can be run
independently.  There is not much in the way of comments, so you'll have
to work it out for yourself.  I'll be happy to guide you through it if
you ask specific questions.

\item[2011-04-10 ES to CS] Chao, my Fortran 90 code to integrate KSe, find
\po s etc is in the svn repository \texttt{vaggelis}. The file 00README.txt
explains what you'll find in each directory. The basic routines in the
directory \texttt{libraries} are in general well documented. The driver routines in
\texttt{testing} and \texttt{production} are less well documented. In most
low-level directories there are three subdirectories (branches, trunk and tags).
The current code is always in trunk, ignore the rest. I think that, for what you
will have to do, you will find Ruslan's matlab code easier to use (KSe is not that
expensive to integrate in terms of CPU time, at least for small system size). In any
case I'd be glad to answer your questions about where to find what and how to
use the code.

\item[2011-09-06 PC to ES]
Chao would like to get started on numerical work, so I told him to
    \texttt{svn checkout vaggelis}
and he did - I saw the file system on his machine with my very own eyes.

Now he's done something \textbf{scary} with it (looks like he has added svn configuration
files as repository files?) - I will not touch it until you make sure it is healthy and
instruct him to do the right thing, both with this repository, and what codes to start
testing.

\begin{verbatim}
Added:
  README.txt
  conf/
  conf/authz
  conf/passwd
  conf/svnserve.conf
  db/
  db/current
  db/format ...
\end{verbatim}

\item[2011-09-09 PC to ES]
I'll try to replace Chao's 'enhanced' \texttt{vaggelis} repository by a
pre-chaos CNS backup on Tuesday. In the meantime, can you two guys skype
each other: he has the \texttt{vaggelis} repository and is sworn not to
check in anything more into it until such time you let him.

\item[2011-09-25 PC to ES]
Restoring this has been a major pain, I've spent at least 3 hours
plugging in various backup drives so far... I have a copy from
\begin{verbatim}
2011-04-10 srv/svn/repos/vaggelis/db/revs/1120
\end{verbatim}
Would that be good enough?
Now I have checked, and \texttt{rev. 1120} is the last before Chao's 
magic touch,
so I'll go ahead and attempt to restore it from zero backups. Instructions
are \HREF{http://www.cns.gatech.edu/CNS-only/backupInstr.txt}{here}. 
Need to be superuser.
Find the files you need from the list, then extract them
\begin{verbatim}
cd /mnt/auto/sdd/current
less /mnt/auto/sdd/current/zero\_1.lst
cd ~/tmp/
tar xvfz /mnt/auto/sdd/previous/zero\_1.tgz \
         srv/svn/repos/vaggelis/
\end{verbatim}
can take 3 hours - going through at least 3GB on a USB drive.
I finally succeeded. There is also a backup on \texttt{one.physics},
which is much easier to use; can even use
it remotely - but it did not work for me (the GUI froze)

Please rename your version of \texttt{vaggelis}, svn check out the
current one, check it out, then {\em delete} the old one, 
so there is no chance of Chao's contamination returning into the repository.
Thanks!

\item[2011-09-26 ES to PC]

Yes, \texttt{rev. 1120} is the one we need. The hole directory vaggelis will have
to be replaced so that there are no lingering internal svn files left.

\end{description}

\section{Fortran notes}
\label{s:fortran}

\begin{description}

\item[2011-09-09 PC to ES]
I tried to find the \texttt{00README.txt} documentation that you mention
above, and I failed, and he is floundering around; seems to be reading
either \texttt{Fortran 95} manuals or girlie magazines. I cannot tell.
It's all in Chinese.

If we need to install some libraries, I can do it - KGB does not control
everything, as yet.


\item[2011-09-11 CS to ES] Finished scanning Fortran user guide, in order
to deal with the psychological block of reading fortran90 code. Still
have to get used to compiling and debugging in a terminal. Evangelis, can
we make an appointment for skyping? I need some guidance to start
understanding and testing your code. I'm available almost anytime in the
afternoon and night. Thanks!

\item[2011-09-11 PC] When it is 3pm in Atlanta it is 9pm in Dresden.

\item[2011-09-25 Chao to Evangelos]
Hi Evangelos, now I want to start doing the integration of \KSe. I guess the code you used for integration is in vaggelis/libraries/integr/truck. There're many source code files in it. Would you please give me some direction about the function of different files and the numeric methods you used for integration? Thanks!

Specifically, in the file \texttt{ifc\_integr.f90}, I found the declaration of these basic functions or routines: MatVar, derivs, SetNlin, SetAndiag, integrator, integratorJ. But I couldn't find there definition the whole directory, are they included in other MODULEs?

\item[2011-09-26 Evangelos to Chao] Chao, how experienced are you with
code development in linux? I'll try to answer your questions assuming some
experience, but please let me know if you need more explicit instructions. 
Also, what is your programming experience? Which languages are you familiar
with and in what enviroments?

\item[2011-09-26 Chao to Evangelos] Thanks. I'm familiar with C in windows enviroment, so I have little experience with code development in linux. I'll try to figure out what you said 

\item[2011-09-26 Evangelos to Chao] In a nutshell, the code is organized in
several libraries, each in each own directory. Directory named trunk contains
the main line of developement. The one you have to compile first is in 
vaggelis/libraries/nr/trunk (these are numerical recipes headers taken from
nr.com). You have to run the command \textbf{make} and if this compiles without
problem run \textbf{make install}. Most probably there will be problems, so you
will have to read vaggelis/libraries/nr/trunk/makefile to understand what's
wrong, or send me the error message.

The library integr only requires the presence of nr in your system to compile
correctly (and some system libraries, \eg\ fftw3).

Reading  parts of ``Numerical Recipes in Fortran 90,'' might help you, 
as the organization of the code follows the strategy layed out there.
Regarding numerical algorithms, I implement ETDRK4 scheme of Kassam and
Trefethen\rf{ks05com}.

Once the repository vaggelis is up and running I'll try to improve the 
documentation. Meanwhile, let me know how it goes. It might be more efficient
to just skype me if you see me online (but I'm trying to get settled down in
Dresden so I am usually offline).

\item[2011-09-26 Chao to Evangelos] The error message after running make command:

rm -f /home/cshi31/lib-/modules/nrtype.mod nr.mod nrutil.mod\\
rm -f /home/cshi31/lib-/libnr.a\\
c  -o nrtype.o  nrtype.f90 \\
make: c: Command not found\\
make: [nrtype.mod] Error 127 (ignored)\\
c  -o nrtype.o  nrtype.f90 \\
make: c: Command not found\\
make: [nrtype.o] Error 127 (ignored)\\
c  -o nr.o  nr.f90 \\
make: c: Command not found\\
make: [nr.o] Error 127 (ignored)\\
c  -o nrutil.o  nrutil.f90 \\
make: c: Command not found\\
make: [nrutil.o] Error 127 (ignored)\\
ar cr libnr.a nrtype.o nr.o nrutil.o \\
ar: nrtype.o: No such file or directory\\
make: *** [libnr] Error 1\\

\item[2011-09-26 Evangelos to Chao] Before I can explain what to do: 
What fortran compiler do you use/plan to use?
The code is tested with Intel's ifort, which I hope is installed there (you
could maybe install it yourself, within your account if the free academic use 
version still exists).                                   

\item[2011-09-28 Chao to Evangelos]I find the manual for gfortran so I think I'm using the GNU Fortran 95 compiler bulit in the machine. What's the command you use when compiling with ifort? I don't think it's installed.

\item[2011-09-28 Evangelos 2 Chao]You invoke intel fortran by the command ifort. If it's not installed on the CNS network or some cluster, then there is not much you can do 
(if you are research assistant you don't qualify for a non-commercial licence). How do you invoke gfortran?

\item[2011-09-29 Chao to Evangelos] I tried ifort but ``command not found''. I invoke gfortran with ``gfortran'' or ``f95''

\item[2011-10-04 Evangelos]
\begin{enumerate}
 \item Create a folder lib-gfortran in your home directory.
 \item Within lib-gfortran create subdirectory modules.
 \item In your .bashrc file add the line:
  \verb| export COMP=gfortran |
 \item Run make in nr directory (start a new terminal)
\end{enumerate}
Works for me! 

\item[2011-10-10 Chao]
Evangelos would you mind explaining ``subdirectory modules'' a little bit? Sorry that I'm a beginner in linux and fortran. Thanks!

\end{description}
