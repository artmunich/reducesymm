% siminos/atlas/flotsam.tex    master file: main.tex
% $Author$ $Date$

\section{Flotsam}
\label{s:flotsam}

\subsection{Pipe flows}
\label{s:review}
% former siminos/atlas/review.tex    master file: main.tex

As long as one is focusing on a single solution of \NSe, there are many
excellent, physically insightful $3D$ visualizations of the flow:
velocity fields on flow sections, isovorticity surfaces, videos of the
flow, and so on. But today we own dozens of exact \eqv\ and \reqv\
solutions for a given turbulent flow, and we are commencing an exploration of
states of turbulent fluids in terms of the unstable \po\ solutions whose
number, as a function of the increasing period, is growing exponentially.
How are we to visualize \emph{the totality} of these solutions in one go?

The answer was given by \cite{hopf48}, who envisioned the function space
of {\NS} velocity fields as an infinite-dimensional \statesp\ $\pS$ in
which each instantaneous state of $3D$ fluid velocity field $\vec{u}(\bx)$ is
represented as a unique point $\ssp$. In our particular application we
can represent $\ssp = (\vec{u}_{nkm})$ as a vector whose elements are the
primitive discretization variables \refeq{pipeDiscr}. The $3D$ velocity
field given by $\vec{u}_{knm}(\zeit)$, obtained from integration of the
\NSe\ in time, can hence be seen as trajectory $\ssp(\zeit)$ in
$\approx 100,000$ dimensional space spanned by the free variables of our
numerical discretization, with the \NS\ equations \refeq{NavStokesDev}
rewritten as
\beq
   \dot{\ssp} = \vel(\ssp) ,
   \qquad
   \ssp(\zeit) = \ssp(0)
            + \int_0^\zeit \! \mathrm{d}\zeit' \, \vel(\ssp(\zeit'))
\,,
\ee{symbolicNS}
where the current state of the fluid $ \ssp(\zeit)$ is the time-$\zeit$
forward map of the initial fluid state  $\ssp(0)$.

In order to quantify whether two fluid states are close to or far from
each other, one needs a notion of distance between two points in
\statesp, measured here as
\beq
  \Norm{\ssp-\ssp'}^2  = \braket{\ssp-\ssp'}{\ssp-\ssp'} =
\frac{1}{V}
\int_\bCell \! d \bx \;
(\vec{u}-\vec{u}') \cdot (\vec{u}-\vec{u}')
\,.
\ee{innerproduct}
There is no compelling reason to use this {`energy norm'}, other than
that velocity fields is what is given in a numerical computation. What
norm one actually uses depends very much on the application.
Visualizations of trajectory \refeq{symbolicNS} are of necessity
projections onto two or three dimensions. A physically appealing choice
is to monitor the flow in terms of the
symmetry-invariant and physical energy, dissipation and power input
observables $(E(\zeit),D(\zeit),I(\zeit))$, as in
\reffig{fig:M1Orb}\,(b).

For \reqva\ the kinetic
energy is constant and so $D=I$, such solutions sit on the diagonal in
\reffig{fig:M1Orb}\,(b), whereas for relative periodic orbits the kinetic
energy is time-periodic, with $\timeAver{D}=\timeAver{I}$ only for
long-time averages.
    \PC{
    It would be instructive to supplement $(I,E)$,  reffig {fig:M1Orb},
    by the  reffig {fig:M1Orb}\,(b) $(I,D)$  plot as well
    }

While a good check on correctness of numerical data, such projections
bunch all invariant solutions and turbulent flow along the energy-balance
lines, even though the solutions themselves can be (and often are) very
distant from each other.

If two fluid states are clearly separated in
such plot, they are also separated in the high-dimensional \statesp, but
converse is not true; states of very different topology might have
comparable energies, and such plots may obscure some of the most relevant
features of the flow. Furthermore, relations such as \refeq{Power=I-D}
depend on detailed type and geometry of a given problem
\rf{ksgreene88,SCD07}, and further physical observables beyond
$(E(\zeit),D(\zeit),I(\zeit))$ are difficult to construct.
    \PC{add here references to \refeq{Power=I-D} derivations. Does
    Frisch\rf{frisch} do it?}


Recently, \cite{GHCW07} have shown that the dynamics of different regions
of {\statesp}, considered as a high-dimensional vector space,
can be elucidated more profitably by a computationally
straight\-forward sets of \emph{physical} coordinates. One identifies
several prominent states of the flow $\vec{u}_A$, $\vec{u}_B$, $\dots$, such as
{\eqv} states and their linearized stability eigenvectors, states in whose neighborhoods the
turbulent flow spends most of the time, and from them constructs, by
Gram-Schmidt or (anti)-symmetrizations, an orthonormal basis set
$\{\be_1, \be_2, \cdots, \be_n\}$. The evolving fluid state $\bu(\zeit)$
is then projected onto this basis using the inner product
\refeq{innerproduct},
\beq
\ssp(\zeit) =(\ssp_1, \ssp_2, \cdots, \ssp_n, \cdots)(\zeit)
    \,,\qquad
\ssp_n(\zeit) = \braket{\vec{u}(\zeit)}{\be_n}
\,.
\ee{intrSspTraj}
Low-dimensional projections of the flow can be viewed in any of the $2D$ planes
$(\ssp_m, \ssp_n)$ or in $3D$ perspective views $(\ssp_{\ell},\ssp_m,
\ssp_n)$. An example is the \reffig{f:MeanVelocityFrame} projection on
the $3$\dmn\ frame $\{{\be}_1,{\be}_2,{\be}_3\}$ defined in \refeq{FrenetFrame1}.
It is worth emphasizing that the method affords low-dimensional {\em
visualization} without any low-dimensional {\em modeling} or dimension
reduction; the dynamics are computed with fully-resolved direct numerical
simulations. Although the use of particular \reqva\ to define
low-dimensional projections (see \refsect{s:eqbSols}) may appear
arbitrary, the choice turns out to be very useful when the turbulent
flow is chaperoned by a few invariant solutions and their unstable
manifolds, as has been shown in other low Reynolds number settings
\rf{GHCW07}. Such visualizations are a prerequisite to uncovering the
interrelations between (the infinite number of) invariant solutions, and
constructing symbolic dynamics partitions of \statesp\ needed for a
systematic exploration of turbulent dynamics, the key challenge that we
address here for the case of turbulent pipe flows.


\subsection{Symmetries of pipe flow}
\label{s:SymmPipe}
% former siminos/atlas/symm.tex

In many physical applications equations such as \NS\ (in $3D$
representation \refeq{NavStokesDev}, or in the \statesp\ representation
\refeq{symbolicNS}) retain their form under symmetry transformations. On
an infinite domain and in the absence of boundary conditions, the \NSe\
are equivariant under translations, rotations, and
$\bx \to -\bx$, $\bu \to -\bu$ inversion through the origin
\rf{frisch}. In pipe flow the cylindrical wall restricts the rotation
symmetry to rotation about the $z$-axis, and translations along it.

A flow $\dot{\ssp}= \vel(\ssp)$ is said to be $\Group$-\emph{equivariant}
if the form of evolution equations \refeq{symbolicNS} is left invariant
by the set of transformations $\LieEl$ that form the group of symmetries
of the dynamics $\Group$,
\beq
\vel(\ssp)=\LieEl^{-1} \, \vel(\LieEl \, \ssp)
\,,\qquad \mbox{for all } \LieEl \in {\Group}
\,.
\ee{eq:FiniteRot}
Let $\LieEl(\phi,\shift)$ be the shift operator such that $\LieEl(\phi,0)$
denotes an azimuthal rotation by $\phi$ about the pipe axis,
and $\LieEl(0,\shift)$ denotes the stream-wise translation by
$\shift$; let $\sigma$ denote reflection about the $\theta=0$ azimuthal
angle:
\bea
\LieEl(\phi,\shift) \, [u,v,w,p](r,\theta,z)
        & = & [u,v,w,p](r,\theta-\phi,z-\shift)
			  \continue
\sigma \, [u,v,w,p](r,\theta,z) \;\; & = & [u,-v,w,p](r,-\theta,z)
\label{pipeSymms}
\eea
%
The \NSe\ for pipe flow are equivariant under these transformations. The
symmetry group of stream-wise periodic pipe flow is thus $\Group =
\On{2}_\theta \times \SOn{2}_z = \Dn{1} \ltimes \SOn{2}_{\theta} \times
\SOn{2}_z$, where $\Dn{1} = \{ e,\, \sigma \}$ denotes azimuthal
reflection, $\ltimes$ stands for a semi-direct product (in general,
reflections and rotations do not commute), and the subscripts $z,\theta$
indicate stream-wise translation and azimuthal rotation respectively.

While the flow equations are invariant under $\Group$, the state of flow
typically is not. Only the laminar Hagen-Poiseuille \eqv\ is invariant
under all of $\Group$, whereas a generic turbulent state has only the
trivial symmetry group $\{e\}$.

In the literature
(see, \eg\ \cite{Recke2010}) such \SOn{2} is often referred to as the
circle group $S^1$, also denoted `one-torus' $T^1$.

\section{How to slice a pipe}
\label{s:algorithm}
% former siminos/atlas/algorithm.tex

\subsection{Rotation into the \slice}

As long as the
norm is discretization independent, the \slice\ condition \refeq{eq:slcond}
is independent of the numerical representation $\ssp$
of the flow $\vec{u}$, be
it finite difference, spectral, and so on.
The slice condition is solved for $\shift$
every few time steps using Newton's method,
where a good initial guess for $\shift(\zeit)$ is obtained from
the previous value and $\dot{\shift}(\zeit)$.

When ${\sspRed}(\zeit)$ is close to ${\slicep}$ the function $f(\shift)$
has only one root.
When ${\ssp}(\zeit)$ is far from ${\slicep}$, however, $f(\shift)$
may have many roots, pairs of which may disappear with time.
This would lead
to a discontinuity in $\shift(\zeit)$.  As explained in
\refsect{s:chartingslice}, o avoid this, a global
atlas has to be pieced together from local \slice\ charts, fixed by
a well-chosen set of
\template s $\slicep{}^{(j)}$ .
Shifts $\shift_j(\zeit)$ are tracked for each local \slice\ chart $\pS{}^{(j)}$,
such that the next $\shift_{j+1}(\zeit)$ is selected at intersection with
$\pS{}^{(j+1)}$
to minimise $\Norm{{\ssp}-{\ssp_i}}$.


\subsection{Dynamically important solutions and Newton's method}
\label{s:reqva}

These solutions evolve in time along their
group orbit, generated by $\LieEl(0,\shift)$. They therefore satisfy the
\slice\ condition \refeq{eq:slcond} for $\shift(\zeit)=c\zeit +const$.
%%
When the \mslices\ is applied, should a trajectory
$\ssp(\zeit)$ approach a {\reqv} in our numerical simulation,
its phase velocity is easily determined by $\shift(\zeit)$.

The way in which the \mslices\ enables to find initial
guesses for $(\vec{u}(0),\period{},\shift)$, is the main differences
between this study and the previous ones.

Here we take as initial guesses samples of nearly recurrent velocity
fields generated by long-time simulations of turbulent dynamics
\rf{pchaot,CviGib10}. The intent is to find the {\em dynamically most
important} solutions, by sampling the turbulent flow's natural measure.
In practice, sufficiently good full \statesp\ initial guesses for
$(\vec{u}(0),\period{},\shift)$ would be almost impossible to find.
Checking correlations between $\vec{u}(\zeit)$ and
$\LieEl(0,\shift)\,\vec{u}(\zeit-\period{})$ for each $\period{}$, and
more problematically, for all possible shifts $(\phi,\shift)$, is an
unrealistic task. The \mslices, however, enables us determine close
recurrences  from the symmetry-reduced time series, and locates the
dynamically most important solutions, \ie, those trajectories that are
most likely to be observed in a long-time turbulent simulation. The \rpo
s are reduced to \po s, whose unstable manifolds are much easier to track
in the \reducedsp. The \rpo\ shift $\shift$ is given by the
reconstruction equation, \refeq{reconstrEq}, or, in practice, by phase
shift $\shift(\period{})-\shift(0)$ accumulated by the intermediate
Newton steps that keep the orbit within the slice.

With a good initial guess for $(\vec{u}(0),\period{},\shift)$, such a
system can be solved using a Newton scheme.  Two conditions in addition
to \refeq{eq:fRPO} are need to be enforced: the Newton update should have no
component along the group orbit, $\braket{\vec{\delta
u}}{\groupTan(\vec{u})}=0$, and no component tangent to trajectory,
$\braket{\vec{\delta u}}{\dot{\vec{u}}}=0$.

\subsection{Sliced pipe}
\label{s:slicedWurst}
% former siminos/atlas/reqva.tex

%\subsection{Pipe flow \reqva\ sliced}
%\label{s:eqbSols}

%\begin{figure}
%  \centering
%  \includegraphics[width=0.6\textwidth]{1611M1PROJ_loc2} %../figs/M1PROJ_loc2.eps}
%  \caption{ \label{fig:M1loc2}
%  (color online)
%    Projection of the dynamics local to the N2\_M1 state.
%    The {\reqv} has been reduced to the central
%    \eqv\ within the \slice.  The local spiral of unstable trajectories
%    is now clearly revealed, the N2\_M1 state having only a single
%    complex unstable eigenvalue within its symmetry class.
%    $\sspRed_i(\zeit) = \langle \be_i | \sspRed(\zeit)-\sspRed_\mathrm{N2\_M1}\rangle$,
%    where $\be_1$ and $\be_2$ are unit vectors along
%    real and imaginary components of the unstable eigenvector.
%  }
%\end{figure}
To project on to the two dimensions of the page,
deviations from the M1 state have been projected against the
real and imaginary components of the M1 complex eigenvectors
$\vec{e}_1$ and $\vec{e}_2$ respectively.
\refFig{fig:M1loc2} shows the local spiral of trajectories
initially perturbed from M1 (blue circle).

For these symmetry reductions, a single \template\
$\slicep = \ssp_{\mathrm{M1}}(0)$ sufficed.
Without restriction of dynamics to the $\Omega_2$-invariant subspace,
trajectories stray much further from M1, so in order to track
such trajectories, all {\reqva}
states were deployed as templates,  $\slicep{}^{(j)}$, $j=1,2,\cdots,6$.
Switching from one local slice to the next nearest one keeps the phase
velocity \refeq{reconstrEq} finite (see \reffig{fig:thetadot}) and
enables tracking of turbulent trajectories in the \reducedsp.


\subsection{Pipe flow \rpo s sliced}
\label{s:rpos}
% former siminos/atlas/rpos.tex

 Without symmetry reduction, the detection
of the nearest recurrence of a state near a previous state, earlier on the
the same trajectory,
would require the calculating the minimum over all possible shifts.
Within the symmetry-\reducedsp\ the determination of recurrences is simple,
as the slices are constructed by requiring that the slice points are
the minimum distance points between the group orbits of the two states.
\refFig{fig:NormDiff} shows the signal for detecting a nearby \rpo\
that shadows the turbulent trajectory.  States from the indicated minimum,
along with the stream-wise shift between start and end of the candidate trajectory,
determined from $\shift(\zeit)-\shift(\zeit-\Delta t)$,
were passed to the Newton--Krylov code.
